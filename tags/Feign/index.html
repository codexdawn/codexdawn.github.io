
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="codexdawn">
    <title>Tag: Feign - codexdawn</title>
    <meta name="author" content="codexdawn">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="codexdawn">
<meta property="og:url" content="https://codexdawn.github.io/tags/Feign/index.html">
<meta property="og:site_name" content="codexdawn">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="codexdawn">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-3sspfygaapf5d6tbrnqmyrhdcstv0iwwmi4wor2yeip9c44sowy9gbdzyyjm.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            codexdawn
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/codexdawn"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.facebook.com/beherzt.dev"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/sim-jisung-3048872a/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:cloudkaiser@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/07/spring-openfeign-1/"
                            aria-label=": spring-openfeign-1"
                        >
                            spring-openfeign-1
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-07T02:28:45+00:00">
	
		    May 07, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Feign/">Feign</a>, <a class="category-link" href="/categories/Spring-Boot/">Spring Boot</a>, <a class="category-link" href="/categories/Spring-OpenFeign/">Spring OpenFeign</a>, <a class="category-link" href="/categories/%EC%9C%A0%EB%A0%88%EC%B9%B4or%EC%82%BD%EC%A7%88/">유레카or삽질</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="Spring-OpenFeign-삽질기"><a href="#Spring-OpenFeign-삽질기" class="headerlink" title="Spring OpenFeign 삽질기"></a>Spring OpenFeign 삽질기</h1><p>사실 Spring OpenFeign을 먼저 공부하는것보다 Hystrix -&gt; Feign -&gt; Spring OpenFeign 순으로 스터디 하는것이 낫다라고 생각이 들긴하는데, 그냥 Spring OpenFeign부터 살펴보았다. </p>
<p>Spring OpenFeign은 Netflix에서 개발한 Feign을 가지고 Spring 입맛에 맞게 개발한 부분으로 Feign에 비해서는 아직까지 덜 개발된 부분이 있는듯하나, 스프링 웹 MVC개발 경험을 그대로 사용가능하다는 장점과 좀 더 손쉬운 Fallback및 Client관리가 장점이라고 갠적으로 생각한다. </p>
<h2 id="1-세팅"><a href="#1-세팅" class="headerlink" title="1. 세팅"></a>1. 세팅</h2><h3 id="1-1-build-gradle-의존성-추가"><a href="#1-1-build-gradle-의존성-추가" class="headerlink" title="1-1. build.gradle 의존성 추가"></a>1-1. build.gradle 의존성 추가</h3><p>[주의] spring openFeign은 spring cloud 그룹에 있기때문에 spring cloud가 먼저 의존성으로 추가되어있어야함. </p>
<figure class="highlight plain"><figcaption><span>build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">implementation(&#39;org.springframework.cloud:spring-cloud-starter-openfeign&#39;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="1-2-hystrix-설정"><a href="#1-2-hystrix-설정" class="headerlink" title="1-2. hystrix 설정"></a>1-2. hystrix 설정</h3><figure class="highlight plain"><figcaption><span>application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">feign:</span><br><span class="line">  hystrix:</span><br><span class="line">    enabled: true</span><br></pre></td></tr></table></figure>

<h2 id="2-개발"><a href="#2-개발" class="headerlink" title="2. 개발"></a>2. 개발</h2><h3 id="2-1-Client-개발"><a href="#2-1-Client-개발" class="headerlink" title="2-1. Client 개발"></a>2-1. Client 개발</h3><figure class="highlight java"><figcaption><span>client</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.domain.configuration.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.web.bind.annotation.RequestMethod.POST;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.legacy.mypage.CounselorOrderInfo;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.legacy.mypage.CounselorOrderParam;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.response.ResponseObject;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.meta.WmpHeader;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.meta.mypage.WmpAppType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestHeader;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FeignClient(name = &quot;api-feign-client&quot;</span></span><br><span class="line"><span class="meta">    , url = &quot;$&#123;v-ocs.api-hosts.shipping-api&#125;&quot;</span></span><br><span class="line"><span class="meta">    , fallbackFactory = ApiFeignClientFallbackFactory.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApiFeignClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(method = POST</span></span><br><span class="line"><span class="meta">        , value = &quot;/vertical/getCounselorOrder&quot;</span></span><br><span class="line"><span class="meta">        , produces = &quot;application/json&quot;)</span></span><br><span class="line">    <span class="function">ResponseObject&lt;CounselorOrderInfo&gt; <span class="title">getCounselorOrderFeign</span><span class="params">(<span class="meta">@RequestHeader(WmpHeader.WMP_APP_NAME)</span> WmpAppType wmpAppName</span></span></span><br><span class="line"><span class="function"><span class="params">        , <span class="meta">@RequestBody</span> CounselorOrderParam param)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위 코드를 보면 알수있지만, 기존 Spring MVC에서 활용하던 네이밍들을 그대로 가져와서 사용가능하다는 장점이 있다. 그냥 Feign을 사용하면 저 애너테이션들은 사용하지 못하고 Feign에서 정의된 애너테이션으로 사용 해야함. </p>
<h3 id="2-2-FallbackFactory-세팅"><a href="#2-2-FallbackFactory-세팅" class="headerlink" title="2-2. FallbackFactory 세팅"></a>2-2. FallbackFactory 세팅</h3><p>Spring OpenFeign은 fallback관리를 비교적 쉽게 할수있음. </p>
<figure class="highlight java"><figcaption><span>fallback factory</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.domain.configuration.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.legacy.mypage.CounselorOrderInfo;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.legacy.mypage.CounselorOrderParam;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.response.ResponseObject;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.meta.mypage.WmpAppType;</span><br><span class="line"><span class="keyword">import</span> feign.hystrix.FallbackFactory;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiFeignClientFallbackFactory</span> <span class="keyword">implements</span> <span class="title">FallbackFactory</span>&lt;<span class="title">ApiFeignClient</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ApiFeignClient <span class="title">create</span><span class="params">(Throwable cause)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiFeignClient() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> ResponseObject&lt;CounselorOrderInfo&gt; <span class="title">getCounselorOrderFeign</span><span class="params">(WmpAppType wmpAppName, CounselorOrderParam param)</span> </span>&#123;</span><br><span class="line">                log.error(<span class="string">&quot;error message : &#123;&#125;&quot;</span>, cause.getMessage());</span><br><span class="line">                ResponseObject&lt;CounselorOrderInfo&gt; responseObject = <span class="keyword">new</span> ResponseObject&lt;&gt;();</span><br><span class="line">                responseObject.setData(CounselorOrderInfo.EMPTY);</span><br><span class="line">                <span class="keyword">return</span> responseObject;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>위 코드를 정의한뒤, Client에서 @FeignClient 정의할때 fallbackFactory에 정의해주면 됨.<br>@FeignClient에 그냥 fallback도 있는데, 개인적으로 생각하는 차이점은 fallbackFactory는 Throwable을 받을수있어서 에러의 상세를 알수가 있지만,<br>그냥 fallback은 단순 fallback처리만 지원되는것으로 알고있음. (깊게 공부 안함.)</p>
<h2 id="3-정리"><a href="#3-정리" class="headerlink" title="3. 정리"></a>3. 정리</h2><p>위 와 같이 설정하면 가장 기본적인 Spring OpenFeign 설정 및 개발방법은 끝이다. 너무 간단스하지만, 여기서 개인적인 생각은 기존 Feign은 여러가지 확장성있는 개발이 가능하다. 예를들면 client를 OkHttp로 세팅하거나, Http2Client같은 http2설정도 가능하고, 기타 정말 많은 부분을 확장해서 사용이 가능한걸로 알고있는데, Spring OpenFeign은 그에 반해 기능이 꽤나 한정적인걸로 확인되어진다. 그리고 아직까지는 reactive가 지원되지 않기도해서, 개별적인 라이브러리를 받아서 해야하는것으로 알고있음. 따라서, 단순 httpClient 빠르게 개발하고, hystrix까지 덤으로 같이 사용하고자할때는 Spring OpenFeign만큼 생산성있게 빠르게 개발할수있는건 없는듯하다. 아직 깊게 공부하지는 못했지만, 좀 더 깊게 공부하고 싶다면 아래 링크 사이트로 공부하도록 해보자! </p>
<p>[필수참고 사이트]<br><a target="_blank" rel="noopener" href="https://cloud.spring.io/spring-cloud-openfeign/reference/html/#reactive-support">Spring OpenFeign 공식 사이트</a><br><a target="_blank" rel="noopener" href="https://github.com/OpenFeign/feign/#basics">OpenFeign 사이트</a></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/07/spring-openfeign-1/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 codexdawn. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">codexdawn</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ikbi0v8fyzuu91xv5rmpcrnwb4qinfgborzd5kejmj8wr6ibfra8oaxqshyg.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
