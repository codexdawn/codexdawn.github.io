
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="codexdawn">
    <title>Tag: Java,JPA,Spring - codexdawn</title>
    <meta name="author" content="codexdawn">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="codexdawn">
<meta property="og:url" content="https://codexdawn.github.io/tags/Java-JPA-Spring/index.html">
<meta property="og:site_name" content="codexdawn">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="codexdawn">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-3sspfygaapf5d6tbrnqmyrhdcstv0iwwmi4wor2yeip9c44sowy9gbdzyyjm.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            codexdawn
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/codexdawn"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.facebook.com/beherzt.dev"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/sim-jisung-3048872a/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:cloudkaiser@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/07/spring-openfeign-1/"
                            aria-label=": spring-openfeign-1"
                        >
                            spring-openfeign-1
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-07T02:28:45+00:00">
	
		    May 07, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Feign/">Feign</a>, <a class="category-link" href="/categories/Spring-Boot/">Spring Boot</a>, <a class="category-link" href="/categories/Spring-OpenFeign/">Spring OpenFeign</a>, <a class="category-link" href="/categories/%EC%9C%A0%EB%A0%88%EC%B9%B4or%EC%82%BD%EC%A7%88/">유레카or삽질</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="Spring-OpenFeign-삽질기"><a href="#Spring-OpenFeign-삽질기" class="headerlink" title="Spring OpenFeign 삽질기"></a>Spring OpenFeign 삽질기</h1><p>사실 Spring OpenFeign을 먼저 공부하는것보다 Hystrix -&gt; Feign -&gt; Spring OpenFeign 순으로 스터디 하는것이 낫다라고 생각이 들긴하는데, 그냥 Spring OpenFeign부터 살펴보았다. </p>
<p>Spring OpenFeign은 Netflix에서 개발한 Feign을 가지고 Spring 입맛에 맞게 개발한 부분으로 Feign에 비해서는 아직까지 덜 개발된 부분이 있는듯하나, 스프링 웹 MVC개발 경험을 그대로 사용가능하다는 장점과 좀 더 손쉬운 Fallback및 Client관리가 장점이라고 갠적으로 생각한다. </p>
<h2 id="1-세팅"><a href="#1-세팅" class="headerlink" title="1. 세팅"></a>1. 세팅</h2><h3 id="1-1-build-gradle-의존성-추가"><a href="#1-1-build-gradle-의존성-추가" class="headerlink" title="1-1. build.gradle 의존성 추가"></a>1-1. build.gradle 의존성 추가</h3><p>[주의] spring openFeign은 spring cloud 그룹에 있기때문에 spring cloud가 먼저 의존성으로 추가되어있어야함. </p>
<figure class="highlight plain"><figcaption><span>build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">implementation(&#39;org.springframework.cloud:spring-cloud-starter-openfeign&#39;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="1-2-hystrix-설정"><a href="#1-2-hystrix-설정" class="headerlink" title="1-2. hystrix 설정"></a>1-2. hystrix 설정</h3><figure class="highlight plain"><figcaption><span>application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">feign:</span><br><span class="line">  hystrix:</span><br><span class="line">    enabled: true</span><br></pre></td></tr></table></figure>

<h2 id="2-개발"><a href="#2-개발" class="headerlink" title="2. 개발"></a>2. 개발</h2><h3 id="2-1-Client-개발"><a href="#2-1-Client-개발" class="headerlink" title="2-1. Client 개발"></a>2-1. Client 개발</h3><figure class="highlight java"><figcaption><span>client</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.domain.configuration.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.web.bind.annotation.RequestMethod.POST;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.legacy.mypage.CounselorOrderInfo;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.legacy.mypage.CounselorOrderParam;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.response.ResponseObject;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.meta.WmpHeader;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.meta.mypage.WmpAppType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestHeader;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FeignClient(name = &quot;api-feign-client&quot;</span></span><br><span class="line"><span class="meta">    , url = &quot;$&#123;v-ocs.api-hosts.shipping-api&#125;&quot;</span></span><br><span class="line"><span class="meta">    , fallbackFactory = ApiFeignClientFallbackFactory.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApiFeignClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(method = POST</span></span><br><span class="line"><span class="meta">        , value = &quot;/vertical/getCounselorOrder&quot;</span></span><br><span class="line"><span class="meta">        , produces = &quot;application/json&quot;)</span></span><br><span class="line">    <span class="function">ResponseObject&lt;CounselorOrderInfo&gt; <span class="title">getCounselorOrderFeign</span><span class="params">(<span class="meta">@RequestHeader(WmpHeader.WMP_APP_NAME)</span> WmpAppType wmpAppName</span></span></span><br><span class="line"><span class="function"><span class="params">        , <span class="meta">@RequestBody</span> CounselorOrderParam param)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위 코드를 보면 알수있지만, 기존 Spring MVC에서 활용하던 네이밍들을 그대로 가져와서 사용가능하다는 장점이 있다. 그냥 Feign을 사용하면 저 애너테이션들은 사용하지 못하고 Feign에서 정의된 애너테이션으로 사용 해야함. </p>
<h3 id="2-2-FallbackFactory-세팅"><a href="#2-2-FallbackFactory-세팅" class="headerlink" title="2-2. FallbackFactory 세팅"></a>2-2. FallbackFactory 세팅</h3><p>Spring OpenFeign은 fallback관리를 비교적 쉽게 할수있음. </p>
<figure class="highlight java"><figcaption><span>fallback factory</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.domain.configuration.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.legacy.mypage.CounselorOrderInfo;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.legacy.mypage.CounselorOrderParam;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.model.response.ResponseObject;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.meta.mypage.WmpAppType;</span><br><span class="line"><span class="keyword">import</span> feign.hystrix.FallbackFactory;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiFeignClientFallbackFactory</span> <span class="keyword">implements</span> <span class="title">FallbackFactory</span>&lt;<span class="title">ApiFeignClient</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ApiFeignClient <span class="title">create</span><span class="params">(Throwable cause)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiFeignClient() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> ResponseObject&lt;CounselorOrderInfo&gt; <span class="title">getCounselorOrderFeign</span><span class="params">(WmpAppType wmpAppName, CounselorOrderParam param)</span> </span>&#123;</span><br><span class="line">                log.error(<span class="string">&quot;error message : &#123;&#125;&quot;</span>, cause.getMessage());</span><br><span class="line">                ResponseObject&lt;CounselorOrderInfo&gt; responseObject = <span class="keyword">new</span> ResponseObject&lt;&gt;();</span><br><span class="line">                responseObject.setData(CounselorOrderInfo.EMPTY);</span><br><span class="line">                <span class="keyword">return</span> responseObject;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>위 코드를 정의한뒤, Client에서 @FeignClient 정의할때 fallbackFactory에 정의해주면 됨.<br>@FeignClient에 그냥 fallback도 있는데, 개인적으로 생각하는 차이점은 fallbackFactory는 Throwable을 받을수있어서 에러의 상세를 알수가 있지만,<br>그냥 fallback은 단순 fallback처리만 지원되는것으로 알고있음. (깊게 공부 안함.)</p>
<h2 id="3-정리"><a href="#3-정리" class="headerlink" title="3. 정리"></a>3. 정리</h2><p>위 와 같이 설정하면 가장 기본적인 Spring OpenFeign 설정 및 개발방법은 끝이다. 너무 간단스하지만, 여기서 개인적인 생각은 기존 Feign은 여러가지 확장성있는 개발이 가능하다. 예를들면 client를 OkHttp로 세팅하거나, Http2Client같은 http2설정도 가능하고, 기타 정말 많은 부분을 확장해서 사용이 가능한걸로 알고있는데, Spring OpenFeign은 그에 반해 기능이 꽤나 한정적인걸로 확인되어진다. 그리고 아직까지는 reactive가 지원되지 않기도해서, 개별적인 라이브러리를 받아서 해야하는것으로 알고있음. 따라서, 단순 httpClient 빠르게 개발하고, hystrix까지 덤으로 같이 사용하고자할때는 Spring OpenFeign만큼 생산성있게 빠르게 개발할수있는건 없는듯하다. 아직 깊게 공부하지는 못했지만, 좀 더 깊게 공부하고 싶다면 아래 링크 사이트로 공부하도록 해보자! </p>
<p>[필수참고 사이트]<br><a target="_blank" rel="noopener" href="https://cloud.spring.io/spring-cloud-openfeign/reference/html/#reactive-support">Spring OpenFeign 공식 사이트</a><br><a target="_blank" rel="noopener" href="https://github.com/OpenFeign/feign/#basics">OpenFeign 사이트</a></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/07/spring-openfeign-1/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/01/multi-module-1/"
                            aria-label=": multi-module-1"
                        >
                            multi-module-1
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-01T07:39:04+00:00">
	
		    May 01, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/%EB%A9%80%ED%8B%B0%EB%AA%A8%EB%93%88%EC%84%A4%EC%A0%95/">멀티모듈설정</a>, <a class="category-link" href="/categories/%EC%9C%A0%EB%A0%88%EC%B9%B4or%EC%82%BD%EC%A7%88/">유레카or삽질</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="멀티모듈-삽질-일기"><a href="#멀티모듈-삽질-일기" class="headerlink" title="멀티모듈 삽질 일기"></a>멀티모듈 삽질 일기</h1><h2 id="1-프로젝트-초기-구성-삽질"><a href="#1-프로젝트-초기-구성-삽질" class="headerlink" title="1. 프로젝트 초기 구성 삽질"></a>1. 프로젝트 초기 구성 삽질</h2><p>v-ocs 멀티모듈 프로젝트를 당시 v-content 모듈 구성 그대로 따라서 만들어본 경험을 끄적거려본다. 개인적으로 멀티 모듈은 한번 개인적으로 공부할때 구성해본적은 있지만, 이렇게 실무에서 적용할 로직을 기반으로 구성하는건 처음이어서, 이번기회에 좀 익혀봐야하겠다고 생각해서 도전해보게 되었다. </p>
<h3 id="1-1-프로젝트-스펙"><a href="#1-1-프로젝트-스펙" class="headerlink" title="1-1. 프로젝트 스펙"></a>1-1. 프로젝트 스펙</h3><p>우선 프로젝트 스펙은 아래와 같이 설정하였다. </p>
<ul>
<li>JAVA 1.8 (적는 시점부터는 11버전업 예정중에 있음)</li>
<li>Gradle </li>
<li>SpringBoot 2.3.4 / SpringCloud Hoxtom.SR8  </li>
<li>mysql 5.X</li>
<li>Spring Data JPA </li>
<li>multi datasource 구성 (2개 디비이상 연결)</li>
<li>IDE: 인텔리제이</li>
<li>스웨거 사용 </li>
</ul>
<h3 id="1-2-프로젝트-아키텍처"><a href="#1-2-프로젝트-아키텍처" class="headerlink" title="1-2. 프로젝트 아키텍처"></a>1-2. 프로젝트 아키텍처</h3><p><img src="/images/multimodule/m-1.png" alt="프로젝트 아키텍처 청사진"></p>
<h3 id="1-3-멀티모듈-구성-방법-Gradle-기반"><a href="#1-3-멀티모듈-구성-방법-Gradle-기반" class="headerlink" title="1-3. 멀티모듈 구성 방법 (Gradle 기반)"></a>1-3. 멀티모듈 구성 방법 (Gradle 기반)</h3><ol>
<li>java gradle 기반 신규 프로젝트 구성 (이건 어렵지 않지..경우에 따라서 maven으로 세팅해야할수도 있음.)</li>
<li>세팅후, src 폴더를 지워준다. (root 프로젝트이기 때문에 필요없음. 단 build.gradle은 절대로 지우지말자.)</li>
<li>IDE내 root프로젝트 선택후 마우스 우클릭 하고 New-&gt;Module 선택해서 프로젝트 만들어주면 됨. (ex&gt; v-ocs-meta/v-ocs-api/v-ocs-domain/v-ocs-batch…)</li>
<li>root프로젝트의 build.gradle 설정 구성 (맨하단에 추가한 모듈의존성 꼭 확인하자!)<figure class="highlight plain"><figcaption><span>root-build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    ext &#123;</span><br><span class="line">        springBootVersion &#x3D; &#39;2.3.4.RELEASE&#39;</span><br><span class="line">        springCloudVersion &#x3D; &#39;Hoxton.SR8&#39;</span><br><span class="line">        dependencyManagementVersion &#x3D; &#39;1.0.10.RELEASE&#39;</span><br><span class="line">    &#125;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath(&quot;org.springframework.boot:spring-boot-gradle-plugin:$&#123;springBootVersion&#125;&quot;)</span><br><span class="line">        classpath &quot;io.spring.gradle:dependency-management-plugin:$&#123;dependencyManagementVersion&#125;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;</span><br><span class="line">    group &quot;com.codexdawn.v.ocs&quot;</span><br><span class="line"></span><br><span class="line">    apply plugin: &quot;java&quot;</span><br><span class="line">    apply plugin: &quot;idea&quot;</span><br><span class="line">    apply plugin: &#39;org.springframework.boot&#39;</span><br><span class="line"></span><br><span class="line">    idea &#123;</span><br><span class="line">        module &#123;</span><br><span class="line">            inheritOutputDirs &#x3D; true</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">subprojects &#123;</span><br><span class="line">    apply plugin: &#39;java&#39;</span><br><span class="line">    apply plugin: &#39;idea&#39;</span><br><span class="line">    apply plugin: &#39;org.springframework.boot&#39;</span><br><span class="line">    apply plugin: &#39;io.spring.dependency-management&#39;</span><br><span class="line"></span><br><span class="line">    group &#x3D; &#39;com.wmp.v.ocs&#39;</span><br><span class="line"></span><br><span class="line">    version &#x3D; &#39;0.0.1-SNAPSHOT&#39;</span><br><span class="line">    sourceCompatibility &#x3D; &#39;1.8&#39;</span><br><span class="line"></span><br><span class="line">    repositories &#123;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url &quot;http:&#x2F;&#x2F;nexus.sys.wemakeprice.com&#x2F;content&#x2F;repositories&#x2F;central&quot;</span><br><span class="line">            credentials &#123;</span><br><span class="line">                username &quot;development&quot;</span><br><span class="line">                password &quot;development&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url &quot;http:&#x2F;&#x2F;nexus.sys.wemakeprice.com&#x2F;content&#x2F;repositories&#x2F;thirdparty&quot;</span><br><span class="line">            credentials &#123;</span><br><span class="line">                username &quot;development&quot;</span><br><span class="line">                password &quot;development&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url &quot;http:&#x2F;&#x2F;nexus.sys.wemakeprice.com&#x2F;content&#x2F;repositories&#x2F;releases&quot;</span><br><span class="line">            credentials &#123;</span><br><span class="line">                username &quot;development&quot;</span><br><span class="line">                password &quot;development&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url &quot;http:&#x2F;&#x2F;nexus.sys.wemakeprice.com&#x2F;content&#x2F;repositories&#x2F;snapshots&quot;</span><br><span class="line">            credentials &#123;</span><br><span class="line">                username &quot;development&quot;</span><br><span class="line">                password &quot;development&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url &quot;http:&#x2F;&#x2F;oss.jfrog.org&#x2F;artifactory&#x2F;oss-snapshot-local&quot;</span><br><span class="line">            credentials &#123;</span><br><span class="line">                username &quot;jcenter-snapshots&quot;</span><br><span class="line">                password &quot;jcenter&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    task initSourceFolders &#123;</span><br><span class="line">        sourceSets*.java.srcDirs*.each &#123;</span><br><span class="line">            if (!it.exists()) &#123;</span><br><span class="line">                it.mkdirs()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sourceSets*.resources.srcDirs*.each &#123;</span><br><span class="line">            if (!it.exists()) &#123;</span><br><span class="line">                it.mkdirs()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dependencies &#123;</span><br><span class="line"></span><br><span class="line">        compileOnly &#39;org.projectlombok:lombok&#39;</span><br><span class="line">        annotationProcessor &#39;org.springframework.boot:spring-boot-configuration-processor&#39;</span><br><span class="line">        annotationProcessor &#39;org.projectlombok:lombok&#39;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        testImplementation(&#39;org.springframework.boot:spring-boot-starter-test&#39;) &#123;</span><br><span class="line">            exclude group: &#39;org.junit.vintage&#39;, module: &#39;junit-vintage-engine&#39;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; jackson</span><br><span class="line">        implementation(&#39;com.fasterxml.jackson.core:jackson-databind&#39;)</span><br><span class="line">        implementation(&#39;com.google.code.gson:gson:2.8.0&#39;)</span><br><span class="line">        implementation(&#39;com.google.guava:guava:28.0-jre&#39;)</span><br><span class="line">        implementation(&#39;commons-codec:commons-codec&#39;)</span><br><span class="line">        implementation(&#39;org.apache.commons:commons-lang3:3.9&#39;)</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; jsr validation</span><br><span class="line">        implementation(&#39;javax.validation:validation-api:2.0.1.Final&#39;)</span><br><span class="line"></span><br><span class="line">        testCompile group: &#39;junit&#39;, name: &#39;junit&#39;, version: &#39;4.12&#39;</span><br><span class="line">        testImplementation(&#39;org.easytesting:fest-assert:1.4&#39;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dependencyManagement &#123;</span><br><span class="line">        imports &#123;</span><br><span class="line">            mavenBom &quot;org.springframework.cloud:spring-cloud-dependencies:$&#123;springCloudVersion&#125;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test &#123;</span><br><span class="line">    useJUnitPlatform()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">project(&#39;:v-ocs-api&#39;) &#123;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        compile project(&#39;:v-ocs-domain&#39;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">project(&#39;:v-ocs-batch&#39;) &#123;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        compile project(&#39;:v-ocs-domain&#39;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">project(&#39;:v-ocs-domain&#39;) &#123;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        compile project(path: &#39;:v-ocs-meta&#39;, configuration: &#39;default&#39;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>최종 구성된 멀티 모듈 프로젝트<br><img src="/images/multimodule/m-2.png" alt="최종 세팅된 모습"></p>
<h2 id="2-API-모듈-구성-하기"><a href="#2-API-모듈-구성-하기" class="headerlink" title="2. API 모듈 구성 하기"></a>2. API 모듈 구성 하기</h2><h3 id="2-1-build-gradle-세팅"><a href="#2-1-build-gradle-세팅" class="headerlink" title="2-1. build.gradle 세팅"></a>2-1. build.gradle 세팅</h3><p>API쪽 build.gradle영역은 생각보다 많이 심플하다. 의존되는 라이브러리만 잘 가져오면 된다.<br>여기서 유심히 봐야할건, spring-data-jpa같이 도메인에서 사용되는 라이브러리가 api단에 추가되어있다는것이 특징이라 할수있다.<br>그말인즉슨, BATCH도 아래와 유사하게 세팅해야한다는것이다. </p>
<figure class="highlight plain"><figcaption><span>api-build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation(&#39;org.springframework.boot:spring-boot-starter-web&#39;)</span><br><span class="line">    testImplementation(&#39;org.springframework.boot:spring-boot-starter-test&#39;)</span><br><span class="line">    implementation(&#39;org.springframework.boot:spring-boot-starter-validation&#39;)</span><br><span class="line"></span><br><span class="line">    implementation(&#39;org.springframework.boot:spring-boot-starter-actuator&#39;)</span><br><span class="line">    implementation(&#39;org.springframework.boot:spring-boot-starter-security&#39;)</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; swagger</span><br><span class="line">    implementation(&#39;io.springfox:springfox-boot-starter:3.0.0&#39;)</span><br><span class="line">    compile(&#39;io.springfox:springfox-swagger-ui:3.0.0&#39;)</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; kafka</span><br><span class="line">    implementation(&#39;org.apache.kafka:kafka-clients:0.10.1.1&#39;)</span><br><span class="line">    implementation(&#39;org.springframework.cloud:spring-cloud-starter-sleuth&#39;)</span><br><span class="line">    implementation(&#39;org.springframework.cloud:spring-cloud-starter-zipkin&#39;)</span><br><span class="line">    implementation(&#39;com.github.danielwegener:logback-kafka-appender:0.1.0&#39;)</span><br><span class="line"></span><br><span class="line">    implementation (&#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;)</span><br><span class="line"></span><br><span class="line">    runtime &#39;org.hibernate:hibernate-entitymanager&#39;</span><br><span class="line">    runtime &#39;mysql:mysql-connector-java&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-Application-java-설정"><a href="#2-2-Application-java-설정" class="headerlink" title="2-2. Application.java 설정"></a>2-2. Application.java 설정</h3><figure class="highlight plain"><figcaption><span>Appliocation.java 설정</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package com.wemakeprice.v.ocs.api;</span><br><span class="line"></span><br><span class="line">import com.wemakeprice.v.ocs.domain.VOcsDomain;</span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;</span><br><span class="line">import org.springframework.context.annotation.ComponentScan;</span><br><span class="line">import org.springframework.web.servlet.config.annotation.EnableWebMvc;</span><br><span class="line"></span><br><span class="line">@EnableWebMvc</span><br><span class="line">@ComponentScan(basePackageClasses &#x3D; &#123;VOcsApi.class, VOcsDomain.class&#125;)</span><br><span class="line">@SpringBootApplication(exclude &#x3D; &#123;DataSourceAutoConfiguration.class&#125;)</span><br><span class="line">public class VOcsApiApplication &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(VOcsApiApplication.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위 코드의 특징은 ComponentScan이 단순 interface파일로 컴포넌트를 스캔하도록 구성되어있다는것이다. (처음알았다…^^;)<br>VOcsApi.class, VOcsDomain.class 요 두개는 그냥 빈 interface로 구성되어있다. </p>
<figure class="highlight plain"><figcaption><span>VOcsApi/VOcsDomain.class</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">package com.wemakeprice.v.ocs.api;</span><br><span class="line"></span><br><span class="line">public interface VOcsApi &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-application-yml-logback-sping-xml-설정"><a href="#2-3-application-yml-logback-sping-xml-설정" class="headerlink" title="2-3. application.yml / logback-sping.xml 설정"></a>2-3. application.yml / logback-sping.xml 설정</h3><figure class="highlight plain"><figcaption><span>application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: v-ocs-api</span><br><span class="line">  profiles:</span><br><span class="line">    active: local</span><br><span class="line">    include:</span><br><span class="line">        - domain-local</span><br><span class="line"></span><br><span class="line">  sleuth:</span><br><span class="line">    rxjava.schedulers.hook.enabled: false</span><br><span class="line">    enabled: true</span><br><span class="line">    sampler:</span><br><span class="line">      probability: 1.0</span><br><span class="line"></span><br><span class="line">    security:</span><br><span class="line">      user:</span><br><span class="line">        name: wmp</span><br><span class="line">        password: wemake</span><br><span class="line"></span><br><span class="line">    jackson:</span><br><span class="line">      default-property-inclusion: non_null</span><br><span class="line"></span><br><span class="line">logging:</span><br><span class="line">  config: classpath:logback-spring.xml</span><br><span class="line"></span><br><span class="line">server:</span><br><span class="line">  max-http-header-size: 32KB</span><br><span class="line">  port: 18080</span><br><span class="line"></span><br><span class="line">management:</span><br><span class="line">  endpoint:</span><br><span class="line">    health:</span><br><span class="line">      show-details: always</span><br><span class="line">  endpoints:</span><br><span class="line">    web:</span><br><span class="line">      base-path: &#x2F;servicemanager</span><br><span class="line">      exposure:</span><br><span class="line">        include: &quot;*&quot;</span><br><span class="line">		</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><figcaption><span>application-local.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  output:</span><br><span class="line">    ansi:</span><br><span class="line">      enabled: always</span><br><span class="line"></span><br><span class="line">  sleuth:</span><br><span class="line">    rxjava.schedulers.hook.enabled: false</span><br><span class="line">    enabled: false</span><br><span class="line">  zipkin:</span><br><span class="line">    enabled: false</span><br><span class="line"></span><br><span class="line">  jpa:</span><br><span class="line">    database-platform: org.hibernate.dialect.MySQL5InnoDBDialect</span><br><span class="line">    open-in-view: false</span><br><span class="line">    properties:</span><br><span class="line">      hibernate:</span><br><span class="line">        format_sql: true</span><br><span class="line">        show_sql: true</span><br><span class="line">        use_sql_comments: true</span><br><span class="line">        id:</span><br><span class="line">          new_generator_mappings: false</span><br><span class="line"></span><br><span class="line">        order_inserts: true</span><br><span class="line">        order_updates: true</span><br><span class="line">        jdbc:</span><br><span class="line">          batch_size: 1000</span><br><span class="line">    generate-ddl: false</span><br><span class="line"></span><br><span class="line">  datasource:</span><br><span class="line">    escrow-master:</span><br><span class="line">      driver-class-name: com.mysql.cj.jdbc.Driver</span><br><span class="line">      jdbc-url: jdbc:mysql:&#x2F;&#x2F;1.234.77:3306&#x2F;wmp_escrow?useUnicode&#x3D;true&amp;characterEncoding&#x3D;utf-8&amp;connectionCollation&#x3D;utf8_bin&amp;characterSetResults&#x3D;utf8&amp;autoReconnect&#x3D;true&amp;serverTimezone&#x3D;Asia&#x2F;Seoul&amp;useSSL&#x3D;false&amp;zeroDateTimeBehavior&#x3D;convertToNull</span><br><span class="line">      username: app_escrow</span><br><span class="line">      password: 5Z9pjgBw3Pj1RMrVLQYv</span><br><span class="line">      maximum-pool-size: 10</span><br><span class="line">      minimum-idle: 5</span><br><span class="line">      connection-timeout: 5000 # ms</span><br><span class="line">      validation-timeout: 5000 # ms</span><br><span class="line">      max-lifetime: 55000 # ms, mysql wait_timeout is 60s. idleTimeout is close to or more than maxLifetime, disabling it.</span><br><span class="line">      transaction-isolation: TRANSACTION_READ_COMMITTED</span><br><span class="line">      pool-name: escrowMaster-db-pool</span><br><span class="line">      data-source-properties:</span><br><span class="line">        cachePrepStmts: true  # dbcp2의 pool-prepared-statements: true와 동일한 설정</span><br><span class="line">        prepStmtCacheSize: 50 # 기존 설정은 무제한이었으나 connection당 생성되므로 너무 크게 섫정하면 OOM이 발생할 수 있다.</span><br><span class="line">        prepStmtCacheSqlLimit: 2048 # sql 문장의 크기제한</span><br><span class="line"></span><br><span class="line">    escrow-slave:</span><br><span class="line">      driver-class-name: com.mysql.cj.jdbc.Driver</span><br><span class="line">      jdbc-url: jdbc:mysql:&#x2F;&#x2F;1.234.77:3306&#x2F;wmp_escrow?useUnicode&#x3D;true&amp;characterEncoding&#x3D;utf-8&amp;connectionCollation&#x3D;utf8_bin&amp;characterSetResults&#x3D;utf8&amp;autoReconnect&#x3D;true&amp;serverTimezone&#x3D;Asia&#x2F;Seoul&amp;useSSL&#x3D;false&amp;zeroDateTimeBehavior&#x3D;convertToNull</span><br><span class="line">      username: app_escrow</span><br><span class="line">      password: 5Z9pjgBw3Pj1RMrVLQYv</span><br><span class="line">      maximum-pool-size: 10</span><br><span class="line">      minimum-idle: 5</span><br><span class="line">      connection-timeout: 5000 # ms</span><br><span class="line">      validation-timeout: 5000 # ms</span><br><span class="line">      max-lifetime: 55000 # ms, mysql wait_timeout is 60s. idleTimeout is close to or more than maxLifetime, disabling it.</span><br><span class="line">      transaction-isolation: TRANSACTION_READ_COMMITTED</span><br><span class="line">      pool-name: escorwSlave-db-pool</span><br><span class="line">      data-source-properties:</span><br><span class="line">        cachePrepStmts: true  # dbcp2의 pool-prepared-statements: true와 동일한 설정</span><br><span class="line">        prepStmtCacheSize: 50 # 기존 설정은 무제한이었으나 connection당 생성되므로 너무 크게 섫정하면 OOM이 발생할 수 있다.</span><br><span class="line">        prepStmtCacheSqlLimit: 2048 # sql 문장의 크기제한</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><figcaption><span>logback-spring.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line"></span><br><span class="line">  &lt;include resource&#x3D;&quot;org&#x2F;springframework&#x2F;boot&#x2F;logging&#x2F;logback&#x2F;defaults.xml&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name&#x3D;&quot;CONSOLE_PATTERN&quot; value&#x3D;&quot;%clr(%d&#123;yyyy-MM-dd HH:mm:ss.SSS, Asia&#x2F;Seoul&#125;)&#123;faint&#125; %clr($&#123;LOG_LEVEL_PATTERN:-%5p&#125;) [$&#123;java.rmi.server.hostname:-127.0.0.1&#125;] [$&#123;nd.hostname:-localhost&#125;] %clr($&#123;PID:- &#125;)&#123;magenta&#125; %clr(---)&#123;faint&#125; %clr([%15.15t])&#123;faint&#125; %clr(%-40.40logger&#123;39&#125;)&#123;cyan&#125; %clr([%class&#123;5&#125; &gt; %method:%line])&#123;magenta&#125; %clr(:)&#123;faint&#125; %m%n$&#123;LOG_EXCEPTION_CONVERSION_WORD:-%wEx&#125;&quot;&#x2F;&gt;</span><br><span class="line">  &lt;property name&#x3D;&quot;FILE_PATTERN&quot; value&#x3D;&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS, Asia&#x2F;Seoul&#125; $&#123;LOG_LEVEL_PATTERN:-%5p&#125; $&#123;PID:- &#125; --- [%t] %-40.40logger&#123;39&#125; [%class&#123;5&#125; &gt; %method:%line] : %m%n$&#123;LOG_EXCEPTION_CONVERSION_WORD:-%wEx&#125;&quot;&#x2F;&gt;</span><br><span class="line">  &lt;property name&#x3D;&quot;KAFKA_PATTERN&quot; value&#x3D;&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS, Asia&#x2F;Seoul&#125; %X&#123;wmpHeader&#125; $&#123;LOG_LEVEL_PATTERN:-%5p&#125; [$&#123;java.rmi.server.hostname:-127.0.0.1&#125;] [$&#123;nd.hostname:-localhost&#125;] $&#123;PID:- &#125; --- [%t] %-40.40logger&#123;39&#125; [%class&#123;5&#125; &gt; %method:%line] : %m%n$&#123;LOG_EXCEPTION_CONVERSION_WORD:-%wEx&#125;&quot;&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--  &lt;property name&#x3D;&quot;LOG_PATH&quot; value&#x3D;&quot;$&#123;LOG_PATH:-$&#123;user.home&#125;&#x2F;logs&#125;&quot;&#x2F;&gt;--&gt;</span><br><span class="line">  &lt;property name&#x3D;&quot;LOG_PATH&quot; value&#x3D;&quot;$&#123;LOG_PATH:-$&#123;logging.path&#125;&#125;&quot;&#x2F;&gt;</span><br><span class="line">  &lt;property name&#x3D;&quot;LOG_FILE&quot; value&#x3D;&quot;$&#123;LOG_FILE:-spring&#125;&quot;&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;appender name&#x3D;&quot;CONSOLE_APPENDER&quot; class&#x3D;&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;</span><br><span class="line">    &lt;encoder&gt;</span><br><span class="line">      &lt;pattern&gt;$&#123;CONSOLE_PATTERN&#125;&lt;&#x2F;pattern&gt;</span><br><span class="line">      &lt;charset&gt;utf8&lt;&#x2F;charset&gt;</span><br><span class="line">    &lt;&#x2F;encoder&gt;</span><br><span class="line">  &lt;&#x2F;appender&gt;</span><br><span class="line"></span><br><span class="line">  &lt;appender name&#x3D;&quot;FILE_APPENDER&quot; class&#x3D;&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;</span><br><span class="line">    &lt;file&gt;$&#123;LOG_PATH&#125;&#x2F;$&#123;LOG_FILE&#125;.log&lt;&#x2F;file&gt;</span><br><span class="line">    &lt;rollingPolicy class&#x3D;&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;&gt;</span><br><span class="line">      &lt;fileNamePattern&gt;$&#123;LOG_PATH&#125;&#x2F;old&#x2F;$&#123;LOG_FILE&#125;-%d&#123;yyyyMMdd&#125;.%i.log.gz&lt;&#x2F;fileNamePattern&gt;</span><br><span class="line">      &lt;maxHistory&gt;10&lt;&#x2F;maxHistory&gt;</span><br><span class="line">      &lt;maxFileSize&gt;300MB&lt;&#x2F;maxFileSize&gt;</span><br><span class="line">      &lt;totalSizeCap&gt;300MB&lt;&#x2F;totalSizeCap&gt;</span><br><span class="line">    &lt;&#x2F;rollingPolicy&gt;</span><br><span class="line">    &lt;encoder&gt;</span><br><span class="line">      &lt;pattern&gt;$&#123;FILE_PATTERN&#125;&lt;&#x2F;pattern&gt;</span><br><span class="line">      &lt;charset&gt;utf8&lt;&#x2F;charset&gt;</span><br><span class="line">    &lt;&#x2F;encoder&gt;</span><br><span class="line">  &lt;&#x2F;appender&gt;</span><br><span class="line"></span><br><span class="line">  &lt;appender name&#x3D;&quot;FILE_ERROR_APPENDER&quot; class&#x3D;&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;</span><br><span class="line">    &lt;file&gt;$&#123;LOG_PATH&#125;&#x2F;$&#123;LOG_FILE&#125;-error.log&lt;&#x2F;file&gt;</span><br><span class="line">    &lt;filter class&#x3D;&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;&gt;</span><br><span class="line">      &lt;level&gt;ERROR&lt;&#x2F;level&gt;</span><br><span class="line">    &lt;&#x2F;filter&gt;</span><br><span class="line">    &lt;rollingPolicy class&#x3D;&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;&gt;</span><br><span class="line">      &lt;fileNamePattern&gt;$&#123;LOG_PATH&#125;&#x2F;old&#x2F;$&#123;LOG_FILE&#125;-error-%d&#123;yyyyMMdd&#125;.%i.log.gz&lt;&#x2F;fileNamePattern&gt;</span><br><span class="line">      &lt;maxHistory&gt;10&lt;&#x2F;maxHistory&gt;</span><br><span class="line">      &lt;maxFileSize&gt;300MB&lt;&#x2F;maxFileSize&gt;</span><br><span class="line">      &lt;totalSizeCap&gt;300MB&lt;&#x2F;totalSizeCap&gt;</span><br><span class="line">    &lt;&#x2F;rollingPolicy&gt;</span><br><span class="line">    &lt;encoder&gt;</span><br><span class="line">      &lt;pattern&gt;$&#123;FILE_PATTERN&#125;&lt;&#x2F;pattern&gt;</span><br><span class="line">      &lt;charset&gt;utf8&lt;&#x2F;charset&gt;</span><br><span class="line">    &lt;&#x2F;encoder&gt;</span><br><span class="line">  &lt;&#x2F;appender&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 로그 레벨 설정 --&gt;</span><br><span class="line">  &lt;logger name&#x3D;&quot;java.sql&quot; level&#x3D;&quot;INFO&quot; &#x2F;&gt;</span><br><span class="line">  &lt;logger name&#x3D;&quot;org.apache&quot; level&#x3D;&quot;WARN&quot; &#x2F;&gt;</span><br><span class="line">  &lt;logger name&#x3D;&quot;org.hibernate.SQL&quot; level&#x3D;&quot;INFO&quot; &#x2F;&gt;</span><br><span class="line">  &lt;logger name&#x3D;&quot;org.mybatis.spring&quot; level&#x3D;&quot;INFO&quot; &#x2F;&gt;</span><br><span class="line">  &lt;logger name&#x3D;&quot;org.springframework&quot; level&#x3D;&quot;INFO&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- spring profiles 에 따른 로그 레벨 설정 (spring boot 에서만 설정 가능함.) --&gt;</span><br><span class="line">  &lt;springProfile name&#x3D;&quot;local&quot;&gt;</span><br><span class="line">    &lt;logger name&#x3D;&quot;com.wemakeprice&quot; level&#x3D;&quot;INFO&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 정의 되지 않은 logger 들에게 일괄 적용됨 --&gt;</span><br><span class="line">    &lt;root level&#x3D;&quot;INFO&quot;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;CONSOLE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_ERROR_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;root&gt;</span><br><span class="line">  &lt;&#x2F;springProfile&gt;</span><br><span class="line"></span><br><span class="line">  &lt;springProfile name&#x3D;&quot;dev&quot;&gt;</span><br><span class="line">    &lt;logger name&#x3D;&quot;com.wemakeprice&quot; level&#x3D;&quot;DEBUG&quot; &#x2F;&gt;</span><br><span class="line">    &lt;logger name&#x3D;&quot;com.zaxxer.hikari.HikariConfig&quot; level&#x3D;&quot;DEBUG&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- KAFKA 연동 설정 --&gt;</span><br><span class="line">    &lt;appender name&#x3D;&quot;KAFKA_APPENDER&quot; class&#x3D;&quot;com.github.danielwegener.logback.kafka.KafkaAppender&quot;&gt;</span><br><span class="line">      &lt;!-- This is the default encoder that encodes every log message to an utf8-encoded string  --&gt;</span><br><span class="line">      &lt;encoder class&#x3D;&quot;com.github.danielwegener.logback.kafka.encoding.LayoutKafkaMessageEncoder&quot;&gt;</span><br><span class="line">        &lt;layout class&#x3D;&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;</span><br><span class="line">          &lt;pattern&gt;$&#123;KAFKA_PATTERN&#125;&lt;&#x2F;pattern&gt;</span><br><span class="line">        &lt;&#x2F;layout&gt;</span><br><span class="line">      &lt;&#x2F;encoder&gt;</span><br><span class="line">      &lt;topic&gt;wmp_api_log&lt;&#x2F;topic&gt;</span><br><span class="line">      &lt;keyingStrategy class&#x3D;&quot;com.github.danielwegener.logback.kafka.keying.RoundRobinKeyingStrategy&quot; &#x2F;&gt;</span><br><span class="line">      &lt;deliveryStrategy class&#x3D;&quot;com.github.danielwegener.logback.kafka.delivery.AsynchronousDeliveryStrategy&quot; &#x2F;&gt;</span><br><span class="line">      &lt;producerConfig&gt;bootstrap.servers&#x3D;nd-log-mq.dev.wemakeprice.com:9092&lt;&#x2F;producerConfig&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- don&#39;t wait for a broker to ack the reception of a batch.  --&gt;</span><br><span class="line">      &lt;producerConfig&gt;acks&#x3D;0&lt;&#x2F;producerConfig&gt;</span><br><span class="line">      &lt;!-- even if the producer buffer runs full, do not block the application but start to drop messages --&gt;</span><br><span class="line">      &lt;producerConfig&gt;max.block.ms&#x3D;0&lt;&#x2F;producerConfig&gt;</span><br><span class="line">    &lt;&#x2F;appender&gt;</span><br><span class="line">    &lt;!-- 정의 되지 않은 logger 들에게 일괄 적용됨 --&gt;</span><br><span class="line">    &lt;root level&#x3D;&quot;INFO&quot;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;CONSOLE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_ERROR_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;!-- KAFKA 연동 설정 --&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;KAFKA_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;root&gt;</span><br><span class="line">  &lt;&#x2F;springProfile&gt;</span><br><span class="line"></span><br><span class="line">  &lt;springProfile name&#x3D;&quot;qa&quot;&gt;</span><br><span class="line">    &lt;logger name&#x3D;&quot;com.wemakeprice&quot; level&#x3D;&quot;INFO&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- KAFKA 연동 설정 --&gt;</span><br><span class="line">    &lt;appender name&#x3D;&quot;KAFKA_APPENDER&quot; class&#x3D;&quot;com.github.danielwegener.logback.kafka.KafkaAppender&quot;&gt;</span><br><span class="line">      &lt;!-- This is the default encoder that encodes every log message to an utf8-encoded string  --&gt;</span><br><span class="line">      &lt;encoder class&#x3D;&quot;com.github.danielwegener.logback.kafka.encoding.LayoutKafkaMessageEncoder&quot;&gt;</span><br><span class="line">        &lt;layout class&#x3D;&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;</span><br><span class="line">          &lt;pattern&gt;$&#123;KAFKA_PATTERN&#125;&lt;&#x2F;pattern&gt;</span><br><span class="line">        &lt;&#x2F;layout&gt;</span><br><span class="line">      &lt;&#x2F;encoder&gt;</span><br><span class="line">      &lt;topic&gt;wmp_api_log&lt;&#x2F;topic&gt;</span><br><span class="line">      &lt;keyingStrategy class&#x3D;&quot;com.github.danielwegener.logback.kafka.keying.RoundRobinKeyingStrategy&quot; &#x2F;&gt;</span><br><span class="line">      &lt;deliveryStrategy class&#x3D;&quot;com.github.danielwegener.logback.kafka.delivery.AsynchronousDeliveryStrategy&quot; &#x2F;&gt;</span><br><span class="line">      &lt;producerConfig&gt;bootstrap.servers&#x3D;nd-log-mq.qa.wemakeprice.com:9092&lt;&#x2F;producerConfig&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- don&#39;t wait for a broker to ack the reception of a batch.  --&gt;</span><br><span class="line">      &lt;producerConfig&gt;acks&#x3D;0&lt;&#x2F;producerConfig&gt;</span><br><span class="line">      &lt;!-- even if the producer buffer runs full, do not block the application but start to drop messages --&gt;</span><br><span class="line">      &lt;producerConfig&gt;max.block.ms&#x3D;0&lt;&#x2F;producerConfig&gt;</span><br><span class="line">    &lt;&#x2F;appender&gt;</span><br><span class="line">    &lt;!-- 정의 되지 않은 logger 들에게 일괄 적용됨 --&gt;</span><br><span class="line">    &lt;root level&#x3D;&quot;INFO&quot;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;CONSOLE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_ERROR_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;!-- KAFKA 연동 설정 --&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;KAFKA_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;root&gt;</span><br><span class="line">  &lt;&#x2F;springProfile&gt;</span><br><span class="line"></span><br><span class="line">  &lt;springProfile name&#x3D;&quot;stg&quot;&gt;</span><br><span class="line">    &lt;logger name&#x3D;&quot;com.wemakeprice&quot; level&#x3D;&quot;INFO&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;appender name&#x3D;&quot;KAFKA_APPENDER&quot; class&#x3D;&quot;com.github.danielwegener.logback.kafka.KafkaAppender&quot;&gt;</span><br><span class="line">      &lt;!-- This is the default encoder that encodes every log message to an utf8-encoded string  --&gt;</span><br><span class="line">      &lt;encoder class&#x3D;&quot;com.github.danielwegener.logback.kafka.encoding.LayoutKafkaMessageEncoder&quot;&gt;</span><br><span class="line">        &lt;layout class&#x3D;&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;</span><br><span class="line">          &lt;pattern&gt;$&#123;KAFKA_PATTERN&#125;&lt;&#x2F;pattern&gt;</span><br><span class="line">        &lt;&#x2F;layout&gt;</span><br><span class="line">      &lt;&#x2F;encoder&gt;</span><br><span class="line">      &lt;topic&gt;wmp_api_log&lt;&#x2F;topic&gt;</span><br><span class="line">      &lt;keyingStrategy class&#x3D;&quot;com.github.danielwegener.logback.kafka.keying.RoundRobinKeyingStrategy&quot; &#x2F;&gt;</span><br><span class="line">      &lt;deliveryStrategy class&#x3D;&quot;com.github.danielwegener.logback.kafka.delivery.AsynchronousDeliveryStrategy&quot; &#x2F;&gt;</span><br><span class="line">      &lt;producerConfig&gt;bootstrap.servers&#x3D;nd-log-mq.stg.wemakeprice.com:9092&lt;&#x2F;producerConfig&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- don&#39;t wait for a broker to ack the reception of a batch.  --&gt;</span><br><span class="line">      &lt;producerConfig&gt;acks&#x3D;0&lt;&#x2F;producerConfig&gt;</span><br><span class="line">      &lt;!-- even if the producer buffer runs full, do not block the application but start to drop messages --&gt;</span><br><span class="line">      &lt;producerConfig&gt;max.block.ms&#x3D;0&lt;&#x2F;producerConfig&gt;</span><br><span class="line">    &lt;&#x2F;appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 정의 되지 않은 logger 들에게 일괄 적용됨 --&gt;</span><br><span class="line">    &lt;root level&#x3D;&quot;ERROR&quot;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;CONSOLE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_ERROR_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;!-- KAFKA 연동 설정 --&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;KAFKA_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;root&gt;</span><br><span class="line">  &lt;&#x2F;springProfile&gt;</span><br><span class="line"></span><br><span class="line">  &lt;springProfile name&#x3D;&quot;prod&quot;&gt;</span><br><span class="line">    &lt;logger name&#x3D;&quot;com.wemakeprice&quot; level&#x3D;&quot;INFO&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;appender name&#x3D;&quot;KAFKA_APPENDER&quot; class&#x3D;&quot;com.github.danielwegener.logback.kafka.KafkaAppender&quot;&gt;</span><br><span class="line">      &lt;!-- This is the default encoder that encodes every log message to an utf8-encoded string  --&gt;</span><br><span class="line">      &lt;encoder class&#x3D;&quot;com.github.danielwegener.logback.kafka.encoding.LayoutKafkaMessageEncoder&quot;&gt;</span><br><span class="line">        &lt;layout class&#x3D;&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;</span><br><span class="line">          &lt;pattern&gt;$&#123;KAFKA_PATTERN&#125;&lt;&#x2F;pattern&gt;</span><br><span class="line">        &lt;&#x2F;layout&gt;</span><br><span class="line">      &lt;&#x2F;encoder&gt;</span><br><span class="line">      &lt;topic&gt;wmp_api_log&lt;&#x2F;topic&gt;</span><br><span class="line">      &lt;keyingStrategy class&#x3D;&quot;com.github.danielwegener.logback.kafka.keying.RoundRobinKeyingStrategy&quot; &#x2F;&gt;</span><br><span class="line">      &lt;deliveryStrategy class&#x3D;&quot;com.github.danielwegener.logback.kafka.delivery.AsynchronousDeliveryStrategy&quot; &#x2F;&gt;</span><br><span class="line">      &lt;producerConfig&gt;bootstrap.servers&#x3D;nd-log-mq.wemakeprice.com:9092&lt;&#x2F;producerConfig&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- don&#39;t wait for a broker to ack the reception of a batch.  --&gt;</span><br><span class="line">      &lt;producerConfig&gt;acks&#x3D;0&lt;&#x2F;producerConfig&gt;</span><br><span class="line">      &lt;!-- even if the producer buffer runs full, do not block the application but start to drop messages --&gt;</span><br><span class="line">      &lt;producerConfig&gt;max.block.ms&#x3D;0&lt;&#x2F;producerConfig&gt;</span><br><span class="line">    &lt;&#x2F;appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 정의 되지 않은 logger 들에게 일괄 적용됨 --&gt;</span><br><span class="line">    &lt;root level&#x3D;&quot;ERROR&quot;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;CONSOLE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;FILE_ERROR_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">      &lt;!-- KAFKA 연동 설정 --&gt;</span><br><span class="line">      &lt;appender-ref ref&#x3D;&quot;KAFKA_APPENDER&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;root&gt;</span><br><span class="line">  &lt;&#x2F;springProfile&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;configuration&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>한가지 의문점은 현재 application.yml 및 application-local.yml 의 설정은 spring.active.profile이 local로 기본으로 잡혀있는데, 보통 dev/qa/stg/prod환경을 따로따로 파일을 생성할건데, 타 프로젝트에서는 해당 부분을 구분하는 부분이 안보였다. 어떻게 구분해서 가져오는거지..? (알아봐야겠다…)</p>
<h3 id="2-4-SecurityConfig-SwaggerConfig-WebConfig"><a href="#2-4-SecurityConfig-SwaggerConfig-WebConfig" class="headerlink" title="2-4. SecurityConfig / SwaggerConfig / WebConfig"></a>2-4. SecurityConfig / SwaggerConfig / WebConfig</h3><figure class="highlight java"><figcaption><span>SecurityConfig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.api.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        http.csrf().disable();</span><br><span class="line">        http.authorizeRequests().antMatchers(<span class="string">&quot;/**&quot;</span>).permitAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>SwaggerConfig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.api.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">api</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">            .groupName(<span class="string">&quot;v-ocs-api&quot;</span>)</span><br><span class="line">            .apiInfo(apiInfo())</span><br><span class="line">            .select()</span><br><span class="line">            .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.wemakeprice.v.ocs.api&quot;</span>))</span><br><span class="line">            .paths(PathSelectors.any())</span><br><span class="line">            .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder().title(<span class="string">&quot;V-Ocs-API&quot;</span>).description(<span class="string">&quot;V-Ocs-API LIST &amp; Document&quot;</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>WebConfig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.api.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addRedirectViewController(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;/swagger-ui/index.html&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>여기까지가 API모듈 구성 부분이다. 최종적으로 세팅하면 아래 이미지 처럼 나오게 된다. </p>
<p><img src="/images/multimodule/m-3.png" alt="api모듈 최종"></p>
<h2 id="3-Domain-모듈-구성"><a href="#3-Domain-모듈-구성" class="headerlink" title="3. Domain 모듈 구성"></a>3. Domain 모듈 구성</h2><p>도메인 모듈은 repository와 같이 실질적으로 data에 접근하는 모든 부분을 넣는 모듈이다. 따라서 JPA와 같이 RDBMS나 NoSQL로 데이터를 가져오는 구간이라고 생각하면 된다. 추가적으로 API나 BATCH모듈과 달리 Domain모듈은 Application.java가 필요하지 않다. 그도 그럴것이 도메인은 API/BATCH모듈내 포함되는 구조기때문에 독립적으로 수행되는 부분이 전혀없다. 위에 설정했듯 VOcsDomain.java(빈 interface)만 만들어주면됨. </p>
<h3 id="3-1-build-gradle"><a href="#3-1-build-gradle" class="headerlink" title="3-1. build.gradle"></a>3-1. build.gradle</h3><figure class="highlight plain"><figcaption><span>domain-build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">bootJar&#123;</span><br><span class="line">    enabled &#x3D; false</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">jar &#123;</span><br><span class="line">    enabled &#x3D; true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">buildscript &#123;</span><br><span class="line">    ext &#123;</span><br><span class="line">        querydslPluginVersion &#x3D; &#39;1.0.10&#39;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    repositories &#123;</span><br><span class="line">        maven &#123; url &quot;https:&#x2F;&#x2F;plugins.gradle.org&#x2F;m2&#x2F;&quot; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    implementation(&#39;org.springframework.boot:spring-boot-starter&#39;)</span><br><span class="line">    implementation(&#39;org.springframework.boot:spring-boot-starter-web&#39;)</span><br><span class="line">    implementation(&#39;org.springframework.boot:spring-boot-starter-jdbc&#39;)</span><br><span class="line">    implementation(&#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;)</span><br><span class="line">    implementation(&#39;org.apache.httpcomponents:httpclient&#39;)</span><br><span class="line"></span><br><span class="line">    compile(&quot;com.querydsl:querydsl-core&quot;) &#x2F;&#x2F; querydsl</span><br><span class="line">    compile(&quot;com.querydsl:querydsl-jpa&quot;) &#x2F;&#x2F; querydsl</span><br><span class="line">    annotationProcessor &quot;com.querydsl:querydsl-apt:$&#123;dependencyManagement.importedProperties[&#39;querydsl.version&#39;]&#125;:jpa&quot; &#x2F;&#x2F; querydsl JPAAnnotationProcessor 사용 지정</span><br><span class="line"></span><br><span class="line">    annotationProcessor(&quot;jakarta.persistence:jakarta.persistence-api&quot;)</span><br><span class="line">    annotationProcessor(&quot;jakarta.annotation:jakarta.annotation-api&quot;)</span><br><span class="line"></span><br><span class="line">    runtime &#39;org.hibernate:hibernate-entitymanager&#39;</span><br><span class="line">    runtime &#39;mysql:mysql-connector-java&#39;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    compile group: &#39;org.modelmapper&#39;, name: &#39;modelmapper&#39;, version: &#39;2.1.1&#39;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;* querydsl *&#x2F;</span><br><span class="line">def generated&#x3D;&#39;src&#x2F;main&#x2F;generated&#39;</span><br><span class="line">sourceSets &#123;</span><br><span class="line">    main.java.srcDirs +&#x3D; [ generated ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tasks.withType(JavaCompile) &#123;</span><br><span class="line">    options.annotationProcessorGeneratedSourcesDirectory &#x3D; file(generated)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">clean.doLast &#123;</span><br><span class="line">    file(generated).deleteDir()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-application-domain-yml"><a href="#3-2-application-domain-yml" class="headerlink" title="3-2. application-domain.yml"></a>3-2. application-domain.yml</h3><p>이건 restClient로 연결할 도메인의 주소를 넣은부분이다. </p>
<figure class="highlight plain"><figcaption><span>domain.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v-ocs:</span><br><span class="line">  api-hosts:</span><br><span class="line">    shipping-api: http:&#x2F;&#x2F;s-api-local.codexdawn.com:8080</span><br><span class="line">    front-api: http:&#x2F;&#x2F;front-api-dev.codexdawn.com</span><br></pre></td></tr></table></figure>

<h3 id="3-3-DB-설정-구성"><a href="#3-3-DB-설정-구성" class="headerlink" title="3-3. DB 설정 구성"></a>3-3. DB 설정 구성</h3><h4 id="DBConstant"><a href="#DBConstant" class="headerlink" title="DBConstant"></a>DBConstant</h4><figure class="highlight java"><figcaption><span>DBConstant</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.domain.configuration.db;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBConstant</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Escrow</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String NAME = <span class="string">&quot;escrow&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TRANSACTION = <span class="string">&quot;escrowTransactionManager&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 다른 DB가 있으면 위와 동일한 내용으로 추가해주면됨.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="DBConfig"><a href="#DBConfig" class="headerlink" title="DBConfig"></a>DBConfig</h4><figure class="highlight java"><figcaption><span>DBConfig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.domain.configuration.db;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.google.common.collect.Maps.newHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.configuration.db.DBConstant.Escrow;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.repository.escrow.EscrowRepository;</span><br><span class="line"><span class="keyword">import</span> com.zaxxer.hikari.HikariDataSource;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManagerFactory;</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.jdbc.DataSourceBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AdviceMode;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.env.Environment;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.config.EnableJpaRepositories;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.LazyConnectionDataSourceProxy;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.jpa.JpaTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.PlatformTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableJpaRepositories(basePackageClasses = EscrowRepository.class, entityManagerFactoryRef = &quot;escrowEntityManagerFactory&quot;)</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement(proxyTargetClass = true, mode = AdviceMode.PROXY)</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EscrowDBConfig</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Environment environment;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties(prefix = &quot;spring.datasource.escrow-master&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">escrowMasterDataSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DataSourceBuilder.create().type(HikariDataSource.class).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties(prefix = &quot;spring.datasource.escrow-slave&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">escrowSlaveDataSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DataSourceBuilder.create().type(HikariDataSource.class).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">escrowNamedRoutingDataSource</span><span class="params">(<span class="meta">@Qualifier(&quot;escrowMasterDataSource&quot;)</span> DataSource master, <span class="meta">@Qualifier(&quot;escrowSlaveDataSource&quot;)</span> DataSource slave)</span> </span>&#123;</span><br><span class="line">        NamedRoutingDataSource namedRoutingDataSource = <span class="keyword">new</span> NamedRoutingDataSource();</span><br><span class="line">        Map&lt;Object, Object&gt; datasourceMap = newHashMap();</span><br><span class="line">        datasourceMap.put(<span class="string">&quot;master&quot;</span>,master);</span><br><span class="line">        datasourceMap.put(<span class="string">&quot;slave&quot;</span>,slave);</span><br><span class="line">        namedRoutingDataSource.setTargetDataSources(datasourceMap);</span><br><span class="line">        namedRoutingDataSource.setDefaultTargetDataSource(master);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> namedRoutingDataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">escrowDataSource</span><span class="params">(<span class="meta">@Qualifier(&quot;escrowNamedRoutingDataSource&quot;)</span> DataSource namedRoutingDataSource)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LazyConnectionDataSourceProxy(namedRoutingDataSource);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> EntityManagerFactoryBuilder <span class="title">escrowEntityManagerFactoryBuilder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> EntityManagerFactoryBuilder(<span class="keyword">new</span> HibernateJpaVendorAdapter(), <span class="keyword">new</span> HashMap&lt;&gt;(), <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean(name = &quot;escrowEntityManagerFactory&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocalContainerEntityManagerFactoryBean <span class="title">escrowEntityManagerFactory</span><span class="params">(<span class="meta">@Qualifier(&quot;escrowEntityManagerFactoryBuilder&quot;)</span> EntityManagerFactoryBuilder builder</span></span></span><br><span class="line"><span class="function"><span class="params">        , <span class="meta">@Qualifier(&quot;escrowDataSource&quot;)</span> DataSource dataSource</span></span></span><br><span class="line"><span class="function"><span class="params">        , Map&lt;String,String&gt; jpaProperties)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> builder.dataSource(dataSource).packages(EscrowRepository.class).persistenceUnit(Escrow.NAME).properties(jpaProperties).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean(name = Escrow.TRANSACTION)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PlatformTransactionManager <span class="title">escrowTransactionManager</span><span class="params">(<span class="meta">@Qualifier(&quot;escrowEntityManagerFactory&quot;)</span>EntityManagerFactory entityManagerFactory)</span> </span>&#123;</span><br><span class="line">        JpaTransactionManager jtm = <span class="keyword">new</span> JpaTransactionManager();</span><br><span class="line">        jtm.setEntityManagerFactory(entityManagerFactory);</span><br><span class="line">        <span class="keyword">return</span> jtm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean(name = &quot;jpaProperties&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,String&gt; <span class="title">jpaProperties</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Map&lt;String,String&gt; properties = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        properties.put(<span class="string">&quot;hibernate.show_sql&quot;</span>,environment.getProperty(<span class="string">&quot;spring.jpa.properties.hibernate.show_sql&quot;</span>));</span><br><span class="line">        properties.put(<span class="string">&quot;hibernate.format_sql&quot;</span>,environment.getProperty(<span class="string">&quot;hibernate.format_sql&quot;</span>));</span><br><span class="line">        properties.put(<span class="string">&quot;hibernate.use_sql_comments&quot;</span>,environment.getProperty(<span class="string">&quot;spring.jpa.properties.hibernate.use_sql_comments&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> properties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="NameRoutingDataSource"><a href="#NameRoutingDataSource" class="headerlink" title="NameRoutingDataSource"></a>NameRoutingDataSource</h4><figure class="highlight java"><figcaption><span>NameRoutingDataSource</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.domain.configuration.db;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.lookup.AbstractRoutingDataSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.support.TransactionSynchronizationManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NamedRoutingDataSource</span> <span class="keyword">extends</span> <span class="title">AbstractRoutingDataSource</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">determineCurrentLookupKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> TransactionSynchronizationManager.isCurrentTransactionReadOnly()</span><br><span class="line">            ? <span class="string">&quot;slave&quot;</span> : <span class="string">&quot;master&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="QueryDslConfig"><a href="#QueryDslConfig" class="headerlink" title="QueryDslConfig"></a>QueryDslConfig</h4><figure class="highlight java"><figcaption><span>QueryDslConfig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.shipping.domain.configuration.db;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.querydsl.jpa.impl.JPAQueryFactory;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.shipping.domain.configuration.db.DbConstant.Benefit;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.shipping.domain.configuration.db.DbConstant.Deal;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.shipping.domain.configuration.db.DbConstant.Review;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.shipping.domain.configuration.db.DbConstant.VContent;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManager;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.PersistenceContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryDslConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PersistenceContext(unitName = VContent.NAME)</span></span><br><span class="line">    <span class="keyword">private</span> EntityManager entityManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PersistenceContext(unitName = Deal.NAME)</span></span><br><span class="line">    <span class="keyword">private</span> EntityManager dealEntityManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PersistenceContext(unitName = Review.NAME)</span></span><br><span class="line">    <span class="keyword">private</span> EntityManager reviewEntityManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PersistenceContext(unitName = Benefit.NAME)</span></span><br><span class="line">    <span class="keyword">private</span> EntityManager benefitEntityManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JPAQueryFactory <span class="title">jpaQueryFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JPAQueryFactory(entityManager);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JPAQueryFactory <span class="title">dealJpaQueryFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JPAQueryFactory(dealEntityManager);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JPAQueryFactory <span class="title">reviewJpaQueryFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JPAQueryFactory(reviewEntityManager);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JPAQueryFactory <span class="title">benefitJpaQueryFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JPAQueryFactory(benefitEntityManager);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="VOcsDomainConfiguration"><a href="#VOcsDomainConfiguration" class="headerlink" title="VOcsDomainConfiguration"></a>VOcsDomainConfiguration</h4><figure class="highlight java"><figcaption><span>DBConstant</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.domain.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.VOcsDomain;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.EnableAspectJAutoProxy;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.config.EnableJpaAuditing;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableJpaAuditing</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackageClasses = VOcsDomain.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VOcsDomainConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/multimodule/m-4.png" alt="Domain 모듈 최종"></p>
<h2 id="4-Meta-모듈-구성"><a href="#4-Meta-모듈-구성" class="headerlink" title="4. Meta 모듈 구성"></a>4. Meta 모듈 구성</h2><p>프로젝트는 java gradle 로 만들어주고 root build.gradle에 프로젝트 의존관계 설정해야함.</p>
<figure class="highlight plain"><figcaption><span>build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    id &#39;maven&#39;</span><br><span class="line">&#125;</span><br><span class="line">version &#x3D; &#39;1.0.0.RELEASE&#39;</span><br><span class="line"></span><br><span class="line">bootJar &#123;</span><br><span class="line">    enabled &#x3D; false</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">jar &#123;</span><br><span class="line">    &#x2F;&#x2F; manifest 설정</span><br><span class="line">    manifest &#123;</span><br><span class="line">        attributes(&quot;Built-By&quot;: &quot;Gradle&quot;</span><br><span class="line">                , &quot;Implementation-Version&quot;: project.version)</span><br><span class="line">    &#125;</span><br><span class="line">    enabled &#x3D; true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; source.jar 설정</span><br><span class="line">task sourceJar(type: Jar, dependsOn: classes) &#123;</span><br><span class="line">    classifier &quot;source&quot;</span><br><span class="line">    from sourceSets.main.allSource</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">artifacts &#123;</span><br><span class="line">    archives jar</span><br><span class="line">    archives sourceJar</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">uploadArchives &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        mavenDeployer &#123;</span><br><span class="line">            repository(url: &#39;http:&#x2F;&#x2F;nexus.sys.wemakeprice.com&#x2F;content&#x2F;repositories&#x2F;releases&#x2F;&#39;) &#123;</span><br><span class="line">                authentication(userName: &#39;cft&#39;, password: &#39;0000&#39;)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            snapshotRepository(url: &#39;http:&#x2F;&#x2F;nexus.sys.wemakeprice.com&#x2F;content&#x2F;repositories&#x2F;snapshots&#x2F;&#39;) &#123;</span><br><span class="line">                authentication(userName: &#39;cft&#39;, password: &#39;0000&#39;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/multimodule/m-5.png" alt="Domain 모듈 최종"></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/01/multi-module-1/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 codexdawn. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">codexdawn</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ikbi0v8fyzuu91xv5rmpcrnwb4qinfgborzd5kejmj8wr6ibfra8oaxqshyg.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
