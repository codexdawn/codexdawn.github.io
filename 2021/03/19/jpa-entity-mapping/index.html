
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="codexdawn">
    <title>jpa-entity-mapping - codexdawn</title>
    <meta name="author" content="codexdawn">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"codexdawn","sameAs":["https://github.com/codexdawn","https://www.facebook.com/beherzt.dev","https://www.linkedin.com/in/sim-jisung-3048872a/","mailto:cloudkaiser@gmail.com"],"image":"https://www.gravatar.com/avatar/d97fd4b94c429915f1cb55eb27e7d4d9"},"articleBody":"엔티티 매핑 (Entity Mapping)@Entity@Entity가 붙은 클래스는 JPA가 관리하는것 \n@Entity적용시 주의 사항 \n\n기본생성자는 필수 (public 또는 protected 생성자)\nfinal 클래스, enum,interface,inner클래스에 사용불가 \n저장할 필드에 final 사용불가 \n\n@Table@Table은 Entity와 매핑할 테이블 지정함. 생략하면 Entity 이름을 테이블이름으로 사용 \n다양한 매핑 사용회원 엔티티123456789101112131415161718192021222324252627282930@Entity @Table(name=&quot;MEMBER&quot;)public class Member &#123;\t\t@Id \t@Column(name = &quot;ID&quot;)\tprivate String id;\t\t@Column(name = &quot;NAME&quot;, nullable = false, length = 10) \tprivate String username;\t\tprivate Integer age; \t\t@Enumerated(EnumType.STRING)\tprivate RoleType roleType; \t\tprivate LocalDateTime createdDate; \t\tprivate LocalDateTime lastModifiedDate; \t\t@Lob \tprivate String description; \t\t//Getter, Setter 세팅&#125;public enum RoleType &#123;\tADMIN, USER &#125;\n\n\nRoleType의 @Enumerated설정은 특별한 이유없음 EnumType.STRING 으로 설정하자 (기본값이 ORDINAL 인데 이걸 사용하면 0,1,2..로 지정됨.)\nDate타입은 요즘 사용하는 jpa버전에서는 @Temporal생략하고 LocalDateTime 혹은 LocalDate만 적어도 됨. \ndescription 필드는 회원을 설명하는 필드인데, 길이제한이 없다. 따라서 DB에 varchar타입대신 CLOB으로 저장됨. @Lob을 사용하면 CLOB,BLOB 매핑가능 \n\n데이터베이스 스키마 자동생성persistence.xml에서 스키마 자동생성 기능을 설정할수있음.\n스키자 자동생성 방법1&lt;property name=&quot;hibernate.hbm2ddl.auto&quot; value=&quot;create&quot;/&gt;\n\nhibernate.hbm2ddl.auto 속성 정리\ncreate : 기존 테이블 삭제 하고 새로 생성 (DROP + CREATE) \ncreate-drop : create 기능에서 앱 종료시 다시 DROP 시킴\nupdate : db테이블과 entity매핑 정보 비교해서 변경사항만 수정 \nvalidate : db테이블과 entity매핑 정보 비교해서 차이가 있으면 경고를 남기고 앱 실행 안함. (DDL수행안함)\nnone : 이 기능 사용안하려면 적고, 아니면 property자체를 제거하면 기능 사용 안함. \n\nhibernate.hbm2ddl.auto 사용시 주의사항은 가급적 자동 DDL은 local환경에서 테스트 개발할때 사용하는것 아니면 사용하지말고, 굳이 써야한다면 dev환경에서 validate정도만 쓰는데, 이것도 가급적 사용하지 말자. 그냥 local에서만 잠깐 쓰자. \nDDL 생성 기능엔티티 설정할때 각 필드에 아래와 같이 설정이 가능함 \n@Column(name = “NAME”, nullable = false, length = 10) \n위 기능의 nullable,length를 통해 DDL을 생성할때 위 제약조건을 자동으로 테이블설정에 추가할수있음.이밖에 @Table에 유니크 제약조건도 걸수있음. (uniqueConstraints 참고)\n결론은 위 기능은 hbm2ddl기능을 활성화 했을때만 적용되는 기술이다. 하지만 표기성으로 타 개발자가 제약조건에 대한 설명을 알게 할수있는 기능이 있어서, 추가해주면 나쁘지 않을듯 하다. (굳이 테이블 까서 볼 필요없이 엔티티통해서 한눈에 확인가능)\n기본키 매핑JPA가 제공하는 DB기본키 생성전략 2가지 \n\n직접 할당 : 기본 키를 애플리케이션에서 직접 할당 (@Id 만 사용)\n자동 생성 : 대리키 사용방식 \n\n\nIDENTITY : 기본키 생성을 DB에 위임.  \nSEQUENCE : DB 시퀀스를 사용해서 기본 키를 할당한다. \nTABLE : 키 생성 테이블을 사용. \n\n기본키 직접 할당 전략@Id적용 가능 자바 타입 \n\n자바 기본형 \n자바 래퍼형(warpper)\nString \njava.util.Date\njava.sql.Date\njava.math.BigDecimal\njava.math.BigInteger\n\nIdentity 전략Identity 전략은 기본 키 생성을 DB에 위임하는 전략. 주로 MySql/PostgreSql/SqlServer/DB2에서 사용함.Identity 전략은 AUTO_INCREMENT처럼 DB에 값을 저장하고 나서야 기본 키 값을 구할수 있음 \nentity가 영속상태가 되려면 (persistence context에 저장되려면) 반드시 식별자가 있어야함. 근데 Identity 식별자 생성 전략은 엔티티를 DB에 저장해야 식별자를 구할수있음. 따라서 em.persist()를 호출하는 즉시 insert sql문이 db에 전달됨 (auto flush). 따라서 이 전략은 트랜잭션을 지원하는 쓰기 지연이 동작하지 않는다. \n결론은 Identity전략은 persist를 하는순간 바로 flush가 되기때문에 쓰기지연SQL저장소에는 저장이 안됨. \n\n\nSequence 전략Sequence전략은 유일한 값을 순서대로 생성하는 특별한 DB오브젝트다. 이 전략은 시퀀스를 지원하는 오라클, PostgreSql, DB2, H2에서 사용가능함.시퀀스를 사용하기위해서는 시퀀스 생성 해야함.(CREATE SEQUENCE BOARD_SEQ START WITH 1 INCREAMENT BY 1)\n시퀀스사용방법1234567@Entity @SequenceGenerator(name = &quot;BOARD_SEQ_GENERATOR&quot;, sequnceName = &quot;BOARD_SEQ&quot;, initialValue=1, allocationSize=1)public class Board &#123;\t@Id \t@GenerateValue(strategy= GenerateValue.SEQUENCE, genertor = &quot;BOARD_SEQ_GENERATOR&quot;)\tprivate Long id; &#125;\n\n위 코드의 sequnceName 은 앞서 미리 디비에서 생성한 시퀀스 이름이다. 그리고 allocationSize를 통해서 시퀀스 한번 호출에 증가하는 수를 가져올수있는데,매번 시퀀스 테이블을 조회하는것도 성능상 저하를 일으킬수도 있기때문에 시퀀스를 1개씩만 가져오는것보다 한번에 여러개를 가져와서 쓰고 다쓰면 다시 가져오는 형태로 쓸때 유용하고 성능상 이점을 가져올수있음. 하지만 주의점은 allocationSize는 DDL매핑할때 increment by {allocatiuonSize}인데 1로 설정했으면, 반드시 1로 값을 할당해야함. 기본값은 50이기때문에 반드시 확인해야한다! \n시퀀스 전략은 Identity전략과 내부동작방식이 다르다. 시퀀스 전략은 em.persist()를 호출할때 DB시퀀스테이블을 먼저 식별자값을 조회하고, 조회한 식별자를 엔티티에 할당한 후 엔티티를 Persistence Context에 저장한다. 이후 트랜잭션을 커밋해서 플러스가 일어나면 엔티티를 DB에 저장한다. \nTABLE 전략TABLE전략은 키 생성 전용 테이블을 하나 만들고 여기에 이름과 값으로 사용할 컬럼을 만들어 데이터베이스 시퀀스를 흉내내는 전략이다. 이 전략은 테이블을 사용하므로 모든 DB에 적용가능하다.TABLE전략은 기본적으로 Sequence전략과 유사함. 그리고 @TableGenerator로 시퀀스 생성하듯 유사하게 생성하면됨. (키 전용 테이블 생성해야함.)TABLE전략은 값을 조회하면서 SELECT쿼리를 사용하고 다음 값으로 증가시키기 위해 UPDATE쿼리를 사용한다. 이 전략은 SEQUENCE전략과 비교해서 DB와 한번 더 통신하는 단점이 있다. TABLE전략을 최적화 하려면 시퀀스와 유사하게 @TableGenerator.allocationSize를 사용하면됨. \nAUTO전략AUTO전략은 다양한 DB종류의 맞춰서 IDENTITY,SQUENCE,TABLE전략중 하나를 자동으로 선택해서 사용함. (EX&gt; 오라클=SEQUENCE, MYSQL=IDENTITY)AUTO전략은 DB를 변경해도 코드를 수정할 필요없으며, 특히 키 생성 전략이 아직 확정되지 않은 개발 초기단계나 프로토타입 개발시 편리하게 사용가능하다.AUTO전략을 사용할때 SEQUENCE나 TABLE 전략이 선택되면 시퀀스나 키생성용 테이블을 미리 만들어둬야하는데, 만약 DDL자동생성기능을 사용하면 하이버네이트가 기본값을 사용해서 적절한 시퀀스나 키생성 테이블을 만들어줌. \n@ACCESSJPA가 Entity 데이터에 접근하는 방식을 지정할수있음. \n\n필드 접근: AccessType.FILED로 지정한다. 필드에 직접 접근한다. 필드 접근 권한이 private이어도 접근할수있다. \n프로퍼티 접근: AccessType.PROPERTY로 지정한다. 접근자 Getter를 사용한다. \n\n@Access(AccessType.PROPERTY)는 getter위에 선언하면 entity를통해 받아온 데이터를 getter에 저장한다. \n프로퍼티접근12345678910111213141516@Entitypublic class Member &#123;\t@Id \tprivate Long id; \t\t@Transient \tprivate String firstName; \t\t@Transient \tprivate String lastName; \t\t@Access(AccessType.PROPERTY)\tpublic String getFullName() &#123;\t\treturn firstName + lastName; \t&#125;&#125;\n\n실전 예제Member1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859@Entitypublic class Member &#123;\t@Id    @GeneratedValue    @Column(name = &quot;MEMBER_ID&quot;)    private Long id;    private String name;    private String city; \tprivate String street; \tprivate String zipcode;     // 사실상 양방향으로 매핑할일은 거의 없음.    // 이부분은 학습상 넣어둔 부분임. (실제 설계할때는 반드시 빼야함)    @OneToMany(mappedBy = &quot;member&quot;)    private List&lt;Order&gt; orders = new ArrayList&lt;&gt;();    public Long getId() &#123;        return id;    &#125;    public void setId(Long id) &#123;        this.id = id;    &#125;    public String getName() &#123;        return name;    &#125;    public void setName(String name) &#123;        this.name = name;    &#125;    public List&lt;Order&gt; getOrders() &#123;        return orders;    &#125;    public void setOrders(List&lt;Order&gt; orders) &#123;        this.orders = orders;    &#125;    public String getCity() &#123;\t\treturn city; \t&#125;\t\tpublic void setCity(String city) &#123;\t\tthis.city = city; \t&#125;\t\tpublic String getStreet() &#123;\t\treturn street; \t&#125;\t\tpublic void setStreet(String street) &#123;\t\tthis.street = street; \t&#125;&#125;\n\nOrders123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263@Entity@Table(name = &quot;ORDERS&quot;)public class Order &#123;    @Id    @GeneratedValue    @Column(name = &quot;ORDER_ID&quot;)    private Long id;    @ManyToOne(fetch = FetchType.LAZY)    @JoinColumn(name = &quot;MEMBER_ID&quot;)    private Member member;    private LocalDateTime orderDate;    @Enumerated(EnumType.STRING)    private OrderStatus orderStatus;    @OneToMany(mappedBy = &quot;order&quot;, cascade = CascadeType.ALL)    private List&lt;OrderItem&gt; orderItems = new ArrayList&lt;&gt;();    public List&lt;OrderItem&gt; getOrderItems() &#123;        return orderItems;    &#125;    //연관 관계 편의 메서드 (getter/setter관례와 다르게 네이밍하자)    public void addOrderItem(OrderItem orderItem) &#123;        orderItems.add(orderItem);        orderItem.setOrder(this);    &#125;    public Long getId() &#123;        return id;    &#125;    public void setId(Long id) &#123;        this.id = id;    &#125;    public Member getMember() &#123;        return member;    &#125;    public void setMember(Member member) &#123;        this.member = member;    &#125;    public LocalDateTime getOrderDate() &#123;        return orderDate;    &#125;    public void setOrderDate(LocalDateTime orderDate) &#123;        this.orderDate = orderDate;    &#125;    public OrderStatus getOrderStatus() &#123;        return orderStatus;    &#125;    public void setOrderStatus(OrderStatus orderStatus) &#123;        this.orderStatus = orderStatus;    &#125;&#125;\n\nOrderItem123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657    @Id    @GeneratedValue    @Column(name = &quot;ORDER_ITEM_ID&quot;)    private Long id;    @ManyToOne(fetch = FetchType.LAZY)    @JoinColumn(name = &quot;ORDER_ID&quot;)    private Order order;    @ManyToOne(fetch = FetchType.LAZY)    @JoinColumn(name = &quot;ITEM_ID&quot;)    private Item item;    private int orderPrice;    private int count;    public Long getId() &#123;        return id;    &#125;    public void setId(Long id) &#123;        this.id = id;    &#125;    public Order getOrder() &#123;        return order;    &#125;    public void setOrder(Order order) &#123;        this.order = order;    &#125;    public Item getItem() &#123;        return item;    &#125;    public void setItem(Item item) &#123;        this.item = item;    &#125;    public int getOrderPrice() &#123;        return orderPrice;    &#125;    public void setOrderPrice(int orderPrice) &#123;        this.orderPrice = orderPrice;    &#125;    public int getCount() &#123;        return count;    &#125;    public void setCount(int count) &#123;        this.count = count;    &#125;&#125;\n\nItem1234567891011121314151617181920212223242526272829303132333435@Id@GeneratedValue@Column(name = &quot;ITEM_ID&quot;)private Long id;private String name;private int price;private int stockQuantity;public void setId(Long id) &#123;    this.id = id;&#125;public String getName() &#123;    return name;&#125;public void setName(String name) &#123;    this.name = name;&#125;public int getPrice() &#123;    return price;&#125;public void setPrice(int price) &#123;    this.price = price;&#125;public int getStockQuantity() &#123;    return stockQuantity;&#125;public void setStockQuantity(int stockQuantity) &#123;    this.stockQuantity = stockQuantity;&#125;","dateCreated":"2021-03-19T08:26:18+00:00","dateModified":"2021-03-19T14:06:19+00:00","datePublished":"2021-03-19T08:26:18+00:00","description":"","headline":"jpa-entity-mapping","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"},"publisher":{"@type":"Organization","name":"codexdawn","sameAs":["https://github.com/codexdawn","https://www.facebook.com/beherzt.dev","https://www.linkedin.com/in/sim-jisung-3048872a/","mailto:cloudkaiser@gmail.com"],"image":"https://www.gravatar.com/avatar/d97fd4b94c429915f1cb55eb27e7d4d9","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/d97fd4b94c429915f1cb55eb27e7d4d9"}},"url":"https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/","keywords":"Java,JPA"}</script>
    <meta name="description" content="엔티티 매핑 (Entity Mapping)@Entity@Entity가 붙은 클래스는 JPA가 관리하는것  @Entity적용시 주의 사항   기본생성자는 필수 (public 또는 protected 생성자) final 클래스, enum,interface,inner클래스에 사용불가  저장할 필드에 final 사용불가   @Table@Table은 Entity와 매">
<meta property="og:type" content="blog">
<meta property="og:title" content="jpa-entity-mapping">
<meta property="og:url" content="https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/index.html">
<meta property="og:site_name" content="codexdawn">
<meta property="og:description" content="엔티티 매핑 (Entity Mapping)@Entity@Entity가 붙은 클래스는 JPA가 관리하는것  @Entity적용시 주의 사항   기본생성자는 필수 (public 또는 protected 생성자) final 클래스, enum,interface,inner클래스에 사용불가  저장할 필드에 final 사용불가   @Table@Table은 Entity와 매">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-03-19T08:26:18.000Z">
<meta property="article:modified_time" content="2021-03-19T14:06:19.031Z">
<meta property="article:author" content="codexdawn">
<meta property="article:tag" content="Java,JPA">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-3sspfygaapf5d6tbrnqmyrhdcstv0iwwmi4wor2yeip9c44sowy9gbdzyyjm.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            codexdawn
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/codexdawn"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.facebook.com/beherzt.dev"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/sim-jisung-3048872a/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:cloudkaiser@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            jpa-entity-mapping
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2021-03-19T08:26:18+00:00">
	
		    Mar 19, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Study/">Study</a>, <a class="category-link" href="/categories/%EC%97%94%ED%8B%B0%ED%8B%B0-%EB%A7%A4%ED%95%91/">엔티티 매핑</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%B0%94ORM%ED%91%9C%EC%A4%80JPA%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/">자바ORM표준JPA프로그래밍</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h1 id="엔티티-매핑-Entity-Mapping"><a href="#엔티티-매핑-Entity-Mapping" class="headerlink" title="엔티티 매핑 (Entity Mapping)"></a>엔티티 매핑 (Entity Mapping)</h1><h2 id="Entity"><a href="#Entity" class="headerlink" title="@Entity"></a>@Entity</h2><p>@Entity가 붙은 클래스는 JPA가 관리하는것 </p>
<p>@Entity적용시 주의 사항 </p>
<ul>
<li>기본생성자는 필수 (public 또는 protected 생성자)</li>
<li>final 클래스, enum,interface,inner클래스에 사용불가 </li>
<li>저장할 필드에 final 사용불가 </li>
</ul>
<h2 id="Table"><a href="#Table" class="headerlink" title="@Table"></a>@Table</h2><p>@Table은 Entity와 매핑할 테이블 지정함. 생략하면 Entity 이름을 테이블이름으로 사용 </p>
<h2 id="다양한-매핑-사용"><a href="#다양한-매핑-사용" class="headerlink" title="다양한 매핑 사용"></a>다양한 매핑 사용</h2><figure class="highlight java"><figcaption><span>회원 엔티티</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="meta">@Table(name=&quot;MEMBER&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> </span><br><span class="line">	<span class="meta">@Column(name = &quot;ID&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String id;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(name = &quot;NAME&quot;, nullable = false, length = 10)</span> </span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer age; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Enumerated(EnumType.STRING)</span></span><br><span class="line">	<span class="keyword">private</span> RoleType roleType; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> LocalDateTime createdDate; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> LocalDateTime lastModifiedDate; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Lob</span> </span><br><span class="line">	<span class="keyword">private</span> String description; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//Getter, Setter 세팅</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">RoleType</span> </span>&#123;</span><br><span class="line">	ADMIN, USER </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>RoleType의 @Enumerated설정은 특별한 이유없음 EnumType.STRING 으로 설정하자 (기본값이 ORDINAL 인데 이걸 사용하면 0,1,2..로 지정됨.)</li>
<li>Date타입은 요즘 사용하는 jpa버전에서는 @Temporal생략하고 LocalDateTime 혹은 LocalDate만 적어도 됨. </li>
<li>description 필드는 회원을 설명하는 필드인데, 길이제한이 없다. 따라서 DB에 varchar타입대신 CLOB으로 저장됨. @Lob을 사용하면 CLOB,BLOB 매핑가능 </li>
</ul>
<h2 id="데이터베이스-스키마-자동생성"><a href="#데이터베이스-스키마-자동생성" class="headerlink" title="데이터베이스 스키마 자동생성"></a>데이터베이스 스키마 자동생성</h2><p>persistence.xml에서 스키마 자동생성 기능을 설정할수있음.</p>
<figure class="highlight xml"><figcaption><span>스키자 자동생성 방법</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.hbm2ddl.auto&quot;</span> <span class="attr">value</span>=<span class="string">&quot;create&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="hibernate-hbm2ddl-auto-속성-정리"><a href="#hibernate-hbm2ddl-auto-속성-정리" class="headerlink" title="hibernate.hbm2ddl.auto 속성 정리"></a>hibernate.hbm2ddl.auto 속성 정리</h3><ul>
<li>create : 기존 테이블 삭제 하고 새로 생성 (DROP + CREATE) </li>
<li>create-drop : create 기능에서 앱 종료시 다시 DROP 시킴</li>
<li>update : db테이블과 entity매핑 정보 비교해서 변경사항만 수정 </li>
<li>validate : db테이블과 entity매핑 정보 비교해서 차이가 있으면 경고를 남기고 앱 실행 안함. (DDL수행안함)</li>
<li>none : 이 기능 사용안하려면 적고, 아니면 property자체를 제거하면 기능 사용 안함. </li>
</ul>
<p>hibernate.hbm2ddl.auto 사용시 주의사항은 가급적 자동 DDL은 local환경에서 테스트 개발할때 사용하는것 아니면 사용하지말고, 굳이 써야한다면 dev환경에서 validate정도만 쓰는데, 이것도 가급적 사용하지 말자. 그냥 local에서만 잠깐 쓰자. </p>
<h2 id="DDL-생성-기능"><a href="#DDL-생성-기능" class="headerlink" title="DDL 생성 기능"></a>DDL 생성 기능</h2><p>엔티티 설정할때 각 필드에 아래와 같이 설정이 가능함 </p>
<p>@Column(name = “NAME”, nullable = false, length = 10) </p>
<p>위 기능의 nullable,length를 통해 DDL을 생성할때 위 제약조건을 자동으로 테이블설정에 추가할수있음.<br>이밖에 @Table에 유니크 제약조건도 걸수있음. (uniqueConstraints 참고)</p>
<p>결론은 위 기능은 hbm2ddl기능을 활성화 했을때만 적용되는 기술이다. 하지만 표기성으로 타 개발자가 제약조건에 대한 설명을 알게 할수있는 기능이 있어서, 추가해주면 나쁘지 않을듯 하다. (굳이 테이블 까서 볼 필요없이 엔티티통해서 한눈에 확인가능)</p>
<h2 id="기본키-매핑"><a href="#기본키-매핑" class="headerlink" title="기본키 매핑"></a>기본키 매핑</h2><p>JPA가 제공하는 DB기본키 생성전략 2가지 </p>
<ol>
<li>직접 할당 : 기본 키를 애플리케이션에서 직접 할당 (@Id 만 사용)</li>
<li>자동 생성 : 대리키 사용방식 </li>
</ol>
<ul>
<li>IDENTITY : 기본키 생성을 DB에 위임.  </li>
<li>SEQUENCE : DB 시퀀스를 사용해서 기본 키를 할당한다. </li>
<li>TABLE : 키 생성 테이블을 사용. </li>
</ul>
<h3 id="기본키-직접-할당-전략"><a href="#기본키-직접-할당-전략" class="headerlink" title="기본키 직접 할당 전략"></a>기본키 직접 할당 전략</h3><p>@Id적용 가능 자바 타입 </p>
<ul>
<li>자바 기본형 </li>
<li>자바 래퍼형(warpper)</li>
<li>String </li>
<li>java.util.Date</li>
<li>java.sql.Date</li>
<li>java.math.BigDecimal</li>
<li>java.math.BigInteger</li>
</ul>
<h3 id="Identity-전략"><a href="#Identity-전략" class="headerlink" title="Identity 전략"></a>Identity 전략</h3><p>Identity 전략은 기본 키 생성을 DB에 위임하는 전략. 주로 MySql/PostgreSql/SqlServer/DB2에서 사용함.<br>Identity 전략은 AUTO_INCREMENT처럼 DB에 값을 저장하고 나서야 기본 키 값을 구할수 있음 </p>
<blockquote><p>entity가 영속상태가 되려면 (persistence context에 저장되려면) 반드시 식별자가 있어야함. 근데 Identity 식별자 생성 전략은 엔티티를 DB에 저장해야 식별자를 구할수있음. 따라서 em.persist()를 호출하는 즉시 insert sql문이 db에 전달됨 (auto flush). 따라서 이 전략은 트랜잭션을 지원하는 쓰기 지연이 동작하지 않는다. </p>
<p>결론은 Identity전략은 persist를 하는순간 바로 flush가 되기때문에 쓰기지연SQL저장소에는 저장이 안됨. </p>
</blockquote>

<h3 id="Sequence-전략"><a href="#Sequence-전략" class="headerlink" title="Sequence 전략"></a>Sequence 전략</h3><p>Sequence전략은 유일한 값을 순서대로 생성하는 특별한 DB오브젝트다. 이 전략은 시퀀스를 지원하는 오라클, PostgreSql, DB2, H2에서 사용가능함.<br>시퀀스를 사용하기위해서는 시퀀스 생성 해야함.(CREATE SEQUENCE BOARD_SEQ START WITH 1 INCREAMENT BY 1)</p>
<figure class="highlight java"><figcaption><span>시퀀스사용방법</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="meta">@SequenceGenerator(name = &quot;BOARD_SEQ_GENERATOR&quot;, sequnceName = &quot;BOARD_SEQ&quot;, initialValue=1, allocationSize=1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Board</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> </span><br><span class="line">	<span class="meta">@GenerateValue(strategy= GenerateValue.SEQUENCE, genertor = &quot;BOARD_SEQ_GENERATOR&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위 코드의 sequnceName 은 앞서 미리 디비에서 생성한 시퀀스 이름이다. 그리고 allocationSize를 통해서 시퀀스 한번 호출에 증가하는 수를 가져올수있는데,매번 시퀀스 테이블을 조회하는것도 성능상 저하를 일으킬수도 있기때문에 시퀀스를 1개씩만 가져오는것보다 한번에 여러개를 가져와서 쓰고 다쓰면 다시 가져오는 형태로 쓸때 유용하고 성능상 이점을 가져올수있음. 하지만 주의점은 allocationSize는 DDL매핑할때 increment by {allocatiuonSize}인데 1로 설정했으면, 반드시 1로 값을 할당해야함. 기본값은 50이기때문에 반드시 확인해야한다! </p>
<p>시퀀스 전략은 Identity전략과 내부동작방식이 다르다. 시퀀스 전략은 em.persist()를 호출할때 DB시퀀스테이블을 먼저 식별자값을 조회하고, 조회한 식별자를 엔티티에 할당한 후 엔티티를 Persistence Context에 저장한다. 이후 트랜잭션을 커밋해서 플러스가 일어나면 엔티티를 DB에 저장한다. </p>
<h3 id="TABLE-전략"><a href="#TABLE-전략" class="headerlink" title="TABLE 전략"></a>TABLE 전략</h3><p>TABLE전략은 키 생성 전용 테이블을 하나 만들고 여기에 이름과 값으로 사용할 컬럼을 만들어 데이터베이스 시퀀스를 흉내내는 전략이다. 이 전략은 테이블을 사용하므로 모든 DB에 적용가능하다.<br>TABLE전략은 기본적으로 Sequence전략과 유사함. 그리고 @TableGenerator로 시퀀스 생성하듯 유사하게 생성하면됨. (키 전용 테이블 생성해야함.)<br>TABLE전략은 값을 조회하면서 SELECT쿼리를 사용하고 다음 값으로 증가시키기 위해 UPDATE쿼리를 사용한다. 이 전략은 SEQUENCE전략과 비교해서 DB와 한번 더 통신하는 단점이 있다. TABLE전략을 최적화 하려면 시퀀스와 유사하게 @TableGenerator.allocationSize를 사용하면됨. </p>
<h3 id="AUTO전략"><a href="#AUTO전략" class="headerlink" title="AUTO전략"></a>AUTO전략</h3><p>AUTO전략은 다양한 DB종류의 맞춰서 IDENTITY,SQUENCE,TABLE전략중 하나를 자동으로 선택해서 사용함. (EX&gt; 오라클=SEQUENCE, MYSQL=IDENTITY)<br>AUTO전략은 DB를 변경해도 코드를 수정할 필요없으며, 특히 키 생성 전략이 아직 확정되지 않은 개발 초기단계나 프로토타입 개발시 편리하게 사용가능하다.<br>AUTO전략을 사용할때 SEQUENCE나 TABLE 전략이 선택되면 시퀀스나 키생성용 테이블을 미리 만들어둬야하는데, 만약 DDL자동생성기능을 사용하면 하이버네이트가 기본값을 사용해서 적절한 시퀀스나 키생성 테이블을 만들어줌. </p>
<h2 id="ACCESS"><a href="#ACCESS" class="headerlink" title="@ACCESS"></a>@ACCESS</h2><p>JPA가 Entity 데이터에 접근하는 방식을 지정할수있음. </p>
<ul>
<li>필드 접근: AccessType.FILED로 지정한다. 필드에 직접 접근한다. 필드 접근 권한이 private이어도 접근할수있다. </li>
<li>프로퍼티 접근: AccessType.PROPERTY로 지정한다. 접근자 Getter를 사용한다. </li>
</ul>
<p>@Access(AccessType.PROPERTY)는 getter위에 선언하면 entity를통해 받아온 데이터를 getter에 저장한다. </p>
<figure class="highlight java"><figcaption><span>프로퍼티접근</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> </span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Transient</span> </span><br><span class="line">	<span class="keyword">private</span> String firstName; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Transient</span> </span><br><span class="line">	<span class="keyword">private</span> String lastName; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Access(AccessType.PROPERTY)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFullName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> firstName + lastName; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="실전-예제"><a href="#실전-예제" class="headerlink" title="실전 예제"></a>실전 예제</h1><figure class="highlight java"><figcaption><span>Member</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;MEMBER_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String city; </span><br><span class="line">	<span class="keyword">private</span> String street; </span><br><span class="line">	<span class="keyword">private</span> String zipcode; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 사실상 양방향으로 매핑할일은 거의 없음.</span></span><br><span class="line">    <span class="comment">// 이부분은 학습상 넣어둔 부분임. (실제 설계할때는 반드시 빼야함)</span></span><br><span class="line">    <span class="meta">@OneToMany(mappedBy = &quot;member&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Order&gt; orders = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Order&gt; <span class="title">getOrders</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orders;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrders</span><span class="params">(List&lt;Order&gt; orders)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orders = orders;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> city; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity</span><span class="params">(String city)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.city = city; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getStreet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> street; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStreet</span><span class="params">(String street)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.street = street; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>Orders</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;ORDERS&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;ORDER_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;MEMBER_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Member member;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime orderDate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Enumerated(EnumType.STRING)</span></span><br><span class="line">    <span class="keyword">private</span> OrderStatus orderStatus;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OneToMany(mappedBy = &quot;order&quot;, cascade = CascadeType.ALL)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;OrderItem&gt; orderItems = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;OrderItem&gt; <span class="title">getOrderItems</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderItems;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//연관 관계 편의 메서드 (getter/setter관례와 다르게 네이밍하자)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addOrderItem</span><span class="params">(OrderItem orderItem)</span> </span>&#123;</span><br><span class="line">        orderItems.add(orderItem);</span><br><span class="line">        orderItem.setOrder(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Member <span class="title">getMember</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> member;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMember</span><span class="params">(Member member)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.member = member;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocalDateTime <span class="title">getOrderDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderDate</span><span class="params">(LocalDateTime orderDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderDate = orderDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> OrderStatus <span class="title">getOrderStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderStatus;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderStatus</span><span class="params">(OrderStatus orderStatus)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderStatus = orderStatus;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>OrderItem</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;ORDER_ITEM_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;ORDER_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Order order;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;ITEM_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Item item;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> orderPrice;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Order <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrder</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.order = order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Item <span class="title">getItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setItem</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.item = item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrderPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderPrice;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderPrice</span><span class="params">(<span class="keyword">int</span> orderPrice)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderPrice = orderPrice;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCount</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.count = count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>Item</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Id</span></span><br><span class="line"><span class="meta">@GeneratedValue</span></span><br><span class="line"><span class="meta">@Column(name = &quot;ITEM_ID&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Long id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> stockQuantity;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> price;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.price = price;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getStockQuantity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> stockQuantity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStockQuantity</span><span class="params">(<span class="keyword">int</span> stockQuantity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.stockQuantity = stockQuantity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Java-JPA/" rel="tag">Java,JPA</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/03/24/relation-mapping-basic/"
                    data-tooltip="relation-mapping-basic"
                    aria-label="PREVIOUS: relation-mapping-basic"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/03/18/jpa-persistence/"
                    data-tooltip="jpa-persistence"
                    aria-label="NEXT: jpa-persistence"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 codexdawn. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/03/24/relation-mapping-basic/"
                    data-tooltip="relation-mapping-basic"
                    aria-label="PREVIOUS: relation-mapping-basic"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/03/18/jpa-persistence/"
                    data-tooltip="jpa-persistence"
                    aria-label="NEXT: jpa-persistence"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://codexdawn.github.io/2021/03/19/jpa-entity-mapping/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">codexdawn</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ikbi0v8fyzuu91xv5rmpcrnwb4qinfgborzd5kejmj8wr6ibfra8oaxqshyg.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
