
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="codexdawn">
    <title>variable-relation-mapping - codexdawn</title>
    <meta name="author" content="codexdawn">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"codexdawn","sameAs":["https://github.com/codexdawn","https://www.facebook.com/beherzt.dev","https://www.linkedin.com/in/sim-jisung-3048872a/","mailto:cloudkaiser@gmail.com"],"image":"https://www.gravatar.com/avatar/d97fd4b94c429915f1cb55eb27e7d4d9"},"articleBody":"다양한 연관관계 매핑다대일 (N:1)항상 기억해야하는 부분은 객체 양방향 관계에서 연관관계 주인은 항상 N쪽이다. \n\n\n다대일 단방향 (N:1)N:1 단방향 예시123456789101112131415161718192021222324252627@Entitypublic class Member &#123;    @Id @GeneratedValue    @Column(name = &quot;member_id&quot;)    private Long id;    private String userName;    private int age;    @ManyToOne(fetch = FetchType.LAZY)    @JoinColumn(name = &quot;team_id&quot;)    private Team team;\t\t//나머지 생략 &#125;@Entitypublic class Team &#123;    @Id @GeneratedValue    @Column(name = &quot;team_id&quot;)    private Long id;    private String name;    //나머지생략&#125;\n\n\nMember는 Member.team으로 팀 엔티티를 참조할수 있지만 반대로 팀에는 Member로 참조하는 필드가 없다. 따라서 회원 과 팀은 단방향 연관관계다. \nMember.team 필드로 회원 테이블의 team_id 외래키를 관리함. \n\n다대일 양방향 (N:1, 1:N)N:1,N:1 양방향 예시12345678910111213141516171819202122232425262728293031323334353637@Entitypublic class Member &#123;    @Id @GeneratedValue    @Column(name = &quot;member_id&quot;)    private Long id;    private String userName;    private int age;    @ManyToOne(fetch = FetchType.LAZY)    @JoinColumn(name = &quot;team_id&quot;)    private Team team;\t\t\t//연관관계 편의 메소드 \tpublic void changeTeam(Team team) &#123;        this.team = team;        team.getMembers().add(this);    &#125;\t\t//나머지 생략 &#125;@Entitypublic class Team &#123;    @Id @GeneratedValue    @Column(name = &quot;team_id&quot;)    private Long id;    private String name;\t\t@OneToMany(mappedBy = &quot;team&quot;)    private List&lt;Member&gt; members = new ArrayList&lt;&gt;();\t    //나머지생략&#125;\n\n양방향은 외래키가 있는 쪽이 연관관계 주인이다.\n항상 N 쪽에 연관관계 주인 이다. 따라서 주인은 외래키를 통해 수정권한이 주어지지만, 주인이 아닌 반대방향은 조회만 가능하다. (JPQL,객체그래프 탐색할때 사용)\n\n양방향 연관관계는 항상 서로를 참조해야 한다.\n양방향 연관관계는 항상 서로 참조해야함. 어느 한쪽만 참조하면 양방향 연관관계가 성립하지 않는다. \n서로 참조하려면 연관관계 편의 메소드 를 작성하는것을 추천 (ex&gt; changeTeam) \n연관관계 편의 메소드 작성시 주의점은 한쪽 엔티티에만 존재해야함. 양쪽다 편의메소드를 작성하면 나중에 무한루프에 빠질수있음. \n\n일대다 (1:N)일대다는 다대일 관계의 반대방향이다. 일대다 관계는 엔티티를 하나 이상 참조할수 있으므로 자바 컬렉션인 Collection, List, Set, Map 중에 하나를 사용해야한다. \n일대다 단방향 (1:N)일대다 단방향은 가급적 추천하지 않는 방식이다. 아래 단점을 확인해보자. \n일대다 단방향 매핑의 단점\n매핑한 객체가 관리하는 외래키가 다른 테이블에 있다는점. \nN:1 방식처럼 외래키를 관리하면 INSERT문을 한번만 날리면되지만, 1:N방식은 INSERT문을 수행하고 UPDATE문도 동시에 수행해야함.결론은 일대다 단방향 매핑보다는 다대일 양방향 매핑을 사용하자 \n\n일대다 양방향 (1:N, N:1)\n원칙상 일대다 양방향 매핑은 존재하지 않는다. 하지만 꼼수를 통해서 가능은한데, 비주인 엔티티(ex&gt; Member)에 @Column 쪽에서 insertable, updatable을 false로 막아놓는다. \n하지만 절대로 권장하는 방식이 아니며, 다대일 양방향 매핑을 활용하는 방향으로 가자! \n\n일대일 (1:1)\n일대일 관계는 그 반대도 일대일 관계\n테이블 관계에서 일대다, 다대일은 항상 N쪽이 외래 키를 가진다. 반면에 일대일 관계는 주테이블이나 대상테이블 둘 중 어느곳이나 외래키를 가질수 있다. \n\n1:1은 그럼 어디에 외래키를 가져야할까? \n\n주테이블에 외래키 \n\n주객체가 대상 객체를 참조하는것처럼 주테이블에 외래키를 두고 대상 테이블을 참조한다. 외래키를 객체 참조와 비슷하게 사용 할수 있어서 객체지향 개발자들이 선호한다. 이방법의 장점은 주 테이블이 외래키를 가지고 있으므로 주 테이블만 확인해도 대상테이블과 연관관계가 있는지 알수있음. \n\n\n대상 테이블에 외래키 \n\n전통적인 DB개발자들은 보통 대상 테이블에 외래키를 두는것을 선호함. 이 방법의 장점은 테이블 관계를 일대일에서 일대다로 변경할 때 테이블 구조를 그대로 유지할수 있다. \n\n\n\n\n\n주 테이블의 외래키단방향1:1 단방향 예시123456789101112131415161718192021222324252627@Entitypublic class Member &#123;    @Id @GeneratedValue    @Column(name = &quot;member_id&quot;)    private Long id;    private String userName;    private int age;    @OneToOne    @JoinColumn(name = &quot;locker_id&quot;)    private Locker locker;\t\t//나머지 생략 &#125;@Entitypublic class Locker &#123;    @Id @GeneratedValue    @Column(name = &quot;locker_id&quot;)    private Long id;    private String name;\t    //나머지생략&#125;\n\n양방향1:1 양방향 예시123456789101112131415161718192021222324252627282930@Entitypublic class Member &#123;    @Id @GeneratedValue    @Column(name = &quot;member_id&quot;)    private Long id;    private String userName;    private int age;    @OneToOne    @JoinColumn(name = &quot;locker_id&quot;)    private Locker locker;\t\t//나머지 생략 &#125;@Entitypublic class Locker &#123;    @Id @GeneratedValue    @Column(name = &quot;locker_id&quot;)    private Long id;    private String name;\t\t@OneToOne(mappedBy = &quot;locker&quot;)\tprivate Member member; \t    //나머지생략&#125;\n\n대상 테이블에 외래 키단방향\n일대일관계중 대상 테이블의 외래키의 단방향은 JPA에서 지원안됨. \n이때는 단방향 관계를 Locker에서 Member방향으로 수정하거나 양방향 관계로 만들고, Locker를 연관관계의 주인으로 설정해야함. 이 방법은 다음 양방향에서 알아보자. \n\n양방향1:1 대상테이블의 외래키 양방향 예시123456789101112131415161718192021222324252627282930@Entitypublic class Member &#123;    @Id @GeneratedValue    @Column(name = &quot;member_id&quot;)    private Long id;    private String userName;    private int age;    @OneToOne(mappedBy = &quot;member&quot;)    private Locker locker;\t\t//나머지 생략 &#125;@Entitypublic class Locker &#123;    @Id @GeneratedValue    @Column(name = &quot;locker_id&quot;)    private Long id;    private String name;\t\t@OneToOne\t@JoinColumn(name = &quot;member_id&quot;)\tprivate Member member; \t    //나머지생략&#125;\n\n다대다 (N:N)정규화된 테이블 2개로 다대다 관계를 표현할수없다. 그래서 보통 다대다 관계를 일대다, 다대일 관계로 풀어내는 연결테이블을 사용한다. \n다대다(N:N): 단방향N:N 단방향 예시123456789101112131415161718192021222324252627@Entitypublic class Member &#123;    @Id @GeneratedValue    @Column(name = &quot;member_id&quot;)    private Long id;    private String userName;    private int age;    @ManyToMany \t@JoinTable(name = &quot;member_product&quot;, joinColumns= @JoinColumn(name= &quot;member_id&quot;), inverseJoinColumn = @JoinColumn(name = &quot;product_id&quot;))\tprivate List&lt;Product&gt; products = new ArrayList&lt;&gt;(); \t\t//나머지 생략 &#125;@Entitypublic class Product &#123;    @Id @GeneratedValue    @Column(name = &quot;locker_id&quot;)    private Long id;    private String name;\t    //나머지생략&#125;\n\n다대다(N:N): 양방향N:N 단방향 예시123456789101112131415161718192021222324252627282930@Entitypublic class Member &#123;    @Id @GeneratedValue    @Column(name = &quot;member_id&quot;)    private Long id;    private String userName;    private int age;    @ManyToMany \t@JoinTable(name = &quot;member_product&quot;, joinColumns= @JoinColumn(name= &quot;member_id&quot;), inverseJoinColumn = @JoinColumn(name = &quot;product_id&quot;))\tprivate List&lt;Product&gt; products = new ArrayList&lt;&gt;(); \t\t//나머지 생략 &#125;@Entitypublic class Product &#123;    @Id @GeneratedValue    @Column(name = &quot;locker_id&quot;)    private Long id;    private String name;\t\t@ManyToMany(mappedBy = &quot;products&quot;) //역방향 추가 \tprivate List&lt;Member&gt; members = new ArrayList&lt;&gt;(); \t    //나머지생략&#125;\n\n\n다대다 양방향에서도 기존 양방향과 동일하게 편의 메소드를 추가해주면 됨.\n\n다대다: 매핑의 한계와 극복, 연결 엔티티 사용@ManyToMany를 활용해서 연관관계 매핑을 자동으로 처리하므로 도메인 모델이 단순해지고 편리한부분이 있지만, 실무에서 사용하기엔 한계가 있다.예를들어 회원이 상품을 주문하면 연결 테이블에 단순히 주문한 회원 아이디와 상품아이디만 담고 끝나지 않는다. 보통은 연결테이블에 주문 수량 컬럼이나 주문한 날짜 같은 컬럼이 더 필요할때가 있다. @ManyToMany상황에서 연결테이블(Member_Product)에 주문수량과 주문날짜를 추가하면 더이상 @ManyToMany로 관리되기 어렵다. 왜냐하면 주문 엔티티나 상품엔티티에는 추가한 컬럼들을 매핑할수 없기때문이다.위 사항을 극복하려면 연결 엔티티를 만들고 추가한 컬럼들을 매핑해야한다. 그리고 엔티티 간의 관계도 테이블 관계처럼 다대다에서 일대다, 다대일 관계로 풀어야한다. 아래코드로 확인해보자. \nN:N 양방향 극복방법12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849@Entitypublic class Member &#123;    @Id @GeneratedValue    @Column(name = &quot;member_id&quot;)    private Long id;    private String userName;    private int age;    @OneToMany(mappedBy=&quot;member&quot;)\tprivate List&lt;MemberProduct&gt; memberProduct; \t\t//나머지 생략 &#125;@Entitypublic class Product &#123;    @Id @GeneratedValue    @Column(name = &quot;locker_id&quot;)    private Long id;    private String name;\t    //나머지생략&#125;@Entity@IdClass(MemberProductId.class)public class MemberProduct &#123;\t@Id\t@ManyToOne\t@JoinColomn(name = &quot;member_id&quot;)\tprivate Member member; \t\t@Id\t@ManyToOne\t@JoinColumn(name = &quot;product_id&quot;)\tprivate Product product; \t\t//생략 &#125;public class MemberProductId implements Serializable &#123;\tprivate String member;  // MemberProduct.member와 연결\tprivate String product; // MemberProduct.product와 연결\t\t//hashCode and equals재정의 &#125;\n\n회원상품(MemberProduct) 엔티티를 보면 기본키를 매핑하는 @Id와 외래키를 매핑하는 @JoinColumn을 동시에 사용해서 기본키 + 외래키를 한번에 매핑했다. 그리고 @IdClass를 사용해서 복합 기본키를 매핑했다. \n복합 기본키\nJPA에서 복합키를 사용하려면 식별자 클래스를 만들어야함. 그리고 @IdClass로 지정하면됨. \n\n복합키를 위한 식별자클래스 특징 \n\n복합키는 별도의 식별자 클래스로 만들어야한다.\nSerializable을 구현해야한다.\nequals 와 hashCode를 재정의 해야함.\n기본 생성자가 있어야함.\n식별자 클래스는 반드시 public 접근제한자를 가져야함.\n@IdClass를 사용하는 방법외에 @EmbeddedId를 사용하는 방법도 있음. \n\n\n\n식별 관계회원상품은 회원과 상품의 기본키를 받아서 자신의 기본키로 사용한다. 이렇게 부모 테이블의 기본키를 받아서 자신의 기본키+외래키로 사용하는것을 DB용어로 식별관계라고한다. \n위 와같이 복합키로 구성해서 저장과 조회는 어떻게 할까? \n복합키 저장&조회12345678910111213141516171819202122232425262728public void save() &#123;\tMember member = new Member();\tmember.setUsername(&quot;m1&quot;);\tem.persist(member);\t\tProduct product = new Product();\tproduct.setName(&quot;p1&quot;);\tem.persist(product); \t\tMemberProduct memberProduct = new MemberProduct();\tmemberProduct.setMember(member1); //주문회원 - 연관관계 설정\tmemberProduct.setProduct(product1); //주문상품 - 연관관계 설정 \tmemberProduct.setOrderAmount(2); //주문수량\tem.persist(memberProduct); &#125;public void find() &#123;\tMemberProductId memberProductId = new MemberProductId();\tmemberProductId.setMember(&quot;m1&quot;);\tmemberProductID.setProduct(&quot;p1&quot;);\t\tMemberProduct memberProduct = em.find(MemberProduct.class, memberProductId);\t\tMember member = memberProduct.getMember(); \tProduct product = memberProduct.getProduct(); \t\t//출력 생략&#125;\n\n\n이렇게 보니까 어떨까? 겁나 복잡시럽다. 이해하기도 어렵고 챙겨야할 부분이 너무 많다는걸 알수있다. \n그럼 이것보다 더 간단하게 만드는 방법은 어떻게 해야할까? 다음챕터를 보면 알수있다. \n\n다대다(N:N): 새로운 기본키 사용결론부터 말하면, 새로운 엔티티를 만드는것이다. 복합키로 복잡하게 키를 생성하는것보다, 새로운 엔티티로 대리키(자동생성키)를 사용하는것이다.그럼 위 정보를 기반으로 회원상품은 결국 Orders 라는 엔티티로 만드는것이 더 어울릴것이다. \norders 엔티티12345678910111213141516171819 @Entity@IdClass(MemberProductId.class)public class MemberProduct &#123;\t\t@Id \t@GeneratedValue\tprivate Long id;  //대리키  생성 \t\t@ManyToOne\t@JoinColomn(name = &quot;member_id&quot;)\tprivate Member member; \t\t@ManyToOne\t@JoinColumn(name = &quot;product_id&quot;)\tprivate Product product; \t\t//생략 &#125;\n\n위와 같이 만들면 끝이다. 나머지 조회나 수정은 유사하게 사용하면 끝! \n실습코드실습예제123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347@Entitypublic class Member &#123;    @Id    @GeneratedValue    @Column(name = &quot;MEMBER_ID&quot;)    private Long id;    private String name;    @Embedded    private Address address;    // 사실상 양방향으로 매핑할일은 거의 없음.    // 이부분은 학습상 넣어둔 부분임. (실제 설계할때는 반드시 빼야함)    @OneToMany(mappedBy = &quot;member&quot;)    private List&lt;Order&gt; orders = new ArrayList&lt;&gt;();    public Long getId() &#123;        return id;    &#125;    public void setId(Long id) &#123;        this.id = id;    &#125;    public String getName() &#123;        return name;    &#125;    public void setName(String name) &#123;        this.name = name;    &#125;    public List&lt;Order&gt; getOrders() &#123;        return orders;    &#125;    public void setOrders(List&lt;Order&gt; orders) &#123;        this.orders = orders;    &#125;    public Address getAddress() &#123;        return address;    &#125;    public void setAddress(Address address) &#123;        this.address = address;    &#125;&#125;@Entity@Table(name = &quot;ORDERS&quot;)public class Order &#123;    @Id    @GeneratedValue    @Column(name = &quot;ORDER_ID&quot;)    private Long id;    @ManyToOne(fetch = FetchType.LAZY)    @JoinColumn(name = &quot;MEMBER_ID&quot;)    private Member member;    @OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)    @JoinColumn(name = &quot;DELIVERY_ID&quot;)    private Delivery delivery;    private LocalDateTime orderDate;    @Enumerated(EnumType.STRING)    private OrderStatus orderStatus;    @OneToMany(mappedBy = &quot;order&quot;, cascade = CascadeType.ALL)    private List&lt;OrderItem&gt; orderItems = new ArrayList&lt;&gt;();    public List&lt;OrderItem&gt; getOrderItems() &#123;        return orderItems;    &#125;    //연관 관계 편의 메서드 (getter/setter관례와 다르게 네이밍하자)    public void addOrderItem(OrderItem orderItem) &#123;        orderItems.add(orderItem);        orderItem.setOrder(this);    &#125;    public Long getId() &#123;        return id;    &#125;    public void setId(Long id) &#123;        this.id = id;    &#125;    public Member getMember() &#123;        return member;    &#125;    public void setMember(Member member) &#123;        this.member = member;    &#125;    public LocalDateTime getOrderDate() &#123;        return orderDate;    &#125;    public void setOrderDate(LocalDateTime orderDate) &#123;        this.orderDate = orderDate;    &#125;    public OrderStatus getOrderStatus() &#123;        return orderStatus;    &#125;    public void setOrderStatus(OrderStatus orderStatus) &#123;        this.orderStatus = orderStatus;    &#125;    public Delivery getDelivery() &#123;        return delivery;    &#125;    public void setDelivery(Delivery delivery) &#123;        this.delivery = delivery;    &#125;&#125;@Entitypublic class Delivery &#123;    @Id @GeneratedValue    @Column(name = &quot;DELIVERY_ID&quot;)    private Long id;    @OneToOne(mappedBy = &quot;delivery&quot;, fetch = FetchType.LAZY)    private Order order;    @Embedded    private Address address;    @Enumerated(EnumType.STRING)    private DeliveryStatus deliveryStatus;    public Long getId() &#123;        return id;    &#125;    public void setId(Long id) &#123;        this.id = id;    &#125;    public Order getOrder() &#123;        return order;    &#125;    public void addOrder(Order order) &#123;        this.order = order;        order.setDelivery(this);    &#125;    public Address getAddress() &#123;        return address;    &#125;    public void setAddress(Address address) &#123;        this.address = address;    &#125;    public DeliveryStatus getDeliveryStatus() &#123;        return deliveryStatus;    &#125;    public void setDeliveryStatus(DeliveryStatus deliveryStatus) &#123;        this.deliveryStatus = deliveryStatus;    &#125;&#125;@Entitypublic class OrderItem &#123;    @Id    @GeneratedValue    @Column(name = &quot;ORDER_ITEM_ID&quot;)    private Long id;    @ManyToOne(fetch = FetchType.LAZY)    @JoinColumn(name = &quot;ORDER_ID&quot;)    private Order order;    @ManyToOne(fetch = FetchType.LAZY)    @JoinColumn(name = &quot;ITEM_ID&quot;)    private Item item;    private int orderPrice;    private int count;    public Long getId() &#123;        return id;    &#125;    public void setId(Long id) &#123;        this.id = id;    &#125;    public Order getOrder() &#123;        return order;    &#125;    public void setOrder(Order order) &#123;        this.order = order;    &#125;    public Item getItem() &#123;        return item;    &#125;    public void setItem(Item item) &#123;        this.item = item;    &#125;    public int getOrderPrice() &#123;        return orderPrice;    &#125;    public void setOrderPrice(int orderPrice) &#123;        this.orderPrice = orderPrice;    &#125;    public int getCount() &#123;        return count;    &#125;    public void setCount(int count) &#123;        this.count = count;    &#125;&#125;@Entity@Inheritance(strategy = InheritanceType.JOINED)@DiscriminatorColumnpublic abstract class Item &#123;    @Id    @GeneratedValue    @Column(name = &quot;ITEM_ID&quot;)    private Long id;    private String name;    private int price;    private int stockQuantity;    @ManyToMany(mappedBy = &quot;items&quot;)    private List&lt;Category&gt; categories = new ArrayList&lt;&gt;();    public Long getId() &#123;        return id;    &#125;    public void setId(Long id) &#123;        this.id = id;    &#125;    public String getName() &#123;        return name;    &#125;    public void setName(String name) &#123;        this.name = name;    &#125;    public int getPrice() &#123;        return price;    &#125;    public void setPrice(int price) &#123;        this.price = price;    &#125;    public int getStockQuantity() &#123;        return stockQuantity;    &#125;    public void setStockQuantity(int stockQuantity) &#123;        this.stockQuantity = stockQuantity;    &#125;&#125;@Entitypublic class Category &#123;    @Id @GeneratedValue    private Long id;    private String name;    @ManyToOne(fetch = FetchType.LAZY)    @JoinColumn(name = &quot;PARENT_ID&quot;)    private Category parent;    @OneToMany(mappedBy = &quot;parent&quot;)    private List&lt;Category&gt; child = new ArrayList&lt;&gt;();    @ManyToMany    @JoinTable(name = &quot;CATEGORY_ITEM&quot;        , joinColumns = @JoinColumn(name = &quot;CATEGORY_ID&quot;)        ,inverseJoinColumns = @JoinColumn(name = &quot;ITEM_ID&quot;))    private List&lt;Item&gt; items = new ArrayList&lt;&gt;();    public Long getId() &#123;        return id;    &#125;    public void setId(Long id) &#123;        this.id = id;    &#125;    public String getName() &#123;        return name;    &#125;    public void setName(String name) &#123;        this.name = name;    &#125;    public Category getParent() &#123;        return parent;    &#125;    public void setParent(Category parent) &#123;        this.parent = parent;    &#125;    public List&lt;Category&gt; getChild() &#123;        return child;    &#125;    public void setChild(List&lt;Category&gt; child) &#123;        this.child = child;    &#125;    public List&lt;Item&gt; getItems() &#123;        return items;    &#125;    public void setItems(List&lt;Item&gt; items) &#123;        this.items = items;    &#125;&#125;","dateCreated":"2021-03-30T02:16:25+00:00","dateModified":"2021-03-31T10:45:55+00:00","datePublished":"2021-03-30T02:16:25+00:00","description":"","headline":"variable-relation-mapping","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"},"publisher":{"@type":"Organization","name":"codexdawn","sameAs":["https://github.com/codexdawn","https://www.facebook.com/beherzt.dev","https://www.linkedin.com/in/sim-jisung-3048872a/","mailto:cloudkaiser@gmail.com"],"image":"https://www.gravatar.com/avatar/d97fd4b94c429915f1cb55eb27e7d4d9","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/d97fd4b94c429915f1cb55eb27e7d4d9"}},"url":"https://codexdawn.github.io/2021/03/30/variable-relation-mapping/","keywords":"Java,JPA"}</script>
    <meta name="description" content="다양한 연관관계 매핑다대일 (N:1)항상 기억해야하는 부분은 객체 양방향 관계에서 연관관계 주인은 항상 N쪽이다.    다대일 단방향 (N:1)N:1 단방향 예시123456789101112131415161718192021222324252627@Entitypublic class Member &amp;#123;    @Id @GeneratedValue    @Colu">
<meta property="og:type" content="blog">
<meta property="og:title" content="variable-relation-mapping">
<meta property="og:url" content="https://codexdawn.github.io/2021/03/30/variable-relation-mapping/index.html">
<meta property="og:site_name" content="codexdawn">
<meta property="og:description" content="다양한 연관관계 매핑다대일 (N:1)항상 기억해야하는 부분은 객체 양방향 관계에서 연관관계 주인은 항상 N쪽이다.    다대일 단방향 (N:1)N:1 단방향 예시123456789101112131415161718192021222324252627@Entitypublic class Member &amp;#123;    @Id @GeneratedValue    @Colu">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-03-30T02:16:25.000Z">
<meta property="article:modified_time" content="2021-03-31T10:45:55.688Z">
<meta property="article:author" content="codexdawn">
<meta property="article:tag" content="Java,JPA">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-3sspfygaapf5d6tbrnqmyrhdcstv0iwwmi4wor2yeip9c44sowy9gbdzyyjm.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            codexdawn
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/codexdawn"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.facebook.com/beherzt.dev"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/sim-jisung-3048872a/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:cloudkaiser@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            variable-relation-mapping
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2021-03-30T02:16:25+00:00">
	
		    Mar 30, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Study/">Study</a>, <a class="category-link" href="/categories/%EB%8B%A4%EC%96%91%ED%95%9C-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/">다양한 연관관계 매핑</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%B0%94ORM%ED%91%9C%EC%A4%80JPA%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/">자바ORM표준JPA프로그래밍</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h1 id="다양한-연관관계-매핑"><a href="#다양한-연관관계-매핑" class="headerlink" title="다양한 연관관계 매핑"></a>다양한 연관관계 매핑</h1><h2 id="다대일-N-1"><a href="#다대일-N-1" class="headerlink" title="다대일 (N:1)"></a>다대일 (N:1)</h2><blockquote><p>항상 기억해야하는 부분은 객체 양방향 관계에서 연관관계 주인은 항상 N쪽이다. </p>
</blockquote>

<h3 id="다대일-단방향-N-1"><a href="#다대일-단방향-N-1" class="headerlink" title="다대일 단방향 (N:1)"></a>다대일 단방향 (N:1)</h3><figure class="highlight java"><figcaption><span>N:1 단방향 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;member_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;team_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Team team;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//나머지 생략 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Team</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;team_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//나머지생략</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Member는 Member.team으로 팀 엔티티를 참조할수 있지만 반대로 팀에는 Member로 참조하는 필드가 없다. 따라서 회원 과 팀은 단방향 연관관계다. </li>
<li>Member.team 필드로 회원 테이블의 team_id 외래키를 관리함. </li>
</ul>
<h3 id="다대일-양방향-N-1-1-N"><a href="#다대일-양방향-N-1-1-N" class="headerlink" title="다대일 양방향 (N:1, 1:N)"></a>다대일 양방향 (N:1, 1:N)</h3><figure class="highlight java"><figcaption><span>N:1,N:1 양방향 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;member_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;team_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Team team;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//연관관계 편의 메소드 </span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changeTeam</span><span class="params">(Team team)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.team = team;</span><br><span class="line">        team.getMembers().add(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//나머지 생략 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Team</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;team_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToMany(mappedBy = &quot;team&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Member&gt; members = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//나머지생략</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="양방향은-외래키가-있는-쪽이-연관관계-주인이다"><a href="#양방향은-외래키가-있는-쪽이-연관관계-주인이다" class="headerlink" title="양방향은 외래키가 있는 쪽이 연관관계 주인이다."></a>양방향은 외래키가 있는 쪽이 연관관계 주인이다.</h4><ul>
<li>항상 N 쪽에 <strong>연관관계 주인</strong> 이다. 따라서 주인은 외래키를 통해 수정권한이 주어지지만, 주인이 아닌 반대방향은 조회만 가능하다. (JPQL,객체그래프 탐색할때 사용)</li>
</ul>
<h4 id="양방향-연관관계는-항상-서로를-참조해야-한다"><a href="#양방향-연관관계는-항상-서로를-참조해야-한다" class="headerlink" title="양방향 연관관계는 항상 서로를 참조해야 한다."></a>양방향 연관관계는 항상 서로를 참조해야 한다.</h4><ul>
<li>양방향 연관관계는 항상 서로 참조해야함. 어느 한쪽만 참조하면 양방향 연관관계가 성립하지 않는다. </li>
<li>서로 참조하려면 <strong>연관관계 편의 메소드</strong> 를 작성하는것을 추천 (ex&gt; changeTeam) </li>
<li>연관관계 편의 메소드 작성시 주의점은 한쪽 엔티티에만 존재해야함. 양쪽다 편의메소드를 작성하면 나중에 무한루프에 빠질수있음. </li>
</ul>
<h2 id="일대다-1-N"><a href="#일대다-1-N" class="headerlink" title="일대다 (1:N)"></a>일대다 (1:N)</h2><p>일대다는 다대일 관계의 반대방향이다. 일대다 관계는 엔티티를 하나 이상 참조할수 있으므로 자바 컬렉션인 Collection, List, Set, Map 중에 하나를 사용해야한다. </p>
<h3 id="일대다-단방향-1-N"><a href="#일대다-단방향-1-N" class="headerlink" title="일대다 단방향 (1:N)"></a>일대다 단방향 (1:N)</h3><p>일대다 단방향은 가급적 추천하지 않는 방식이다. 아래 단점을 확인해보자. </p>
<h4 id="일대다-단방향-매핑의-단점"><a href="#일대다-단방향-매핑의-단점" class="headerlink" title="일대다 단방향 매핑의 단점"></a>일대다 단방향 매핑의 단점</h4><ol>
<li>매핑한 객체가 관리하는 외래키가 다른 테이블에 있다는점. </li>
<li>N:1 방식처럼 외래키를 관리하면 INSERT문을 한번만 날리면되지만, 1:N방식은 INSERT문을 수행하고 UPDATE문도 동시에 수행해야함.<br>결론은 <strong>일대다 단방향 매핑보다는 다대일 양방향 매핑을 사용하자</strong> </li>
</ol>
<h3 id="일대다-양방향-1-N-N-1"><a href="#일대다-양방향-1-N-N-1" class="headerlink" title="일대다 양방향 (1:N, N:1)"></a>일대다 양방향 (1:N, N:1)</h3><ul>
<li>원칙상 일대다 양방향 매핑은 존재하지 않는다. 하지만 꼼수를 통해서 가능은한데, 비주인 엔티티(ex&gt; Member)에 @Column 쪽에서 insertable, updatable을 false로 막아놓는다. </li>
<li>하지만 절대로 권장하는 방식이 아니며, 다대일 양방향 매핑을 활용하는 방향으로 가자! </li>
</ul>
<h2 id="일대일-1-1"><a href="#일대일-1-1" class="headerlink" title="일대일 (1:1)"></a>일대일 (1:1)</h2><ul>
<li>일대일 관계는 그 반대도 일대일 관계</li>
<li>테이블 관계에서 일대다, 다대일은 항상 N쪽이 외래 키를 가진다. 반면에 일대일 관계는 주테이블이나 대상테이블 둘 중 어느곳이나 외래키를 가질수 있다. </li>
</ul>
<blockquote><p>1:1은 그럼 어디에 외래키를 가져야할까? </p>
<ol>
<li><p>주테이블에 외래키 </p>
<ul>
<li>주객체가 대상 객체를 참조하는것처럼 주테이블에 외래키를 두고 대상 테이블을 참조한다. 외래키를 객체 참조와 비슷하게 사용 할수 있어서 객체지향 개발자들이 선호한다. 이방법의 장점은 주 테이블이 외래키를 가지고 있으므로 주 테이블만 확인해도 대상테이블과 연관관계가 있는지 알수있음. </li>
</ul>
</li>
<li><p>대상 테이블에 외래키 </p>
<ul>
<li>전통적인 DB개발자들은 보통 대상 테이블에 외래키를 두는것을 선호함. 이 방법의 장점은 테이블 관계를 일대일에서 일대다로 변경할 때 테이블 구조를 그대로 유지할수 있다. </li>
</ul>
</li>
</ol>
</blockquote>

<h3 id="주-테이블의-외래키"><a href="#주-테이블의-외래키" class="headerlink" title="주 테이블의 외래키"></a>주 테이블의 외래키</h3><h4 id="단방향"><a href="#단방향" class="headerlink" title="단방향"></a>단방향</h4><figure class="highlight java"><figcaption><span>1:1 단방향 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;member_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OneToOne</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;locker_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Locker locker;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//나머지 생략 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Locker</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;locker_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//나머지생략</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="양방향"><a href="#양방향" class="headerlink" title="양방향"></a>양방향</h4><figure class="highlight java"><figcaption><span>1:1 양방향 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;member_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OneToOne</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;locker_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Locker locker;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//나머지 생략 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Locker</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;locker_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToOne(mappedBy = &quot;locker&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Member member; </span><br><span class="line">	</span><br><span class="line">    <span class="comment">//나머지생략</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="대상-테이블에-외래-키"><a href="#대상-테이블에-외래-키" class="headerlink" title="대상 테이블에 외래 키"></a>대상 테이블에 외래 키</h3><h4 id="단방향-1"><a href="#단방향-1" class="headerlink" title="단방향"></a>단방향</h4><ul>
<li>일대일관계중 대상 테이블의 외래키의 단방향은 JPA에서 지원안됨. </li>
<li>이때는 단방향 관계를 Locker에서 Member방향으로 수정하거나 양방향 관계로 만들고, Locker를 연관관계의 주인으로 설정해야함. 이 방법은 다음 양방향에서 알아보자. </li>
</ul>
<h4 id="양방향-1"><a href="#양방향-1" class="headerlink" title="양방향"></a>양방향</h4><figure class="highlight java"><figcaption><span>1:1 대상테이블의 외래키 양방향 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;member_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OneToOne(mappedBy = &quot;member&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Locker locker;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//나머지 생략 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Locker</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;locker_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;member_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Member member; </span><br><span class="line">	</span><br><span class="line">    <span class="comment">//나머지생략</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="다대다-N-N"><a href="#다대다-N-N" class="headerlink" title="다대다 (N:N)"></a>다대다 (N:N)</h2><p>정규화된 테이블 2개로 다대다 관계를 표현할수없다. 그래서 보통 다대다 관계를 일대다, 다대일 관계로 풀어내는 연결테이블을 사용한다. </p>
<h3 id="다대다-N-N-단방향"><a href="#다대다-N-N-단방향" class="headerlink" title="다대다(N:N): 단방향"></a>다대다(N:N): 단방향</h3><figure class="highlight java"><figcaption><span>N:N 단방향 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;member_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToMany</span> </span><br><span class="line">	<span class="meta">@JoinTable(name = &quot;member_product&quot;, joinColumns= @JoinColumn(name= &quot;member_id&quot;), inverseJoinColumn = @JoinColumn(name = &quot;product_id&quot;))</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;Product&gt; products = <span class="keyword">new</span> ArrayList&lt;&gt;(); </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//나머지 생략 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;locker_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//나머지생략</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="다대다-N-N-양방향"><a href="#다대다-N-N-양방향" class="headerlink" title="다대다(N:N): 양방향"></a>다대다(N:N): 양방향</h3><figure class="highlight java"><figcaption><span>N:N 단방향 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;member_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToMany</span> </span><br><span class="line">	<span class="meta">@JoinTable(name = &quot;member_product&quot;, joinColumns= @JoinColumn(name= &quot;member_id&quot;), inverseJoinColumn = @JoinColumn(name = &quot;product_id&quot;))</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;Product&gt; products = <span class="keyword">new</span> ArrayList&lt;&gt;(); </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//나머지 생략 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;locker_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToMany(mappedBy = &quot;products&quot;)</span> <span class="comment">//역방향 추가 </span></span><br><span class="line">	<span class="keyword">private</span> List&lt;Member&gt; members = <span class="keyword">new</span> ArrayList&lt;&gt;(); </span><br><span class="line">	</span><br><span class="line">    <span class="comment">//나머지생략</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>다대다 양방향에서도 기존 양방향과 동일하게 편의 메소드를 추가해주면 됨.</li>
</ul>
<h3 id="다대다-매핑의-한계와-극복-연결-엔티티-사용"><a href="#다대다-매핑의-한계와-극복-연결-엔티티-사용" class="headerlink" title="다대다: 매핑의 한계와 극복, 연결 엔티티 사용"></a>다대다: 매핑의 한계와 극복, 연결 엔티티 사용</h3><p>@ManyToMany를 활용해서 연관관계 매핑을 자동으로 처리하므로 도메인 모델이 단순해지고 편리한부분이 있지만, 실무에서 사용하기엔 한계가 있다.<br>예를들어 회원이 상품을 주문하면 연결 테이블에 단순히 주문한 회원 아이디와 상품아이디만 담고 끝나지 않는다. 보통은 연결테이블에 주문 수량 컬럼이나 주문한 날짜 같은 컬럼이 더 필요할때가 있다. @ManyToMany상황에서 연결테이블(Member_Product)에 주문수량과 주문날짜를 추가하면 더이상 @ManyToMany로 관리되기 어렵다. 왜냐하면 주문 엔티티나 상품엔티티에는 추가한 컬럼들을 매핑할수 없기때문이다.<br>위 사항을 극복하려면 연결 엔티티를 만들고 추가한 컬럼들을 매핑해야한다. 그리고 엔티티 간의 관계도 테이블 관계처럼 다대다에서 일대다, 다대일 관계로 풀어야한다. 아래코드로 확인해보자. </p>
<figure class="highlight java"><figcaption><span>N:N 양방향 극복방법</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;member_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OneToMany(mappedBy=&quot;member&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;MemberProduct&gt; memberProduct; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//나머지 생략 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;locker_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//나머지생략</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@IdClass(MemberProductId.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberProduct</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColomn(name = &quot;member_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Member member; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;product_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Product product; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//생략 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberProductId</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String member;  <span class="comment">// MemberProduct.member와 연결</span></span><br><span class="line">	<span class="keyword">private</span> String product; <span class="comment">// MemberProduct.product와 연결</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//hashCode and equals재정의 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>회원상품(MemberProduct) 엔티티를 보면 기본키를 매핑하는 @Id와 외래키를 매핑하는 @JoinColumn을 동시에 사용해서 기본키 + 외래키를 한번에 매핑했다. 그리고 @IdClass를 사용해서 복합 기본키를 매핑했다. </p>
<h4 id="복합-기본키"><a href="#복합-기본키" class="headerlink" title="복합 기본키"></a>복합 기본키</h4><ul>
<li>JPA에서 복합키를 사용하려면 식별자 클래스를 만들어야함. 그리고 @IdClass로 지정하면됨. </li>
</ul>
<blockquote><p>복합키를 위한 식별자클래스 특징 </p>
<ul>
<li>복합키는 별도의 식별자 클래스로 만들어야한다.</li>
<li>Serializable을 구현해야한다.</li>
<li>equals 와 hashCode를 재정의 해야함.</li>
<li>기본 생성자가 있어야함.</li>
<li>식별자 클래스는 반드시 public 접근제한자를 가져야함.</li>
<li>@IdClass를 사용하는 방법외에 @EmbeddedId를 사용하는 방법도 있음. </li>
</ul>
</blockquote>

<h4 id="식별-관계"><a href="#식별-관계" class="headerlink" title="식별 관계"></a>식별 관계</h4><p>회원상품은 회원과 상품의 기본키를 받아서 자신의 기본키로 사용한다. 이렇게 부모 테이블의 기본키를 받아서 자신의 기본키+외래키로 사용하는것을 DB용어로 식별관계라고한다. </p>
<p>위 와같이 복합키로 구성해서 저장과 조회는 어떻게 할까? </p>
<figure class="highlight java"><figcaption><span>복합키 저장&조회</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Member member = <span class="keyword">new</span> Member();</span><br><span class="line">	member.setUsername(<span class="string">&quot;m1&quot;</span>);</span><br><span class="line">	em.persist(member);</span><br><span class="line">	</span><br><span class="line">	Product product = <span class="keyword">new</span> Product();</span><br><span class="line">	product.setName(<span class="string">&quot;p1&quot;</span>);</span><br><span class="line">	em.persist(product); </span><br><span class="line">	</span><br><span class="line">	MemberProduct memberProduct = <span class="keyword">new</span> MemberProduct();</span><br><span class="line">	memberProduct.setMember(member1); <span class="comment">//주문회원 - 연관관계 설정</span></span><br><span class="line">	memberProduct.setProduct(product1); <span class="comment">//주문상품 - 연관관계 설정 </span></span><br><span class="line">	memberProduct.setOrderAmount(<span class="number">2</span>); <span class="comment">//주문수량</span></span><br><span class="line">	em.persist(memberProduct); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">find</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	MemberProductId memberProductId = <span class="keyword">new</span> MemberProductId();</span><br><span class="line">	memberProductId.setMember(<span class="string">&quot;m1&quot;</span>);</span><br><span class="line">	memberProductID.setProduct(<span class="string">&quot;p1&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	MemberProduct memberProduct = em.find(MemberProduct.class, memberProductId);</span><br><span class="line">	</span><br><span class="line">	Member member = memberProduct.getMember(); </span><br><span class="line">	Product product = memberProduct.getProduct(); </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//출력 생략</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>이렇게 보니까 어떨까? 겁나 복잡시럽다. 이해하기도 어렵고 챙겨야할 부분이 너무 많다는걸 알수있다. </li>
<li>그럼 이것보다 더 간단하게 만드는 방법은 어떻게 해야할까? 다음챕터를 보면 알수있다. </li>
</ul>
<h3 id="다대다-N-N-새로운-기본키-사용"><a href="#다대다-N-N-새로운-기본키-사용" class="headerlink" title="다대다(N:N): 새로운 기본키 사용"></a>다대다(N:N): 새로운 기본키 사용</h3><p>결론부터 말하면, 새로운 엔티티를 만드는것이다. 복합키로 복잡하게 키를 생성하는것보다, 새로운 엔티티로 대리키(자동생성키)를 사용하는것이다.<br>그럼 위 정보를 기반으로 회원상품은 결국 Orders 라는 엔티티로 만드는것이 더 어울릴것이다. </p>
<figure class="highlight java"><figcaption><span>orders 엔티티</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@IdClass(MemberProductId.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberProduct</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> </span><br><span class="line">	<span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="keyword">private</span> Long id;  <span class="comment">//대리키  생성 </span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColomn(name = &quot;member_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Member member; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;product_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Product product; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//생략 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위와 같이 만들면 끝이다. 나머지 조회나 수정은 유사하게 사용하면 끝! </p>
<h2 id="실습코드"><a href="#실습코드" class="headerlink" title="실습코드"></a>실습코드</h2><figure class="highlight java"><figcaption><span>실습예제</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;MEMBER_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Embedded</span></span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 사실상 양방향으로 매핑할일은 거의 없음.</span></span><br><span class="line">    <span class="comment">// 이부분은 학습상 넣어둔 부분임. (실제 설계할때는 반드시 빼야함)</span></span><br><span class="line">    <span class="meta">@OneToMany(mappedBy = &quot;member&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Order&gt; orders = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Order&gt; <span class="title">getOrders</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orders;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrders</span><span class="params">(List&lt;Order&gt; orders)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orders = orders;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Address <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(Address address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;ORDERS&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;ORDER_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;MEMBER_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Member member;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;DELIVERY_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Delivery delivery;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime orderDate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Enumerated(EnumType.STRING)</span></span><br><span class="line">    <span class="keyword">private</span> OrderStatus orderStatus;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OneToMany(mappedBy = &quot;order&quot;, cascade = CascadeType.ALL)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;OrderItem&gt; orderItems = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;OrderItem&gt; <span class="title">getOrderItems</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderItems;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//연관 관계 편의 메서드 (getter/setter관례와 다르게 네이밍하자)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addOrderItem</span><span class="params">(OrderItem orderItem)</span> </span>&#123;</span><br><span class="line">        orderItems.add(orderItem);</span><br><span class="line">        orderItem.setOrder(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Member <span class="title">getMember</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> member;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMember</span><span class="params">(Member member)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.member = member;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocalDateTime <span class="title">getOrderDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderDate</span><span class="params">(LocalDateTime orderDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderDate = orderDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> OrderStatus <span class="title">getOrderStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderStatus;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderStatus</span><span class="params">(OrderStatus orderStatus)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderStatus = orderStatus;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Delivery <span class="title">getDelivery</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> delivery;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDelivery</span><span class="params">(Delivery delivery)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.delivery = delivery;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Delivery</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;DELIVERY_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OneToOne(mappedBy = &quot;delivery&quot;, fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="keyword">private</span> Order order;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Embedded</span></span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Enumerated(EnumType.STRING)</span></span><br><span class="line">    <span class="keyword">private</span> DeliveryStatus deliveryStatus;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Order <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addOrder</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.order = order;</span><br><span class="line">        order.setDelivery(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Address <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(Address address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DeliveryStatus <span class="title">getDeliveryStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> deliveryStatus;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDeliveryStatus</span><span class="params">(DeliveryStatus deliveryStatus)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.deliveryStatus = deliveryStatus;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderItem</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;ORDER_ITEM_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;ORDER_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Order order;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;ITEM_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Item item;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> orderPrice;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Order <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrder</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.order = order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Item <span class="title">getItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setItem</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.item = item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrderPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderPrice;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderPrice</span><span class="params">(<span class="keyword">int</span> orderPrice)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderPrice = orderPrice;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCount</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.count = count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Inheritance(strategy = InheritanceType.JOINED)</span></span><br><span class="line"><span class="meta">@DiscriminatorColumn</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;ITEM_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> stockQuantity;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToMany(mappedBy = &quot;items&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Category&gt; categories = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getStockQuantity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stockQuantity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStockQuantity</span><span class="params">(<span class="keyword">int</span> stockQuantity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stockQuantity = stockQuantity;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;PARENT_ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Category parent;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OneToMany(mappedBy = &quot;parent&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Category&gt; child = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToMany</span></span><br><span class="line">    <span class="meta">@JoinTable(name = &quot;CATEGORY_ITEM&quot;</span></span><br><span class="line"><span class="meta">        , joinColumns = @JoinColumn(name = &quot;CATEGORY_ID&quot;)</span></span><br><span class="line"><span class="meta">        ,inverseJoinColumns = @JoinColumn(name = &quot;ITEM_ID&quot;))</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Item&gt; items = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getParent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> parent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setParent</span><span class="params">(Category parent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.parent = parent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">getChild</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> child;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setChild</span><span class="params">(List&lt;Category&gt; child)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.child = child;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Item&gt; <span class="title">getItems</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> items;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setItems</span><span class="params">(List&lt;Item&gt; items)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items = items;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Java-JPA/" rel="tag">Java,JPA</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/04/19/high-end-mapping/"
                    data-tooltip="high-end-mapping"
                    aria-label="PREVIOUS: high-end-mapping"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/03/29/reactive-1/"
                    data-tooltip="reactive-1"
                    aria-label="NEXT: reactive-1"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2022 codexdawn. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/04/19/high-end-mapping/"
                    data-tooltip="high-end-mapping"
                    aria-label="PREVIOUS: high-end-mapping"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/03/29/reactive-1/"
                    data-tooltip="reactive-1"
                    aria-label="NEXT: reactive-1"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://codexdawn.github.io/2021/03/30/variable-relation-mapping/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">codexdawn</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ikbi0v8fyzuu91xv5rmpcrnwb4qinfgborzd5kejmj8wr6ibfra8oaxqshyg.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
