
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="codexdawn">
    <title>holder-pattern - codexdawn</title>
    <meta name="author" content="codexdawn">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"codexdawn","sameAs":["https://github.com/codexdawn","https://www.facebook.com/beherzt.dev","https://www.linkedin.com/in/sim-jisung-3048872a/","mailto:cloudkaiser@gmail.com"],"image":"https://www.gravatar.com/avatar/d97fd4b94c429915f1cb55eb27e7d4d9"},"articleBody":"Holder 패턴 사용하기!Holder 패턴이란?문맥 자체만 봐도 어느정도 느낌이 오겠지만, Holder는 소유자라는 뜻으로 어떠한 정보를 소유하고 있는 객체를 의미한다.어떠한 정보를 component로 bean등록하여 호출해서 사용하면 끝이다. 여기서 포인트는 세팅하는 데이터가 영구적으로 오래사용되는 케이스가 많다는부분이다.주로 사용할수있는 부분이 header정보를 갖고있는 RequestHolder, 세션으로 부터 넘겨받은 사용자 정보를 갖고있는 userHolder, 스프링 서버 환경별 정보를 갖고있는 profileHolder등정보를 묶어놓고 필요할때 가져다 쓰는 형태를 의미한다. \n적용방법RequestHolder 사용사례123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121@Component@RequiredArgsConstructorpublic class VRequestInterceptor extends HandlerInterceptorAdapter &#123;\tprivate static final List&lt;String&gt; IGNORE_URLS = Lists.newArrayList(&quot;/hello&quot;,&quot;/lbStatusCheck&quot;,&quot;/servicemanager/prometheus&quot;);    private final VRequestHolder vRequestHolder;    @Override    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123;        if (IGNORE_URLS.contains(request.getRequestURI())) &#123;            return true;        &#125;        vRequestHolder.build(request);        return true;    &#125;&#125;@Getter@RequiredArgsConstructor@Component@Scope(value = &quot;request&quot;, proxyMode= ScopedProxyMode.TARGET_CLASS)public class VRequestHolder &#123;    private final ProfileHolder profileHolder;    private UserAgentType userAgentType;    private boolean isLogin;    private AppName appName;    private String appVersion;    private String loginUserInfo;    private String cartInfo;    private String clientIp;    public HttpHeaders getHeaderInfo() &#123;        HttpHeaders headerInfo = new HttpHeaders();        headerInfo.set(USER_AGENT_TYPE, userAgentType.name());        headerInfo.set(LOGIN_USER_INFO, loginUserInfo);        headerInfo.set(NON_USER_INFO, nonUserInfo);        headerInfo.set(WMP_APP_NAME,appName.getHeadValue());        headerInfo.set(MOBILE_APP_VERSION, appVersion);        headerInfo.set(CART_INFO, cartInfo);        headerInfo.set(CLIENT_IP, clientIp);        return headerInfo;    &#125;    public void build(HttpServletRequest request) &#123;        String mid = request.getHeader(MID);        if (isNotEmpty(mid)) &#123;            this.mid = Long.valueOf(mid);            this.isLogin = true;        &#125;        setLoginUserInfo(request);        setNonUserInfo(request);        setAppName(request);        setUserAgentType(request);        setAppVersion(request);        setCartInfo(request);        setClientIp(request);    &#125;    private void setLoginUserInfo(HttpServletRequest request) &#123;        String loginUserInfo = request.getHeader(WmpHeaderKey.LOGIN_USER_INFO);        if (isNotBlank(loginUserInfo)) &#123;            this.loginUserInfo = loginUserInfo;        &#125;    &#125;    private void setNonUserInfo(HttpServletRequest request) &#123;        String nonUserInfo = request.getHeader(WmpHeaderKey.NON_USER_INFO);        if (isNotBlank(nonUserInfo)) &#123;            this.nonUserInfo = nonUserInfo;        &#125;    &#125;    public void setAppVersion(HttpServletRequest request) &#123;        String appVersion = request.getHeader(WmpHeaderKey.MOBILE_APP_VERSION);        if (isNotBlank(appVersion)) &#123;            this.appVersion = appVersion;        &#125;        log.info(&quot;VRequestHolder.setAppVersion - &#123;&#125;&quot;, request.getHeader(WmpHeaderKey.MOBILE_APP_VERSION));    &#125;    private void setAppName(HttpServletRequest request) &#123;        String displayServiceTypeAsString = request.getParameter(DISPLAY_SERVICE_TYPE_PARAMETER);        if (isNotEmpty(displayServiceTypeAsString)) &#123;            DisplayServiceType displayServiceType = DisplayServiceType.findDefaultVertical(displayServiceTypeAsString);            this.appName = (DisplayServiceType.VERTICAL == displayServiceType) ? AppName.WStyle : AppName.WMP;            return ;        &#125;        log.info(&quot;VRequestHolder.setAppName - &#123;&#125;&quot;, request.getHeader(WmpHeaderKey.WMP_APP_NAME));        this.appName = AppName.find(request.getHeader(WmpHeaderKey.WMP_APP_NAME));    &#125;    private void setUserAgentType(HttpServletRequest request) &#123;        log.info(&quot;VRequestHolder.setUserAgentType - &#123;&#125;&quot;, request.getHeader(USER_AGENT_TYPE));        String userAgentType = request.getHeader(USER_AGENT_TYPE);        this.userAgentType = isEmpty(userAgentType) ? APP : UserAgentType.findByName(userAgentType);    &#125;    private void setCartInfo(HttpServletRequest request) &#123;        String cartInfo = request.getHeader(CART_INFO);        if (isNotBlank(cartInfo)) &#123;            this.cartInfo = cartInfo;        &#125;    &#125;    private void setClientIp(HttpServletRequest request) &#123;        String clientIp = request.getHeader(CLIENT_IP);        if (isNotBlank(clientIp)) &#123;            this.clientIp = clientIp;        &#125;    &#125;&#125;\n\n\n위 예시의 RequestHolder는 http 요청할때마다 새로운정보가 holder에 담겨야한다. 따라서 @Scope(value = “request”, proxyMode= ScopedProxyMode.TARGET_CLASS) 빈 스콥을 request로 요청해야한다. 보통 holder에 담기는 정보는 singleton 성격의 데이터들이 저장되는 경우가 많이 있다.\n헤더정보는 인터셉터 설정내에 HttpServletRequest 정보를 파라미터로 넘겨서 헤더값 정보를 추출하는 방식으로 사용한다. \n위와 같이 외부에서 해당 정보를 갖길 원할때 holder에 저장된 정보를 꺼내서 사용할때 가장 적합한 패턴으로 체감된다. \nHolder패턴은 FacotryMethod패턴과 아주 유사하다. 단 한가지 다른점은 팩토리메서드패턴은 외부의 요청에 매번생성해서 주지만, Holder패턴은 딱 한번만 생성한다.  \n\n참고\n","dateCreated":"2022-05-09T07:51:40+00:00","dateModified":"2022-06-08T01:47:23+00:00","datePublished":"2022-05-09T07:51:40+00:00","description":"","headline":"holder-pattern","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://codexdawn.github.io/2022/05/09/holder-pattern/"},"publisher":{"@type":"Organization","name":"codexdawn","sameAs":["https://github.com/codexdawn","https://www.facebook.com/beherzt.dev","https://www.linkedin.com/in/sim-jisung-3048872a/","mailto:cloudkaiser@gmail.com"],"image":"https://www.gravatar.com/avatar/d97fd4b94c429915f1cb55eb27e7d4d9","logo":{"@type":"ImageObject","url":"https://www.gravatar.com/avatar/d97fd4b94c429915f1cb55eb27e7d4d9"}},"url":"https://codexdawn.github.io/2022/05/09/holder-pattern/","keywords":"Java,JPA,Spring"}</script>
    <meta name="description" content="Holder 패턴 사용하기!Holder 패턴이란?문맥 자체만 봐도 어느정도 느낌이 오겠지만, Holder는 소유자라는 뜻으로 어떠한 정보를 소유하고 있는 객체를 의미한다.어떠한 정보를 component로 bean등록하여 호출해서 사용하면 끝이다. 여기서 포인트는 세팅하는 데이터가 영구적으로 오래사용되는 케이스가 많다는부분이다.주로 사용할수있는 부분이 hea">
<meta property="og:type" content="blog">
<meta property="og:title" content="holder-pattern">
<meta property="og:url" content="https://codexdawn.github.io/2022/05/09/holder-pattern/index.html">
<meta property="og:site_name" content="codexdawn">
<meta property="og:description" content="Holder 패턴 사용하기!Holder 패턴이란?문맥 자체만 봐도 어느정도 느낌이 오겠지만, Holder는 소유자라는 뜻으로 어떠한 정보를 소유하고 있는 객체를 의미한다.어떠한 정보를 component로 bean등록하여 호출해서 사용하면 끝이다. 여기서 포인트는 세팅하는 데이터가 영구적으로 오래사용되는 케이스가 많다는부분이다.주로 사용할수있는 부분이 hea">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-05-09T07:51:40.000Z">
<meta property="article:modified_time" content="2022-06-08T01:47:23.918Z">
<meta property="article:author" content="codexdawn">
<meta property="article:tag" content="Java,JPA,Spring">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-3sspfygaapf5d6tbrnqmyrhdcstv0iwwmi4wor2yeip9c44sowy9gbdzyyjm.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            codexdawn
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/codexdawn"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.facebook.com/beherzt.dev"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/sim-jisung-3048872a/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:cloudkaiser@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            holder-pattern
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2022-05-09T07:51:40+00:00">
	
		    May 09, 2022
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/%EC%9C%A0%EB%A0%88%EC%B9%B4or%EC%82%BD%EC%A7%88/">유레카or삽질</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h1 id="Holder-패턴-사용하기"><a href="#Holder-패턴-사용하기" class="headerlink" title="Holder 패턴 사용하기!"></a>Holder 패턴 사용하기!</h1><h2 id="Holder-패턴이란"><a href="#Holder-패턴이란" class="headerlink" title="Holder 패턴이란?"></a>Holder 패턴이란?</h2><p>문맥 자체만 봐도 어느정도 느낌이 오겠지만, Holder는 소유자라는 뜻으로 어떠한 정보를 소유하고 있는 객체를 의미한다.<br>어떠한 정보를 component로 bean등록하여 호출해서 사용하면 끝이다. 여기서 포인트는 세팅하는 데이터가 영구적으로 오래사용되는 케이스가 많다는부분이다.<br>주로 사용할수있는 부분이 header정보를 갖고있는 RequestHolder, 세션으로 부터 넘겨받은 사용자 정보를 갖고있는 userHolder, 스프링 서버 환경별 정보를 갖고있는 profileHolder등<br>정보를 묶어놓고 필요할때 가져다 쓰는 형태를 의미한다. </p>
<h2 id="적용방법"><a href="#적용방법" class="headerlink" title="적용방법"></a>적용방법</h2><figure class="highlight java"><figcaption><span>RequestHolder 사용사례</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VRequestInterceptor</span> <span class="keyword">extends</span> <span class="title">HandlerInterceptorAdapter</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; IGNORE_URLS = Lists.newArrayList(<span class="string">&quot;/hello&quot;</span>,<span class="string">&quot;/lbStatusCheck&quot;</span>,<span class="string">&quot;/servicemanager/prometheus&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> VRequestHolder vRequestHolder;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (IGNORE_URLS.contains(request.getRequestURI())) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        vRequestHolder.build(request);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Scope(value = &quot;request&quot;, proxyMode= ScopedProxyMode.TARGET_CLASS)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VRequestHolder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ProfileHolder profileHolder;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserAgentType userAgentType;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isLogin;</span><br><span class="line">    <span class="keyword">private</span> AppName appName;</span><br><span class="line">    <span class="keyword">private</span> String appVersion;</span><br><span class="line">    <span class="keyword">private</span> String loginUserInfo;</span><br><span class="line">    <span class="keyword">private</span> String cartInfo;</span><br><span class="line">    <span class="keyword">private</span> String clientIp;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HttpHeaders <span class="title">getHeaderInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        HttpHeaders headerInfo = <span class="keyword">new</span> HttpHeaders();</span><br><span class="line">        headerInfo.set(USER_AGENT_TYPE, userAgentType.name());</span><br><span class="line">        headerInfo.set(LOGIN_USER_INFO, loginUserInfo);</span><br><span class="line">        headerInfo.set(NON_USER_INFO, nonUserInfo);</span><br><span class="line">        headerInfo.set(WMP_APP_NAME,appName.getHeadValue());</span><br><span class="line">        headerInfo.set(MOBILE_APP_VERSION, appVersion);</span><br><span class="line">        headerInfo.set(CART_INFO, cartInfo);</span><br><span class="line">        headerInfo.set(CLIENT_IP, clientIp);</span><br><span class="line">        <span class="keyword">return</span> headerInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String mid = request.getHeader(MID);</span><br><span class="line">        <span class="keyword">if</span> (isNotEmpty(mid)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.mid = Long.valueOf(mid);</span><br><span class="line">            <span class="keyword">this</span>.isLogin = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        setLoginUserInfo(request);</span><br><span class="line">        setNonUserInfo(request);</span><br><span class="line">        setAppName(request);</span><br><span class="line">        setUserAgentType(request);</span><br><span class="line">        setAppVersion(request);</span><br><span class="line">        setCartInfo(request);</span><br><span class="line">        setClientIp(request);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setLoginUserInfo</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String loginUserInfo = request.getHeader(WmpHeaderKey.LOGIN_USER_INFO);</span><br><span class="line">        <span class="keyword">if</span> (isNotBlank(loginUserInfo)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.loginUserInfo = loginUserInfo;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setNonUserInfo</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String nonUserInfo = request.getHeader(WmpHeaderKey.NON_USER_INFO);</span><br><span class="line">        <span class="keyword">if</span> (isNotBlank(nonUserInfo)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.nonUserInfo = nonUserInfo;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAppVersion</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String appVersion = request.getHeader(WmpHeaderKey.MOBILE_APP_VERSION);</span><br><span class="line">        <span class="keyword">if</span> (isNotBlank(appVersion)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.appVersion = appVersion;</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">&quot;VRequestHolder.setAppVersion - &#123;&#125;&quot;</span>, request.getHeader(WmpHeaderKey.MOBILE_APP_VERSION));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setAppName</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String displayServiceTypeAsString = request.getParameter(DISPLAY_SERVICE_TYPE_PARAMETER);</span><br><span class="line">        <span class="keyword">if</span> (isNotEmpty(displayServiceTypeAsString)) &#123;</span><br><span class="line">            DisplayServiceType displayServiceType = DisplayServiceType.findDefaultVertical(displayServiceTypeAsString);</span><br><span class="line">            <span class="keyword">this</span>.appName = (DisplayServiceType.VERTICAL == displayServiceType) ? AppName.WStyle : AppName.WMP;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;VRequestHolder.setAppName - &#123;&#125;&quot;</span>, request.getHeader(WmpHeaderKey.WMP_APP_NAME));</span><br><span class="line">        <span class="keyword">this</span>.appName = AppName.find(request.getHeader(WmpHeaderKey.WMP_APP_NAME));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setUserAgentType</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;VRequestHolder.setUserAgentType - &#123;&#125;&quot;</span>, request.getHeader(USER_AGENT_TYPE));</span><br><span class="line">        String userAgentType = request.getHeader(USER_AGENT_TYPE);</span><br><span class="line">        <span class="keyword">this</span>.userAgentType = isEmpty(userAgentType) ? APP : UserAgentType.findByName(userAgentType);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setCartInfo</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String cartInfo = request.getHeader(CART_INFO);</span><br><span class="line">        <span class="keyword">if</span> (isNotBlank(cartInfo)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.cartInfo = cartInfo;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setClientIp</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String clientIp = request.getHeader(CLIENT_IP);</span><br><span class="line">        <span class="keyword">if</span> (isNotBlank(clientIp)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.clientIp = clientIp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>위 예시의 RequestHolder는 http 요청할때마다 새로운정보가 holder에 담겨야한다. 따라서 @Scope(value = “request”, proxyMode= ScopedProxyMode.TARGET_CLASS) 빈 스콥을 request로 요청해야한다. 보통 holder에 담기는 정보는 singleton 성격의 데이터들이 저장되는 경우가 많이 있다.</li>
<li>헤더정보는 인터셉터 설정내에 HttpServletRequest 정보를 파라미터로 넘겨서 헤더값 정보를 추출하는 방식으로 사용한다. </li>
<li>위와 같이 외부에서 해당 정보를 갖길 원할때 holder에 저장된 정보를 꺼내서 사용할때 가장 적합한 패턴으로 체감된다. </li>
<li>Holder패턴은 FacotryMethod패턴과 아주 유사하다. 단 한가지 다른점은 팩토리메서드패턴은 외부의 요청에 매번생성해서 주지만, Holder패턴은 딱 한번만 생성한다.  </li>
</ul>
<p><a target="_blank" rel="noopener" href="https://effectiveprogramming.tistory.com/entry/Holder-%ED%8C%A8%ED%84%B4">참고</a></p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Java-JPA-Spring/" rel="tag">Java,JPA,Spring</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a
                        class="post-action-btn btn btn--disabled"
                        aria-hidden="true"
                    >
                        
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/05/09/spring-batch-2/"
                    data-tooltip="spring-batch-2"
                    aria-label="NEXT: spring-batch-2"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://codexdawn.github.io/2022/05/09/holder-pattern/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://codexdawn.github.io/2022/05/09/holder-pattern/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://codexdawn.github.io/2022/05/09/holder-pattern/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2022 codexdawn. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a
                        class="post-action-btn btn btn--disabled"
                        aria-hidden="true"
                    >
                        
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/05/09/spring-batch-2/"
                    data-tooltip="spring-batch-2"
                    aria-label="NEXT: spring-batch-2"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://codexdawn.github.io/2022/05/09/holder-pattern/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://codexdawn.github.io/2022/05/09/holder-pattern/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://codexdawn.github.io/2022/05/09/holder-pattern/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://codexdawn.github.io/2022/05/09/holder-pattern/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://codexdawn.github.io/2022/05/09/holder-pattern/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://codexdawn.github.io/2022/05/09/holder-pattern/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">codexdawn</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ikbi0v8fyzuu91xv5rmpcrnwb4qinfgborzd5kejmj8wr6ibfra8oaxqshyg.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
