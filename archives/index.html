
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="codexdawn">
    <title>Archives - codexdawn</title>
    <meta name="author" content="codexdawn">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="codexdawn">
<meta property="og:url" content="https://codexdawn.github.io/archives/index.html">
<meta property="og:site_name" content="codexdawn">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="codexdawn">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-3sspfygaapf5d6tbrnqmyrhdcstv0iwwmi4wor2yeip9c44sowy9gbdzyyjm.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            codexdawn
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/codexdawn"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.facebook.com/beherzt.dev"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/sim-jisung-3048872a/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:cloudkaiser@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/06/10/jpa-collection-etc/"
                            aria-label=": jpa-collection-etc"
                        >
                            jpa-collection-etc
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-06-10T08:41:35+00:00">
	
		    Jun 10, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Study/">Study</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%B0%94ORM%ED%91%9C%EC%A4%80JPA%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/">자바ORM표준JPA프로그래밍</a>, <a class="category-link" href="/categories/%EC%BB%AC%EB%A0%89%EC%85%98%EA%B3%BC-%EB%B6%80%EA%B0%80%EA%B8%B0%EB%8A%A5/">컬렉션과 부가기능</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="컬렉션과-부가기능"><a href="#컬렉션과-부가기능" class="headerlink" title="컬렉션과 부가기능"></a>컬렉션과 부가기능</h1><h2 id="1-컬렉션"><a href="#1-컬렉션" class="headerlink" title="1. 컬렉션"></a>1. 컬렉션</h2><p>JPA에서 컬렉션을 사용할때 2가지</p>
<ol>
<li>@OneToMany, @ManyToMany 를 사용해서 일대다 나 다대다 엔티티 관계를 매핑할때 </li>
<li>@ElementCollection을 사용해서 값 타입을 하나 이상 보관 할때 </li>
</ol>
<p>자바 컬렉션 인터페이스 특징</p>
<ol>
<li>Collection : 자바가 제공하는 최상위 컬렉션. 하이버네이트는 중복을 허용하고 순서를 보장하지 않는다고 가정</li>
<li>Set: 중복을 허용하지 않고,순서 보장안됨.</li>
<li>List: 순서가 있는 컬렉션. 순서를 보장하지만 중복 허용됨.</li>
<li>Map: Key,Value구조로 되어있는 특수한 컬렉션이다. (Map은 잘 활용안됨.)</li>
</ol>
<h3 id="Collection-List"><a href="#Collection-List" class="headerlink" title="Collection,List"></a>Collection,List</h3><p>Collection,List는 엔티티를 추가할때 중복된 엔티티가 있는지 비교하지않고, 단순히 저장만하면 된다. 따라서 엔티티를 추가해도 지연 로딩된 컬렉션을 초기화 하지 않는다. </p>
<h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><p>Set은 엔티티를 추가할때 중복된 엔티티가 있는지 비교해야 한다. 따라서 엔티티를 추가할때 지연로딩된 컬렉션을 초기화한다.<br>(Set사용시, equals,hashcode 재정의 무조건 반드시 해야함!!! )</p>
<h3 id="OrderBy"><a href="#OrderBy" class="headerlink" title="@OrderBy"></a>@OrderBy</h3><p>@OrderBy는 모든 컬렉션에 사용가능 </p>
<figure class="highlight java"><figcaption><span>@OrderBy 예제</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Team</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GenerateValue</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToMany(mappedBy=&quot;team&quot;)</span></span><br><span class="line">	<span class="meta">@OrderBy(&quot;username desc, id asc&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Set&lt;Member&gt; members = <span class="keyword">new</span> HashSet&lt;&gt;(); </span><br><span class="line">	</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GenerateValue</span></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(name = &quot;member_name&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="keyword">private</span> Team team; </span><br><span class="line">	</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Team findTeam = em.find(Team.class, team.getId()); </span><br><span class="line">findTeam.getMembers().size(); <span class="comment">//초기화 </span></span><br><span class="line"><span class="comment">//위 코드의 나갈쿼리는  아래와 같다. (정렬붙은것 확인됨)</span></span><br><span class="line"><span class="comment">//SELECT M.* FROM MEMBER M WHERE M.TEAM = ? ORDER BY M.MEMBER_NAME DESC, M.ID ASC </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="2-Converter"><a href="#2-Converter" class="headerlink" title="2. @Converter"></a>2. @Converter</h2><figure class="highlight java"><figcaption><span>@Converter</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GenerateValue</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String username; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Convert(converter = BooleanToYnConverter.class)</span> </span><br><span class="line">	<span class="comment">//글로벌 설정으로 하면 위 애너테이션 지워됨. </span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> vip; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Converter</span></span><br><span class="line"><span class="comment">//@Converter(autoApply = true) 요렇게 하면 글로벌 설정으로 설정됨. </span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BooleanToYnConverter</span> <span class="keyword">implements</span> <span class="title">AttributeConverter</span>&lt;<span class="title">Boolean</span>, <span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span> </span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">convertToDatabaseColumn</span><span class="params">(Boolean attribute)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (attribute != <span class="keyword">null</span> &amp;&amp; attribute) ? <span class="string">&quot;Y&quot;</span> : <span class="string">&quot;N&quot;</span>; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">convertToEntityAttribute</span><span class="params">(Strig dbData)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Y&quot;</span>.equals(dbData); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3-엔티티-그래프"><a href="#3-엔티티-그래프" class="headerlink" title="3. 엔티티 그래프"></a>3. 엔티티 그래프</h2><p>엔티티를 조회할때 연관된 엔티티를 함께 조회 하려면 글로벌페치전략을 Eager로 설정하거나, Lazy로딩해서 fetch조인 사용하기도한다. 하지만 페치조인을 사용하면 JPQL을 중복해서 작성하는 경우가 많다. </p>
<ul>
<li>select o from Orders o where o.status = ?  </li>
<li>selet o from Order o join fetch o.member where o.status = ?</li>
<li>select o from Orders join fetch o.orderItems where o.status = ?<br>위와같이 상황에 따라 각기 다른 쿼리를 직접 개발해야함. </li>
</ul>
<p>엔티티그래프를 사용하면 엔티티를 조회하는 시점에 함께 조회할 연관된엔티티를 선택할수있다. 그래서 아래쿼리만 작성하면 연관된 엔티티도 같이 끌고옴.</p>
<ul>
<li>select o from Orders o where o.status = ?  </li>
</ul>
<p>엔티티그래프 기능은 엔티티 조회시점에 연관된 엔티티 들을 함께 조회하는 기능이다.  </p>
<figure class="highlight java"><figcaption><span>엔티티그래프 사용방법</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NamedEntityGraph(name = &quot;Order.withMember&quot;, attributeNodes = &#123;</span></span><br><span class="line"><span class="meta">	@NamedAttributeNode(&quot;member&quot;)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Orders</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GenerateValue</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne(fetch=LAZY, optional=false)</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;member_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Member member; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//em.find 사용 </span></span><br><span class="line">EntityGraph g = em.getEntityGraph(<span class="string">&quot;Order.withMember&quot;</span>);</span><br><span class="line"></span><br><span class="line">Map hints = <span class="keyword">new</span> HashMap();</span><br><span class="line">hints.put(<span class="string">&quot;javax.persistence.fetchgraph&quot;</span>, g);</span><br><span class="line"></span><br><span class="line">Order order = em.find(Order.class, orderId, hints); </span><br></pre></td></tr></table></figure>

<h3 id="subgraph"><a href="#subgraph" class="headerlink" title="subgraph"></a>subgraph</h3><figure class="highlight java"><figcaption><span>서브그래프 사용방법</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NamedEntityGraph(name = &quot;Order.withAll&quot;, attributeNodes = &#123;</span></span><br><span class="line"><span class="meta">	@NamedAttributeNode(&quot;member&quot;),</span></span><br><span class="line"><span class="meta">	@NamedAttributeNode(value=&quot;orderItems&quot;, subgraph = &quot;orderItems&quot;)</span></span><br><span class="line"><span class="meta">&#125;, </span></span><br><span class="line"><span class="meta">subgraphs = @NamedSubgraph(name= &quot;orderItems&quot;, attributeNodes = &#123;</span></span><br><span class="line"><span class="meta">	@NamedAttributeNode(&quot;item&quot;)</span></span><br><span class="line"><span class="meta">&#125;))</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Orders</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GenerateValue</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne(fetch=LAZY, optional=false)</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;member_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Member member; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToMany(mappedBy=&quot;order&quot;, cascade = CascadeType.ALL)</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;OrderItem&gt; orderItems = <span class="keyword">new</span> ArrayList&lt;&gt;(); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderItem</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GenerateValue</span></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne(fetch = LAZY)</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;item_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Item item; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//em.find 사용 </span></span><br><span class="line">EntityGraph g = em.getEntityGraph(<span class="string">&quot;Order.withAll&quot;</span>);</span><br><span class="line"></span><br><span class="line">Map hints = <span class="keyword">new</span> HashMap();</span><br><span class="line">hints.put(<span class="string">&quot;javax.persistence.fetchgraph&quot;</span>, g);</span><br><span class="line"></span><br><span class="line">Order order = em.find(Order.class, orderId, hints);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//jpql 사용 </span></span><br><span class="line">List&lt;Orders&gt; result = em.createQuery(<span class="string">&quot;select o from Orders o where o.id = :orderId&quot;</span>, Orders.class)</span><br><span class="line">						.setParameter(<span class="string">&quot;orderId&quot;</span>, orderId)</span><br><span class="line">						.setHint(<span class="string">&quot;javax.persistence.fetchgraph&quot;</span>, em.getEntityGraph(<span class="string">&quot;Order.withAll&quot;</span>))</span><br><span class="line">						.getResultList(); </span><br></pre></td></tr></table></figure>

<h4 id="엔티티그래프-사용시-참고"><a href="#엔티티그래프-사용시-참고" class="headerlink" title="엔티티그래프 사용시 참고!!"></a>엔티티그래프 사용시 참고!!</h4><p>em.find를 사용하면 연관관계 매핑시 optional=true로 걸면 inner Join으로 필수관계가 자동으로 매핑되지만, JPQL에서 엔티티그래프를 사용하면 항상 외부조인으로 잡힌다. 따라서 내부조인을 사용하고 싶으면 아래와 같이 내부조인을 명시시켜줘야함.<br>select o from Orders o join fetch o.member where o.id = :orderId</p>
<h3 id="엔티티그래프-정리"><a href="#엔티티그래프-정리" class="headerlink" title="엔티티그래프 정리"></a>엔티티그래프 정리</h3><ol>
<li>ROOT에서 시작 <ul>
<li>엔티티그래프는  항상 조회하는 엔티티의 ROOT에서 시작해야함. Order엔티티를 조회하는데 Member부터 시작하는 엔티티그래프를 사용하면 안됨.</li>
</ul>
</li>
<li>이미 로딩된 엔티티<ul>
<li>다음처럼 영속성 컨텍스트에 이미 로딩되어있으면 엔티티그래프 적용안됨.<br>Orders order1 = em.find(Orders.class, orderId); //이미 조회<br>hints.put(“javax.persistence.fetchgraph”, em.getEntityGraph(“Order.withMember”));<br>Orders order2 = em.find(Orders.class, orderId, hints); //이미 로딩되었기 때문에 엔티티그래프 적용X </li>
</ul>
</li>
<li>fetchgraph vs loadgraph <ul>
<li>fetchgraph는 선택한 엔티티속성만 가져옴 </li>
<li>loadgraph는 글로벌 페치전략이 EAGER전략으로 설정된 연관관계도 포함해서 함께 조회한다고함. </li>
</ul>
</li>
</ol>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/06/10/jpa-collection-etc/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/06/05/jpa-webapp-persistence/"
                            aria-label=": jpa-webapp-persistence"
                        >
                            jpa-webapp-persistence
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-06-05T11:27:18+00:00">
	
		    Jun 05, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Study/">Study</a>, <a class="category-link" href="/categories/%EC%9B%B9-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EA%B3%BC-%EC%98%81%EC%86%8D%EC%84%B1-%EA%B4%80%EB%A6%AC/">웹 애플리케이션과 영속성 관리</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%B0%94ORM%ED%91%9C%EC%A4%80JPA%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/">자바ORM표준JPA프로그래밍</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="웹-애플리케이션과-영속성-관리"><a href="#웹-애플리케이션과-영속성-관리" class="headerlink" title="웹 애플리케이션과 영속성 관리"></a>웹 애플리케이션과 영속성 관리</h1><h2 id="1-트랜잭션-범위의-영속성-컨텍스트"><a href="#1-트랜잭션-범위의-영속성-컨텍스트" class="headerlink" title="1. 트랜잭션 범위의 영속성 컨텍스트"></a>1. 트랜잭션 범위의 영속성 컨텍스트</h2><h3 id="1-1-스프링-컨테이너의-기본-전략"><a href="#1-1-스프링-컨테이너의-기본-전략" class="headerlink" title="1-1. 스프링 컨테이너의 기본 전략"></a>1-1. 스프링 컨테이너의 기본 전략</h3><p>스프링 컨테이너는 <strong>트랜잭션 범위의 영속성 컨텍스트</strong> 전략을 기본으로 사용한다. 보통 스프링에서 비즈니스 로직을 시작하는 서비스 계층에 @Transactional 어노테이션을 선언해서 트랜잭션을 시작한다. 이 어노테이션이 선언되면 Spring의 트랜잭션 AOP가 먼저 동작한다.</p>
<blockquote><p>스프링 트랜잭션 생명주기 (@Transactional선언된 메서드 일 경우)</p>
<ol>
<li>스프링 트랜잭션 AOP는 대상 메소드를 호출하기 직전에 트랜잭션을 시작</li>
<li>대상 메소드가 종료되면 트랜잭션을 커밋하면서 종료한다.<ul>
<li>이때 트랜잭션을 커밋하면서 JPA는 먼저 영속성 컨텍스트를 플러시 해서 변경내용을 DB에 반영하고 DB 트랜잭션을 컷밋한다. </li>
<li>따라서, 영속성 컨텍스트의 변경내용이 DB에 정상반영된다. 만약 예외 발생하면 트랜잭션 롤백하고 종료되고, 플러시 호출은 안됨. </li>
</ul>
</li>
</ol>
</blockquote>

<figure class="highlight java"><figcaption><span>transactional lifecycle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloService</span>() </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@PersistenceContext</span> <span class="comment">//엔티티매니저 주입 </span></span><br><span class="line">	EntiryManager em; <span class="comment">//?왜했지? </span></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span> Repository1 repo1; </span><br><span class="line">	<span class="meta">@Autowired</span> Repository2 repo2; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//트랜잭션 시작 </span></span><br><span class="line">	<span class="meta">@Transactional</span> </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">logic</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		repo1.hello(); </span><br><span class="line"></span><br><span class="line">		<span class="comment">//member는 영속상태다. </span></span><br><span class="line">		Member member = repo2.findMember();</span><br><span class="line">		<span class="keyword">return</span> member; </span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//트랜잭션 종료</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Repository1</span> </span>&#123;</span><br><span class="line">	<span class="meta">@PersistenceContext</span></span><br><span class="line">	EntityManager em; </span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		em.xxx(); <span class="comment">//A. 영속성 컨텍스트 접근 </span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Repository2</span> </span>&#123;</span><br><span class="line">	<span class="meta">@PersistenceContext</span></span><br><span class="line">	EntityManager em; </span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Member <span class="title">findMember</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> em.find(Member.class, <span class="string">&quot;m1&quot;</span>); <span class="comment">//B. 영속성 컨텍스트 접근 </span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>위 코드의 트랜잭션 생명주기는 어떻까?</p>
<ol>
<li>HelloService.logic 메서드에 @Transactional이 선언되었으므로, 스프링 트랜잭션 AOP에 의해 트랜잭션 시작 </li>
<li>repo2.findMember를 통해 조회한 Member엔티티는 트랜잭션 범위에 있으므로 영속성 컨텍스트 관리를 받는다. 따라서 영속상태임.</li>
<li>@Transactional 선언한 메서드가 정상 종료되면 트랜잭션을 커밋하는데, 이때 영속성 컨텍스트를 종료한다. 영속성 컨텍스트가 사라졋으므로 조회한 엔티티(member)는 이제부터 준영속 상태가 된다.</li>
<li>서비스 메서드가 끝나면서 트랜잭션과 영속성 컨텍스트가 종료되었다. 따라서 컨트롤러에 반환된 member엔티티는 준영속상태로 관리된다. </li>
</ol>
<h3 id="트랜잭션이-같으면-같은-영속성-컨텍스트를-사용한다"><a href="#트랜잭션이-같으면-같은-영속성-컨텍스트를-사용한다" class="headerlink" title="트랜잭션이 같으면 같은 영속성 컨텍스트를 사용한다."></a>트랜잭션이 같으면 같은 영속성 컨텍스트를 사용한다.</h3><p>위 코드의 2개의 repository 로 접근한 A,B는 같은 트랜잭션에서 수행됨에따라, A,B는 비록 다른 엔티티매니저 이지만, 같은 영속성 컨텍스트를 사용하게 된다.</p>
<h3 id="트랜잭션이-다르면-다른-영속성-컨텍스트를-사용한다"><a href="#트랜잭션이-다르면-다른-영속성-컨텍스트를-사용한다" class="headerlink" title="트랜잭션이 다르면 다른 영속성 컨텍스트를 사용한다."></a>트랜잭션이 다르면 다른 영속성 컨텍스트를 사용한다.</h3><p>위 코드에서 여러 스레드에서 동시에 요청이와서 같은 엔티티 매니저를 사용해도 트랜잭션에 따라 접근하는 영속성 컨텍스트가 다르다. 좀 더 들어가면 스프링 컨테이너는 스레드마다 각각 다른 트랜잭션을 할당한다. 따라서 같은 엔티티 매니저를 호출해도 접근하는 영속성 컨텍스트가 다르므로 멀티스레드 환경에서 안전하다. </p>
<h2 id="2-준영속-상태와-지연로딩"><a href="#2-준영속-상태와-지연로딩" class="headerlink" title="2. 준영속 상태와 지연로딩"></a>2. 준영속 상태와 지연로딩</h2><h3 id="준영속-상태와-지연로딩"><a href="#준영속-상태와-지연로딩" class="headerlink" title="준영속 상태와 지연로딩"></a>준영속 상태와 지연로딩</h3><p>준영속 상태의 가장 골치아픈 문제는 지연로딩 기능이 동작하지 않는다. 예를들어 뷰를 렌더링할때 연관된 엔티티도 함께 사용해야 하는데 연관된 엔티티를 지연 로딩으로 설정해서 프록시 객체로 조회했다고 가장하자. 아직 초기화 하지 않은 프록시객체를 사용하려고 초기화를 시도함. 하지만 준영속 상태에서는 영속성 컨텍스트가 없으므로 지연로딩을 할수 없다. 이때 지연로딩을 시도하면 문제가 발생함. (LazyInitializationException 예외 발생)</p>
<h4 id="준영속-상태의-지연로딩-문제를-해결하는-방법-2가지"><a href="#준영속-상태의-지연로딩-문제를-해결하는-방법-2가지" class="headerlink" title="준영속 상태의 지연로딩 문제를 해결하는 방법 2가지"></a>준영속 상태의 지연로딩 문제를 해결하는 방법 2가지</h4><ol>
<li>뷰가 필요한 엔티티를 미리 로딩해두는 방법 <ul>
<li>글로벌 패치 전략 수정 </li>
<li>JPQL fetch join </li>
<li>강제로 초기화 </li>
</ul>
</li>
<li>OSIV를 사용해서 엔티티를 항상 영속상태로 유지하는 방법 </li>
</ol>
<h4 id="1-글로벌-페치-전략-수정"><a href="#1-글로벌-페치-전략-수정" class="headerlink" title="1. 글로벌 페치 전략 수정"></a>1. 글로벌 페치 전략 수정</h4><p>글로벌 페치 전략을 Lazy로딩 상태에서 Eager로 수정하면 쿼리를 조인해서 한꺼번에 가져오게된다.<br>하지만 즉시로딩을 전략을 사용하게되면 치명적인 단점 2가지가 존재한다.</p>
<blockquote><p>글로벌 페치 전략에 즉시로딩을 사용시 단점 </p>
<ol>
<li>사용하지 않는 엔티티를 로딩한다. <ul>
<li>말그대로 의도와 다르게 하나의 엔티티만 사용하고싶은데, 즉시로딩 전략상 조인된 테이블을 한꺼번에 가져와야하기때문에 </li>
</ul>
</li>
<li>N+1 문제 유발 <ul>
<li>JPA가 JPQL을 분석해서 SQL을 생성할때는 글로벌 페치 전략을 참고하지 않고 오직 JPQL 자체만 사용한다. </li>
<li>select o from Order o -&gt; JPQL을 수행하면 실제로 select * from Order만 나가는게 아니라 Member테이블의 정보도 같이 조회 해야한다. 즉시로딩으로 정보를 가져와야하기때문에</li>
</ul>
</li>
</ol>
</blockquote>

<h4 id="2-JPQL-fetch-join-사용"><a href="#2-JPQL-fetch-join-사용" class="headerlink" title="2. JPQL fetch join 사용"></a>2. JPQL fetch join 사용</h4><p>fetch join하게되면 한방쿼리로 만들어줘서, 미리 로딩시키는 효과를 볼수있음. (N+1문제도 자연스럽게 해결됨.)</p>
<h4 id="3-강제로-초기화"><a href="#3-강제로-초기화" class="headerlink" title="3. 강제로 초기화"></a>3. 강제로 초기화</h4><p>서비스 로직에서 orderRepository.findOrder(id) 호출후 order.getMember().getName()까지 호출해서 프록시 객체를 강제로 초기화 시켜둔다.<br>이런 강제로 초기화 작업을 해주기 위해서는 프록시 초기화를 담당하는 계층이 필요하다. 그 계층이 FACADE계층이다. </p>
<blockquote><p>FACADE 계층의 역할과 특징 </p>
<ul>
<li>프리젠테이션 계층과 도메인 모델 계층간의 논리적 의존성 분리를 해줌.</li>
<li>프리젠테이션 꼐층에서 필요한 프록시 객체를 초기화 한다.</li>
<li>서비스 계층을 호출해서 비즈니스 로직을 실행한다.</li>
<li>리포지토리를 직접 호출해서 뷰가 요구하는 엔티티를 찾는다. </li>
</ul>
<p>FACADE 계층 사용시 주의점 </p>
<ul>
<li>프록시를 초기화하라면 영속성컨텍스트가 필요하므로 FACADE에서 @Transactional이 선언되어야함. (서비스도 호출하고 리포지토리도 호출하기 때문)</li>
</ul>
</blockquote>

<p>하지만 위 3가지 방법으로 지연로딩에서 VIEW에서 호출하기 전에 데이터를 미리 담아두는 방법을 사용해도, 결국 준영속 상태에서 초기화 이슈에 대한 예외발생은 발생할수밖에없음. 이런 부분을 해결하기 위해서는 OSIV를 적용해야함.  </p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/06/05/jpa-webapp-persistence/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/06/02/jpa-query-custom-repository/"
                            aria-label=": jpa-query-custom-repository"
                        >
                            jpa-query-custom-repository
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-06-02T11:44:52+00:00">
	
		    Jun 02, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/QueryDSL/">QueryDSL</a>, <a class="category-link" href="/categories/Spring-Boot/">Spring Boot</a>, <a class="category-link" href="/categories/Spring-Data-JPA/">Spring Data JPA</a>, <a class="category-link" href="/categories/%EC%9C%A0%EB%A0%88%EC%B9%B4or%EC%82%BD%EC%A7%88/">유레카or삽질</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="QueryDSL-삽질기-Custom-CustomImpl-Repository-설정-삽질"><a href="#QueryDSL-삽질기-Custom-CustomImpl-Repository-설정-삽질" class="headerlink" title="QueryDSL 삽질기! (Custom / CustomImpl Repository 설정 삽질)"></a>QueryDSL 삽질기! (Custom / CustomImpl Repository 설정 삽질)</h1><h2 id="사건의-발단"><a href="#사건의-발단" class="headerlink" title="사건의 발단"></a>사건의 발단</h2><p>오늘 근무하다가 동료가 QueryDSL관련 오류가 있다고해서 같이 확인하게되었는데, 결국 동료가 발견하게되었다.<br>사건의 발단은 QueryDSL과 Spring Data JPA를 같이 사용하기 위해서는 사용하는 interface/구체클래스에 Custom/CustomImpl 네이밍을 맞추는것을 국룰로 정해놨다. 근데 동료분께서 Impl쪽 구체클래스에 xxxxCustomsImpl로 s를 붙여넣고 말았다. 근데 문제는 쿼리가 의도한 쿼리가 안나가고 Spring Data JPA쿼리로 나가버리는것이었다. </p>
<h2 id="원인"><a href="#원인" class="headerlink" title="원인"></a>원인</h2><ul>
<li>Custom/CustomImpl은 Spring DATA JPA 네이밍 쿼리가 먹도록 설계되어있다. 그래서 국룰로 정하라는것이었다. </li>
<li>네이밍이 안맞아서 interface의 정의한 쿼리 네이밍을 가져와서 쿼리로 작성한것으로 판단되었다. 근데 네이밍을 좀 이상하게 지어도 나가는것보면, 그냥 기본쿼리로 나가는것으로 확인되어진다. </li>
</ul>
<p><a target="_blank" rel="noopener" href="https://jojoldu.tistory.com/372">jojoldu JPA 정리</a><br><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-data/jpa/docs/2.1.3.RELEASE/reference/html/#repositories.custom-implementations">Spring Data JPA 공식문서</a></p>
<h2 id="해결방법"><a href="#해결방법" class="headerlink" title="해결방법"></a>해결방법</h2><ul>
<li>절대로 QueryDSL 에서 Custom/CustomImpl의 클래스 네이밍은 오타 내지말자! (삽질의 시작이 될수 있음.)</li>
</ul>
<h2 id="정리"><a href="#정리" class="headerlink" title="정리"></a>정리</h2><ul>
<li>Custom/CustomImpl 도 Spring Data JPA 네임드쿼리가 적용됨.(repository interface만 되는줄 알았음.)</li>
<li>Custom/CustomImpl 의 클래스 네이밍은 절대로 오타내지말자! </li>
<li>CustomImpl의 오타가 났음에도 불구하고 기본 조회 쿼리가 나간것 확인해보면 interface정의한 부분에서 메서드 네임을 인식한것으로 확인되어짐. (조금 이상하게 날려도 나가긴 나갔음. 하지만 아예 이상하게 날리면 Spring DATA Jpa에서 네임드 쿼리 인식이 안된다고 오류 밷어냄.)</li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/06/02/jpa-query-custom-repository/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/20/java8-chaptor3/"
                            aria-label=": java8-chaptor3"
                        >
                            java8-chaptor3
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-20T14:08:15+00:00">
	
		    May 20, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Java8InAction/">Java8InAction</a>, <a class="category-link" href="/categories/Study/">Study</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="Chaptor3-람다-표현식"><a href="#Chaptor3-람다-표현식" class="headerlink" title="Chaptor3. 람다 표현식"></a>Chaptor3. 람다 표현식</h1><h2 id="3-1-람다란"><a href="#3-1-람다란" class="headerlink" title="3-1. 람다란?"></a>3-1. 람다란?</h2><p>람다는 메서드로 전달할수 있는 익명함수를 단순화 한것 </p>
<h3 id="람다의-특징"><a href="#람다의-특징" class="headerlink" title="람다의 특징"></a>람다의 특징</h3><ul>
<li>익명 : 보통의 메서드와 달리 익명이라표현 </li>
<li>함수 : 람다는 메서드처럼 특정 클래스에 종속되지 않으므로 <strong>함수</strong> 라고 부름. 단, 메서드와 동일하게 파라미터, 바디, 반환형식 간으한 예외 리스트를 포함함.</li>
<li>전달 : 람다 표현식을 메서드 인수로 전달하거나 변수로 저장할수 있음. </li>
<li>간결성 : 익명 클래스처럼 많은 자질 구레한 코드를 구현할 필요가 없음. </li>
</ul>
<h2 id="3-2-함수형-인터페이스"><a href="#3-2-함수형-인터페이스" class="headerlink" title="3-2. 함수형 인터페이스"></a>3-2. 함수형 인터페이스</h2><p>함수형 인터페이스는 정확히 하나의 추상 메서드를 지정하는 인터페이스다! </p>
<figure class="highlight java"><figcaption><span>함수형인터페이스들</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Predicate</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">test</span><span class="params">(T t)</span></span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Comparator</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">compare</span><span class="params">(T o1, T o2)</span></span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ActionListener</span> <span class="keyword">extends</span> <span class="title">EventListener</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Callable</span>&lt;<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function">V <span class="title">call</span><span class="params">()</span></span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PrivilegedAction</span>&lt;<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function">T <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-3-람다-활용"><a href="#3-3-람다-활용" class="headerlink" title="3-3. 람다 활용"></a>3-3. 람다 활용</h2><figure class="highlight java"><figcaption><span>processFile메서드를 람다로 변환 과정</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">processFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;	</span><br><span class="line">	<span class="keyword">try</span>(BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">&quot;data.txt&quot;</span>))) &#123;</span><br><span class="line">		<span class="keyword">return</span> br.readLine();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1단계-동작-파라미터화를-기억하라"><a href="#1단계-동작-파라미터화를-기억하라" class="headerlink" title="1단계: 동작 파라미터화를 기억하라!"></a>1단계: 동작 파라미터화를 기억하라!</h3><p>위 코드는 파일에서 한번에 한줄만 읽을수 있음. 한번에 두줄을 읽거나 가장 자주 사용되는 단어를 반환하려면 어떻게 해야할까?<br>결론은 동작파라미터화를 사용하는것이다. 아래 코드처럼 작성이 되어야할것이다. </p>
<figure class="highlight java"><figcaption><span>processFile메서드를 람다로 변환 과정-동작파라미터화1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String result = processFile((BufferedReader br) -&gt; br.readLine() + br.readLine()); </span><br></pre></td></tr></table></figure>

<h3 id="2단계-함수형-인터페이스를-이용해서-동작-전달"><a href="#2단계-함수형-인터페이스를-이용해서-동작-전달" class="headerlink" title="2단계: 함수형 인터페이스를 이용해서 동작 전달!"></a>2단계: 함수형 인터페이스를 이용해서 동작 전달!</h3><figure class="highlight java"><figcaption><span>processFile메서드를 람다로 변환 과정-동작파라미터화2</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BufferedReaderProcessor</span> </span>&#123;</span><br><span class="line">	<span class="function">String <span class="title">process</span><span class="params">(BufferedReader b)</span> <span class="keyword">throws</span> IOException</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">processFile</span><span class="params">(BufferedReaderProcessor p)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">... </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3단계-동작실행"><a href="#3단계-동작실행" class="headerlink" title="3단계: 동작실행!"></a>3단계: 동작실행!</h3><figure class="highlight java"><figcaption><span>processFile메서드를 람다로 변환 과정-동작파라미터화3</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">processFile</span><span class="params">(BufferedReaderProcessor p)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	<span class="keyword">try</span>(BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">&quot;data.txt&quot;</span>))) &#123;</span><br><span class="line">		<span class="keyword">return</span> p.process(br);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4단계-람다-전달"><a href="#4단계-람다-전달" class="headerlink" title="4단계: 람다 전달!"></a>4단계: 람다 전달!</h3><figure class="highlight java"><figcaption><span>processFile메서드를 람다로 변환 과정-동작파라미터화4</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String oneLine = processFile((BufferedReader br) -&gt; br.readLine());</span><br><span class="line">String twoLine = processFile((BufferedReader br) -&gt; br.readLine() + br.readLine());</span><br></pre></td></tr></table></figure>

<h2 id="3-4-함수형-인터페이스-사용"><a href="#3-4-함수형-인터페이스-사용" class="headerlink" title="3-4. 함수형 인터페이스 사용"></a>3-4. 함수형 인터페이스 사용</h2><h3 id="Predicate"><a href="#Predicate" class="headerlink" title="Predicate"></a>Predicate</h3><figure class="highlight java"><figcaption><span>Predicate사용</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Predicate</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">test</span><span class="params">(T t)</span></span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">filter</span><span class="params">(List&lt;T&gt; list, Predicate&lt;T&gt; p)</span> </span>&#123;</span><br><span class="line">	List&lt;T&gt; results = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">	<span class="keyword">for</span>(T s: list) &#123;</span><br><span class="line">		<span class="keyword">if</span>(p.test(s)) &#123;</span><br><span class="line">			results.add(s);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> results; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Predicate&lt;String&gt; nonEmptyStringPredicate = (String s) -&gt; !s.isEmpty();</span><br><span class="line">List&lt;String&gt; nonEmpty = filter(listOfStrings, noneEmptyStringPredicate); </span><br></pre></td></tr></table></figure>

<h3 id="Consumer"><a href="#Consumer" class="headerlink" title="Consumer"></a>Consumer</h3><figure class="highlight java"><figcaption><span>Consumer사용</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Consumer</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(T t)</span></span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">forEach</span><span class="params">(List&lt;T&gt; list, Consumer&lt;T&gt; c)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(T i: list) &#123;</span><br><span class="line">		c.accept(i); 		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foreach(Arrays.asList(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>), (Integer i) -&gt; System.out.println(i));</span><br></pre></td></tr></table></figure>

<h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><figure class="highlight java"><figcaption><span>Function사용</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Function</span>&lt;<span class="title">T</span>,<span class="title">R</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function">R <span class="title">apply</span><span class="params">(T t)</span></span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T,R&gt; <span class="function">List&lt;R&gt; <span class="title">map</span><span class="params">(List&lt;T&gt; list, Function&lt;T,R&gt; f)</span> </span>&#123;</span><br><span class="line">	List&lt;R&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;(); </span><br><span class="line">	<span class="keyword">for</span>(T s: list) &#123;</span><br><span class="line">		 result.add(f.apply(s));		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">List&lt;Integer&gt; stringLength = map(Arrays.asList(<span class="string">&quot;lambdas&quot;</span>,<span class="string">&quot;in&quot;</span>,<span class="string">&quot;action&quot;</span>),((String s) -&gt; s.length()));</span><br></pre></td></tr></table></figure>

<h4 id="기본형-특화"><a href="#기본형-특화" class="headerlink" title="기본형 특화"></a>기본형 특화</h4><p>자바의 모든형식은 참조형과 기본형으로 나눌수있음. </p>
<blockquote>
<p>참조형 : Byte, Integer, Object..<br>기본형 : int,double,long,char..<br>기본형을 참조형으로 변환하는 부분을 박싱(boxing)이라고 하고, 참조형을 기본형으로 변호나하는 동작을 언박싱(unboxing)이라고함. 자바에서는 이런 박싱/언박싱을 자동으로 해주는데, 이를 오토박싱이라함.<br>하지만 이런 변환과정은 비용이 소모됨. 박싱한 값은 기본형으로 감싸는 래퍼며 힙에 저장됨. 따라서 박싱한 값은 메모리를 더 소비하며 기본형을 가져올때도 메모리를 탐색하는 과정이 필요함. </p>
</blockquote>
<p>자바8에서는 이런 박싱/언박싱 되는 부분을 위해서 함수형인터페이스로 아예 제공하고있음.<br>예를들면 int파라미터를 받는 부분을 boolean으로 변환시켜주는 Predicate는 IntPredicate이런식으로 아예 기본클래스로 제공하고있음.<br>더 자세한 부분은 아래 참고 </p>
<p><img src="/images/java8/java-2.png" alt="오토박싱지원되는 함수형인터페이스"></p>
<p><img src="/images/java8/java-3.png" alt="람다와 함수형인터페이스 관계 예제"></p>
<blockquote><p>예외,람다,함수형 인터페이스 관계<br>함수형 인터페이스는 확인된 예외를 던지는 동작을 허용하지 않는다. 즉, 예외를 던지는 람다 표현식을 만드려면 확인된 예외를 선언하는 함수형 인터페이스를 직접 정의하거나 람다를 try/catch블록으로 감싸야함</p>
<p>@FunctionalInterface<br>public interface BufferedReaderProcessor {<br>    String process(BufferedReader b) throws IOException;<br>}<br>BufferedReaderProcessor p = (BufferedReader br) -&gt; br.readLine();</p>
<p>위와같이 지난 예제에서 동작파라미터화를 통해 BufferedReaderProcessor를 만들어서 예외처리까지 가능하도록 만들었었다. 하지만 이부분은 함수형 인터페이스의 Function&lt;T,R&gt;의 형태를 사용하고 있기 때문에 아래와같이 더 간단한 람다표현식으로 변경시켜서 명시적으로 확인된 예외를 체크할수있다. </p>
<p>Function&lt;BufferedReader, String&gt; f =<br>  (BufferedReader b) -&gt; {<br>    try {<br>      return b.readLine();<br>    }<br>    catch(IOException e) {<br>      throw new RuntimeException(e);<br>    }<br>  };</p>
</blockquote>

<h2 id="3-5-형식-검사-형식-추론-제약"><a href="#3-5-형식-검사-형식-추론-제약" class="headerlink" title="3-5. 형식 검사, 형식 추론, 제약"></a>3-5. 형식 검사, 형식 추론, 제약</h2><h3 id="지역-변수-사용"><a href="#지역-변수-사용" class="headerlink" title="지역 변수 사용"></a>지역 변수 사용</h3><p>람다 표현식에는 익명함수가 하는 것처럼 자유 변수(파라미터로 넘겨진 변수가 아닌 외부에서 정의된 변수)를 활용 할수 있다. 이와 같은 동작을 람다 캡처링이라고 부른다. 람다는 인스턴스 변수와 정적 변수를 캡처(자신의 바디에서 참조할수 있도록) 할수 있다. 하지만 지역 변수는 명시적으로 final로 선언되어 있어야 하거나 실질적으로 final 로 선언된 변수와 똑같이 사용되어야 한다. </p>
<h4 id="지역변수의-제약"><a href="#지역변수의-제약" class="headerlink" title="지역변수의 제약"></a>지역변수의 제약</h4><p>지역 변수에 왜 이런 제약이 필요할까?</p>
<ul>
<li>인스턴스 변수 와 지역변수는 태생적으로 다름. 인스턴수 변수는 힙에 저장되지만, 지역변수는 스택에 쌓임 </li>
<li>만약 람다에서 지역 변수에 바로 접근 할수 있다는 가정하에 람다가 스레드에서 실행된다면, 변수를 할당한 스레드가 사라져서 변수 할당이 해제되었는데도 람다를 실행하는 스레드에서는 해당변수에 접근하려 할 수 있다. </li>
<li>위 와 같은 이유로 자바는 원래 변수에 접근을 허용하는것이 아니라, 자유 지역 변수의 복사본을 제공한다. 따라서 복사본의 값이 바뀌지 않아야 하므로 지역변수에는 한 번만 값을 할당해야 한다는 제약이 생긴것이다. </li>
</ul>
<blockquote><p>클로저????<br>원칙적으로 클로저란 함수의 비지역 변수를 자유롭게 참조할수있는 함수의 인스턴스를 가르킨다. 클로저는 클로저 외부에 정의된 변수의값에 접근하고, 갑을 바꿀수 있다. 다만 람다와 익명 클래스는 람다가 정의된 메서드의 지역변수의 값은 바꿀수없다. 람다가 정의된 메서드의 지역변수값은 final 변수여야한다. 위에 설명하였지만 지역 변수값은 스택에 쌓이기때문에 자신을 정의한 스레드와 생존을 같이 해야 하며, 따라서 지역변수는 final이어야한다. 가변 지역 변수를 새로운 스레드에서 캡처할수있다면 안전하지 않은 동작을 수행할 가능성이 생긴다.(인스턴스 변수는 스레드가 공유하는 힙에 존재하므로 특별한 제약이 없다.)</p>
</blockquote>

<h2 id="3-6-메서드-레퍼런스"><a href="#3-6-메서드-레퍼런스" class="headerlink" title="3-6. 메서드 레퍼런스"></a>3-6. 메서드 레퍼런스</h2><h3 id="메서드-레퍼런스를-만드는-방법"><a href="#메서드-레퍼런스를-만드는-방법" class="headerlink" title="메서드 레퍼런스를 만드는 방법"></a>메서드 레퍼런스를 만드는 방법</h3><ol>
<li>정적 메서드 레퍼런스 <ul>
<li>Integer::parInt </li>
</ul>
</li>
<li>다양한 형식의 인스턴스 메서드 레퍼런스<ul>
<li>String::length</li>
</ul>
</li>
<li>기존 객체의 인스턴스 메서드 레퍼런스 <ul>
<li>Transaction a1 = new Transaction(); void getValue() {}; a1::getValue </li>
</ul>
</li>
</ol>
<h4 id="생성자-레퍼런스"><a href="#생성자-레퍼런스" class="headerlink" title="생성자 레퍼런스"></a>생성자 레퍼런스</h4><figure class="highlight java"><figcaption><span>생성자레퍼런스 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;Apple&gt; c1 = Apple::<span class="keyword">new</span>; <span class="comment">//디폴트 생성자</span></span><br><span class="line">Apple a1 = c1.get();</span><br><span class="line"></span><br><span class="line"><span class="comment">//위 예제는 아래와 같음 </span></span><br><span class="line">Supplier&lt;Apple&gt; c1 = () -&gt; <span class="keyword">new</span> Apple();</span><br><span class="line">Apple a1 = c1.get(); </span><br><span class="line"></span><br><span class="line">Function&lt;Integer, Apple&gt; c2 = Apple::<span class="keyword">new</span>; <span class="comment">//Apple(Integer weight) 생성자 함수 </span></span><br><span class="line">Apple a2 = c2.get(<span class="number">110</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//위 예제는 아래와 같음 </span></span><br><span class="line">Function&lt;Integer, Apple&gt; c2 = (Integer weight) -&gt; <span class="keyword">new</span> Apple(weight);</span><br><span class="line">Apple a2 = c2.get(<span class="number">110</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">//map과 같은 메서드를 이용해서 Apple생성자로 전달 가능 </span></span><br><span class="line">List&lt;Integer&gt; weights = Arrays.asList(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);</span><br><span class="line">List&lt;Apple&gt; apples = map(weights, Apple::<span class="keyword">new</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Apple&gt; <span class="title">map</span><span class="params">(List&lt;Integer&gt; list, Function&lt;Integer, Apple&gt; f)</span> </span>&#123;</span><br><span class="line">	List&lt;Apple&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">	<span class="keyword">for</span>(Integer e : list) &#123;</span><br><span class="line">		result.add(f.apply(e));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-7-람다-표현식을-조합할수-있는-유용한-메서드"><a href="#3-7-람다-표현식을-조합할수-있는-유용한-메서드" class="headerlink" title="3-7. 람다 표현식을 조합할수 있는 유용한 메서드"></a>3-7. 람다 표현식을 조합할수 있는 유용한 메서드</h2><h3 id="Comparator-조합"><a href="#Comparator-조합" class="headerlink" title="Comparator 조합"></a>Comparator 조합</h3><figure class="highlight java"><figcaption><span>Comparator 조합</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Apple&gt; c = Comparator.comparing(Apple::getWeight);</span><br><span class="line"><span class="comment">//역정렬 가능 </span></span><br><span class="line">inventory.sort(comparing(Apple::getWeight).reversed());</span><br><span class="line"></span><br><span class="line">inventory.sort(comparing(Apple::getWeight)</span><br><span class="line">						.reversed() <span class="comment">//무게를 내림차순으로 정렬</span></span><br><span class="line">						.thenComparing(Apple::getCountry)); <span class="comment">// 두 사과의 무게가 같음 국가별로 정렬 (2차 정렬)</span></span><br></pre></td></tr></table></figure>

<h3 id="Predicate-조합"><a href="#Predicate-조합" class="headerlink" title="Predicate 조합"></a>Predicate 조합</h3><figure class="highlight java"><figcaption><span>Predicate 조합</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Predicate&lt;Apple&gt; redAndHeavyAppleOrGreen = redApple.and(a -&gt; a.getWeight() &gt; <span class="number">150</span>)</span><br><span class="line">												   .or(a -&gt; <span class="string">&quot;green&quot;</span>.equals(a.getColor()));</span><br></pre></td></tr></table></figure>

<h3 id="Function-조합"><a href="#Function-조합" class="headerlink" title="Function 조합"></a>Function 조합</h3><figure class="highlight java"><figcaption><span>Predicate 조합</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//andThen</span></span><br><span class="line">Function&lt;Integer,Integer&gt; f = x -&gt; x + <span class="number">1</span>; </span><br><span class="line">Function&lt;Integer,Integer&gt; g = x -&gt; x * <span class="number">2</span>;</span><br><span class="line">Function&lt;Integer,Integer&gt; h = f.andThen(g);</span><br><span class="line"><span class="keyword">int</span> result = h.apply(<span class="number">1</span>); <span class="comment">//4반환 f먼저 계산하고 g계산 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//compose </span></span><br><span class="line">Function&lt;Integer,Integer&gt; f = x -&gt; x + <span class="number">1</span>; </span><br><span class="line">Function&lt;Integer,Integer&gt; g = x -&gt; x * <span class="number">2</span>;</span><br><span class="line">Function&lt;Integer,Integer&gt; h = f.compose(g);</span><br><span class="line"><span class="keyword">int</span> result = h.apply(<span class="number">1</span>); <span class="comment">//3반환 g먼저 계산하고 f계산</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Letter</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">addHeader</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;From Raoul, Mario and Alan: &quot;</span> + text;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">addFooter</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> text + <span class="string">&quot; Kind regards&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">checkSpelling</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> text.replaceAll(<span class="string">&quot;labda&quot;</span>, <span class="string">&quot;lambda&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//header추가 -&gt; 스펠링체크 -&gt; footer추가 순으로 파이프라이닝을 만들수있음. (메서드체이닝)</span></span><br><span class="line">Function&lt;String, String&gt; addHeader = Letter::addHeader;</span><br><span class="line">Function&lt;String, String&gt; transformationPipeline</span><br><span class="line">  = addHeader.andThen(Letter::checkSpelling)</span><br><span class="line">             .andThen(Letter::addFooter);</span><br><span class="line"></span><br><span class="line"><span class="comment">//스펠링체크는 제낄수있음.			 </span></span><br><span class="line">Function&lt;String, String&gt; addHeader = Letter::addHeader;</span><br><span class="line">Function&lt;String, String&gt; transformationPipeline</span><br><span class="line">  = addHeader.andThen(Letter::addFooter);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/20/java8-chaptor3/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/20/jpa-obj-query-3/"
                            aria-label=": jpa-obj-query-3"
                        >
                            jpa-obj-query-3
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-20T10:59:56+00:00">
	
		    May 20, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Study/">Study</a>, <a class="category-link" href="/categories/%EA%B0%9D%EC%B2%B4%EC%A7%80%ED%96%A5%EC%BF%BC%EB%A6%AC%EC%96%B8%EC%96%B4/">객체지향쿼리언어</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%B0%94ORM%ED%91%9C%EC%A4%80JPA%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/">자바ORM표준JPA프로그래밍</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="객체지향-쿼리-언어3"><a href="#객체지향-쿼리-언어3" class="headerlink" title="객체지향 쿼리 언어3"></a>객체지향 쿼리 언어3</h1><h2 id="1-Persistance-Context와-JPQL"><a href="#1-Persistance-Context와-JPQL" class="headerlink" title="1. Persistance Context와 JPQL"></a>1. Persistance Context와 JPQL</h2><h3 id="1-1-쿼리후-영속상태인-것과-아닌것"><a href="#1-1-쿼리후-영속상태인-것과-아닌것" class="headerlink" title="1-1. 쿼리후 영속상태인 것과 아닌것"></a>1-1. 쿼리후 영속상태인 것과 아닌것</h3><figure class="highlight java"><figcaption><span>영속상태구분</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select m form Member m <span class="comment">//엔티티조회 (영속성 관리됨)</span></span><br><span class="line">select o.address from Order o <span class="comment">//임베디드타입 조회 (영속성 관리 안됨)</span></span><br><span class="line">select m.id, m.username from Member m <span class="comment">//단순 필드조회 (영속성 관리 안됨)</span></span><br></pre></td></tr></table></figure>

<p>위 예제를 통해 알수있듯이, 조회한 엔티티만 영속성 컨텍스트에 관리가 됨. </p>
<h3 id="1-2-JPQL로-조회한-엔티티와-영속성-컨텍스트"><a href="#1-2-JPQL로-조회한-엔티티와-영속성-컨텍스트" class="headerlink" title="1-2. JPQL로 조회한 엔티티와 영속성 컨텍스트"></a>1-2. JPQL로 조회한 엔티티와 영속성 컨텍스트</h3><figure class="highlight java"><figcaption><span>영속상태구분</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">em.find(Member.class,<span class="string">&quot;m1&quot;</span>); <span class="comment">//회원1 조회 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//엔티티 쿼리 조회 결과가 회원1, 회원2</span></span><br><span class="line">List&lt;Member&gt; resultList = em.createQuery(<span class="string">&quot;select m from Member m&quot;</span>, Member.class).getResultList(); </span><br></pre></td></tr></table></figure>

<p>em.find로 회원1을 조회했는데, JPQL로 전체를 가져오는 List를 호출하였다. 그럼 위 조회 과정은 어떻게 될까?</p>
<blockquote><p>em.find 호출뒤, List 조회 했을경우 </p>
<ol>
<li>JPQL을 사용해서 조회 요청</li>
<li>JPQL은 SQL로 변환되어 DB에 조회 </li>
<li>조회한 결과와 영속성 컨텍스트를 비교 (em.find로 조회된값 : m1 ,조회한값 :m1,m2)</li>
<li>식별자 기준으로 m1은 이미 영속성관리에 있으므로 버리고, 기존에 영속성관리에 있던 m1이 반환대상이됨.</li>
<li>식별자 기준으로 m2는 영속성 컨텍스트에 없으므로, 영속성컨텍스트에 추가 </li>
<li>쿼리 결과인 m1,m2를 반환한다. 여기서 m1은 쿼리결과가 아니라 영속성 컨텍스트에 있던 엔티티임을 잊지말자! </li>
</ol>
</blockquote>

<p>여기서 알수있는 2가지 사실이있다.</p>
<ol>
<li>JPQL로 조회한 엔티티는 영속상태다. </li>
<li>영속성 컨텍스트에 이미 존재하는 엔티티가 있으면 기존 엔티티를 반환한다. </li>
</ol>
<p>영속성 컨텍스트는 영속상태인 엔티티의 동일성을 보장한다. em.find이든 JPQL로 조회하든 영속성 컨텍스트가 같으면 동일한 엔티티를 반환함. </p>
<h3 id="1-3-find-VS-JPQL"><a href="#1-3-find-VS-JPQL" class="headerlink" title="1-3. find() VS JPQL"></a>1-3. find() VS JPQL</h3><h4 id="find"><a href="#find" class="headerlink" title="find()"></a>find()</h4><ul>
<li>find 메서드는 엔티티를 영속성 컨텍스트에 먼저 찾고 없으면 DB에서 찾는다. 따라서 해당 엔티티가 영속성 컨텍스트에 존재하면 메모리에서 바로 찾으므로 성능상 이점이 있다. (그래서 1차캐시라 부름)</li>
</ul>
<h4 id="JPQL"><a href="#JPQL" class="headerlink" title="JPQL"></a>JPQL</h4><ul>
<li>JPQL은 항상 디비를 조회한다.</li>
<li>JPQL로 조회한 엔티티는 영속상태다. (왜냐 DB 조회후,영속성컨텍스트에 집어넣기때문 )</li>
<li>영속성 컨텍스트에 이미 존재하는 엔티티가있으면 기존 엔티티를 반환함. </li>
</ul>
<h2 id="2-JPQL과-flush모드"><a href="#2-JPQL과-flush모드" class="headerlink" title="2. JPQL과 flush모드"></a>2. JPQL과 flush모드</h2><h3 id="2-1-쿼리와-플러시-모드"><a href="#2-1-쿼리와-플러시-모드" class="headerlink" title="2-1. 쿼리와 플러시 모드"></a>2-1. 쿼리와 플러시 모드</h3><ul>
<li>JPQL은 영속성 컨텍스트 고려하지 않고, DB를 먼저 조회함. 따라서 JPQL을 실행하기전에 영속성 컨텍스트의 내용을 DB에 반영해야함. 그렇지 않으면 상이한결과가 발생할수있음. </li>
<li>FlushMode는 두가지있음. AUTO,COMMIT 이다.<ul>
<li>AUTO : FlushMode를 따로 지정하지 않으면 기본값임. AUTO는 JPQL가 수행되면 자동 FLUSH시켜버림. </li>
<li>COMMIT : COMMIT모드면 말그대로 커밋시점에 FLUSH가 됨. 따라서 JPQL쿼리가 수행되도, FLUSH되지않음. </li>
</ul>
</li>
<li>FlushMode.COMMIT은 왜 씀? <ul>
<li>flush가 너무 빈번하게 일어나는 상황에서 이모드를 사용하면 쿼리시 발생하는 플러시 횟수를 줄여서 성능 최적화 가능함. </li>
</ul>
</li>
<li>JPA를 사용하지않고, JDBC를 직접 사용해서 SQL을 실행할때도 플러시모드는 고민해야함. JPA를 통하지않고 JDBC로 직접 실행하면 JPA는 JDBC가 실행한 쿼리를 인식할 방법이 없음. 따라서 별도 JDBC호출은 플러시 모드를 AUTO로설정해도 무의미함. 이때는 JDBC로 쿼리를 실행하기전에 em.flush를 호출해서 영속성 컨텍스트의 내용을 디비에 동기화 하는게 안점함. </li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/20/jpa-obj-query-3/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/15/coding-test-study-2/"
                            aria-label=": coding-test-study-2"
                        >
                            coding-test-study-2
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-15T09:15:44+00:00">
	
		    May 15, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/datasturct/">datasturct</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0/">자료구조</a>, <a class="category-link" href="/categories/%EC%BD%94%EB%94%A9%ED%85%8C%EC%8A%A4%ED%8A%B8369/">코딩테스트369</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="linkedlist-링크드리스트"><a href="#linkedlist-링크드리스트" class="headerlink" title="linkedlist (링크드리스트)"></a>linkedlist (링크드리스트)</h1><h2 id="1-linkedlist-구조"><a href="#1-linkedlist-구조" class="headerlink" title="1. linkedlist 구조"></a>1. linkedlist 구조</h2><ul>
<li><p>연결 리스트라고도 함</p>
</li>
<li><p>배열은 순차적으로 연결된 공간에 데이터를 나열하는 데이터 구조</p>
</li>
<li><p>링크드 리스트는 떨어진 곳에 존재하는 데이터를 화살표로 연결해서 관리하는 데이터 구조</p>
</li>
<li><p>링크드 리스트 기본 구조와 용어</p>
<ul>
<li>노드(Node): 데이터 저장 단위 (데이터값, 포인터) 로 구성</li>
<li>포인터(pointer): 각 노드 안에서, 다음이나 이전의 노드와의 연결 정보를 가지고 있는 공간</li>
</ul>
</li>
<li><p>일반적인 링크드 리스트 형태<br><img src="https://www.fun-coding.org/00_Images/linkedlist.png" alt="출처: wikipedia, https://en.wikipedia.org/wiki/Linked_list"></p>
</li>
</ul>
<h2 id="2-SingleLinkedList-구현"><a href="#2-SingleLinkedList-구현" class="headerlink" title="2. SingleLinkedList 구현"></a>2. SingleLinkedList 구현</h2><figure class="highlight java"><figcaption><span>linkedlist구현1-Node클래스</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> linkedlist;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> &lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;T&gt; next = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Node&lt;T&gt; <span class="title">getNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNext</span><span class="params">(Node&lt;T&gt; next)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>SingleLinkedList</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> linkedlist;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleLinkedList</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;T&gt; head = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//노트 추가</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addNode</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//head가 아무것도 없을경우</span></span><br><span class="line">        <span class="keyword">if</span>(head == <span class="keyword">null</span>) &#123;</span><br><span class="line">            head = <span class="keyword">new</span> Node&lt;&gt;(data);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;T&gt; node = <span class="keyword">this</span>.head;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//노드 탐색 (null이 아닐때까지 탐색)</span></span><br><span class="line">            <span class="keyword">while</span>(node.getNext() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                node = node.getNext();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 맨 마자막 노드의 next에 새로운 노드 추가 및 생성</span></span><br><span class="line">            node.setNext(<span class="keyword">new</span> Node&lt;&gt;(data));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printNode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head != <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;head.getData() = &quot;</span> + head.getData());</span><br><span class="line">            Node&lt;T&gt; node = head;</span><br><span class="line">            <span class="keyword">while</span>(node.getNext() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                node = node.getNext();</span><br><span class="line">                System.out.println(<span class="string">&quot;node.getData() = &quot;</span> + node.getData());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addNodeInside</span><span class="params">(T data, T target)</span> </span>&#123;</span><br><span class="line">        Node&lt;T&gt; targetNode = <span class="keyword">this</span>.search(target);</span><br><span class="line">        Node&lt;T&gt; addNode = <span class="keyword">new</span> Node&lt;&gt;(data);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// head노드가 targetNode와 같을때 head바로 뒷노드에 생성(next되는 노드들 변경)</span></span><br><span class="line">        <span class="keyword">if</span>(head == targetNode) &#123;</span><br><span class="line">            addNode.setNext(head.getNext());</span><br><span class="line">            head.setNext(addNode);</span><br><span class="line">            <span class="comment">//this.addNode(data);</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 정말 바보같이 한번 더 탐색을 했다. (이미 탐색해서 그정보가지고 하면 된다는걸 알았는데.. targetNode의 next노드를 미리 assignment를 해놓고 해야한다는 생각을 못했음.) </span></span><br><span class="line">			<span class="comment">// 정말 바보같은 짓을 했다. 한번 더 생각하라고 주석처리했음.  </span></span><br><span class="line">			<span class="comment">/*Node&lt;T&gt; node = head;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            //노드 탐색</span></span><br><span class="line"><span class="comment">            while(node.getNext() != null) &#123;</span></span><br><span class="line"><span class="comment">                node = node.getNext();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                //targetNode와 같은 노드일경우 그 다음 노드에 생성 역시 next로 참조되는 부분 변경</span></span><br><span class="line"><span class="comment">                if(node == targetNode) &#123;</span></span><br><span class="line"><span class="comment">                    addNode.setNext(node.getNext());</span></span><br><span class="line"><span class="comment">                    node.setNext(addNode);</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;*/</span></span><br><span class="line">            Node&lt;T&gt; nextNode = targetNode.getNext();</span><br><span class="line">            targetNode.setNext(addNode);</span><br><span class="line">            addNode.setNext(nextNode);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Node&lt;T&gt; <span class="title">search</span><span class="params">(T target)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//head의 데이터가 target과 같을 경우</span></span><br><span class="line">        <span class="keyword">if</span>(head.getData() == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;T&gt; node = head;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//노드 탐색</span></span><br><span class="line">            <span class="keyword">while</span>(node.getNext() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//탐색된 노드의 데이터와 target이 같을경우 해당 노드반환</span></span><br><span class="line">                <span class="keyword">if</span>(node.getData() == target) &#123;</span><br><span class="line">                    <span class="keyword">return</span> node;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                node = node.getNext();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//아무것도 탐색되지 않았을때는 그냥 마지막 노드 반환 (맨마지막에 넣어주기위해서)</span></span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteNode</span><span class="params">(T target)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//head가 제거 대상일경우는 다음 노드가 head가됨</span></span><br><span class="line">        <span class="keyword">if</span>(head.getData() == target) &#123;</span><br><span class="line">            head = head.getNext();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;T&gt; node = head;</span><br><span class="line">            <span class="comment">//노드 탐색</span></span><br><span class="line">            <span class="keyword">while</span>(node.getNext() != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="comment">//처음에는 여기에 놨었다. 그래서 node.getNext의 또 다음 getNext를 가져오는 격이 되어버렸음. </span></span><br><span class="line">				<span class="comment">//그래서 잠재적인 버그를 유발 시켰었다. 이러면 낙제점이다. 디버깅을 했는데.. 왜 감지를 못했던가... </span></span><br><span class="line">				<span class="comment">//node = node.getNext();</span></span><br><span class="line">				</span><br><span class="line">                <span class="comment">//탐색된 노드의 다음 노드의 데이터가 일치할경우</span></span><br><span class="line">                <span class="keyword">if</span>(node.getNext().getData() == target) &#123;</span><br><span class="line">                    node.setNext(node.getNext().getNext());</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">				</span><br><span class="line">                node = node.getNext();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>SingleLinkedList 수행</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> linkedlist;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleLinkedListMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> single = <span class="keyword">new</span> SingleLinkedList&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">        single.addNode(<span class="string">&quot;sim&quot;</span>);</span><br><span class="line">        single.addNode(<span class="string">&quot;ji&quot;</span>);</span><br><span class="line">        single.addNode(<span class="string">&quot;sung&quot;</span>);</span><br><span class="line"></span><br><span class="line">        single.addNodeInside(<span class="string">&quot;a.k.a&quot;</span>, <span class="string">&quot;sim&quot;</span>);</span><br><span class="line">        single.addNodeInside(<span class="string">&quot;dawn&quot;</span>,<span class="string">&quot;a.k.a&quot;</span>);</span><br><span class="line">        single.addNodeInside(<span class="string">&quot;s&quot;</span>,<span class="string">&quot;sss&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(single.deleteNode(<span class="string">&quot;ji&quot;</span>));</span><br><span class="line">        System.out.println(single.deleteNode(<span class="string">&quot;s&quot;</span>));</span><br><span class="line">        System.out.println(single.deleteNode(<span class="string">&quot;a&quot;</span>));</span><br><span class="line">        single.printNode();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/15/coding-test-study-2/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/13/coding-test-study-1/"
                            aria-label=": coding-test-study-1"
                        >
                            coding-test-study-1
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-13T14:05:38+00:00">
	
		    May 13, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/datasturct/">datasturct</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0/">자료구조</a>, <a class="category-link" href="/categories/%EC%BD%94%EB%94%A9%ED%85%8C%EC%8A%A4%ED%8A%B8369/">코딩테스트369</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="Queue-큐-Stack-스택"><a href="#Queue-큐-Stack-스택" class="headerlink" title="Queue (큐) / Stack (스택)"></a>Queue (큐) / Stack (스택)</h1><h2 id="1-Queue-구조"><a href="#1-Queue-구조" class="headerlink" title="1. Queue 구조"></a>1. Queue 구조</h2><ul>
<li>FIFO (First-In First-Out) 처음들어간 element가 처음으로 빠져나감. </li>
<li>소위, 줄서는 행위와 유사함. </li>
</ul>
<h3 id="자바에서-Queue-객체-사용하기"><a href="#자바에서-Queue-객체-사용하기" class="headerlink" title="자바에서 Queue 객체 사용하기"></a>자바에서 Queue 객체 사용하기</h3><ul>
<li>JAVA 에서는 기본적으로 java.util 패키지에 Queue 클래스를 제공하고 있음<ul>
<li>Enqueue 에 해당하는 기능으로 Queue 클래스에서는 add(value) 또는 offer(value) 메서드를 제공함</li>
<li>Dequeue 에 해당하는 기능으로 Queue 클래스에서는 poll() 또는 remove() 메서드를 제공함<ul>
<li>아쉽게도, Queue 클래스에 데이터 생성을 위해서는 java.util 패키지에 있는 LinkedList 클래스를 사용해야 함</li>
<li>LinkedList 클래스는 자료구조의 링크드리스트 와 연관이 있으며, 관련 내용은 큐보다 복잡하므로 이후 챕터에서 상세히 익히도록 함</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><figcaption><span>java.util.Queue 사용</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Queue 사용을 위해, LinkedList 클래스를 사용하므로, 두 클래스 모두 import 해야 함</span></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList; </span><br><span class="line"><span class="keyword">import</span> java.util.Queue; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 자료형 매개변수를 넣어서, 큐에 들어갈 데이터의 타입을 지정해야 함</span></span><br><span class="line">Queue&lt;Integer&gt; queue_int = <span class="keyword">new</span> LinkedList&lt;Integer&gt;(); <span class="comment">// Integer 형 queue 선언</span></span><br><span class="line">Queue&lt;String&gt; queue_str = <span class="keyword">new</span> LinkedList&lt;String&gt;(); <span class="comment">// String 형 queue 선언</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 데이터 추가는 add(value) 또는 offer(value) 를 사용함</span></span><br><span class="line">queue_int.add(<span class="number">1</span>);</span><br><span class="line">queue_int.offer(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// poll() 은 큐의 첫 번째 값 반환, 해당 값은 큐에서 삭제</span></span><br><span class="line">queue_int.poll();</span><br><span class="line"></span><br><span class="line"><span class="comment">// poll() 과 마찬가지로, 첫 번째 값 반환하고, 해당 값은 큐에서 삭제</span></span><br><span class="line">queue_int.remove();</span><br></pre></td></tr></table></figure>

<h3 id="참고-어디에-큐가-많이-쓰일까"><a href="#참고-어디에-큐가-많이-쓰일까" class="headerlink" title="참고: 어디에 큐가 많이 쓰일까?"></a>참고: 어디에 큐가 많이 쓰일까?</h3><ul>
<li>멀티 태스킹을 위한 프로세스 스케쥴링 방식을 구현하기 위해 많이 사용됨 (운영체제 참조)</li>
</ul>
<blockquote>
<p>큐의 경우에는 장단점 보다는 (특별히 언급되는 장단점이 없음), 큐의 활용 예로 프로세스 스케쥴링 방식을 함께 이해해두는 것이 좋음</p>
</blockquote>
<h3 id="1-2-Queue구현-ArrayList-활용"><a href="#1-2-Queue구현-ArrayList-활용" class="headerlink" title="1-2. Queue구현 (ArrayList 활용)"></a>1-2. Queue구현 (ArrayList 활용)</h3><figure class="highlight java"><figcaption><span>queue구현</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Queue</span> &lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; queue = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//enqueue</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">enqueue</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">        queue.add(data);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//dequeue</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">dequeue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(queue.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        T data = queue.get(<span class="number">0</span>);</span><br><span class="line">        queue.remove(data);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printCurrentQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;======================&quot;</span>);</span><br><span class="line">        queue.stream().forEach(System.out::println);</span><br><span class="line">        System.out.println(<span class="string">&quot;======================&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>Queue수행</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueueMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Queue&lt;String&gt; q1 = <span class="keyword">new</span> Queue&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        q1.enqueue(<span class="string">&quot;sim&quot;</span>);</span><br><span class="line">        q1.enqueue(<span class="string">&quot;ji&quot;</span>);</span><br><span class="line">        q1.enqueue(<span class="string">&quot;sung&quot;</span>);</span><br><span class="line"></span><br><span class="line">        q1.printCurrentQueue();</span><br><span class="line"></span><br><span class="line">        q1.dequeue();</span><br><span class="line"></span><br><span class="line">        q1.printCurrentQueue();</span><br><span class="line"></span><br><span class="line">        q1.dequeue();</span><br><span class="line"></span><br><span class="line">        q1.printCurrentQueue();</span><br><span class="line"></span><br><span class="line">        q1.dequeue();</span><br><span class="line"></span><br><span class="line">        q1.printCurrentQueue();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;q1.dequeue() = &quot;</span> + q1.dequeue());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-Stack-구조"><a href="#2-Stack-구조" class="headerlink" title="2. Stack 구조"></a>2. Stack 구조</h2><ul>
<li>Stack은 LIFO(Last In First Out) 나중에 입력된 element가 가장 먼저 빠지는 구조 </li>
<li>컴퓨터 내부의 프로세스 구조의 함수 동작 방식(OS의 프로세스 동작 방식)</li>
</ul>
<h3 id="2-1-자료-구조-스택의-장단점"><a href="#2-1-자료-구조-스택의-장단점" class="headerlink" title="2-1. 자료 구조 스택의 장단점"></a>2-1. 자료 구조 스택의 장단점</h3><ul>
<li>장점<ul>
<li>구조가 단순해서, 구현이 쉽다.</li>
<li>데이터 저장/읽기 속도가 빠르다.</li>
</ul>
</li>
<li>단점 (일반적인 스택 구현시) <ul>
<li>데이터 최대 갯수를 미리 정해야 한다. </li>
<li>저장 공간의 낭비가 발생할 수 있음<ul>
<li>미리 최대 갯수만큼 저장 공간을 확보해야 함</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>스택은 단순하고 빠른 성능을 위해 사용되므로, 보통 배열 구조를 활용해서 구현하는 것이 일반적임.<br>이 경우, 위에서 열거한 단점이 있을 수 있음</p>
</blockquote>
<h3 id="2-2-Stack-구현-ArrayList-사용"><a href="#2-2-Stack-구현-ArrayList-사용" class="headerlink" title="2-2. Stack 구현 (ArrayList 사용)"></a>2-2. Stack 구현 (ArrayList 사용)</h3><figure class="highlight java"><figcaption><span>Stack클래스</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stack</span> &lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; stack = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//push</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">push</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">        stack.add(data);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//pop</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(stack.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> data = stack.get(stack.size() - <span class="number">1</span>);</span><br><span class="line">        stack.remove(data);</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===========&quot;</span>);</span><br><span class="line">        stack.forEach(System.out::println);</span><br><span class="line">        System.out.println(<span class="string">&quot;===========&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>Stack수행</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StackMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        stack.push(<span class="number">1L</span>);</span><br><span class="line">        stack.push(<span class="number">2L</span>);</span><br><span class="line">        stack.push(<span class="number">3L</span>);</span><br><span class="line"></span><br><span class="line">        stack.print();</span><br><span class="line"></span><br><span class="line">        stack.pop();</span><br><span class="line">        stack.pop();</span><br><span class="line"></span><br><span class="line">        stack.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;\</span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/13/coding-test-study-1/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/13/coding-test-study-0/"
                            aria-label=": coding-test-study-0"
                        >
                            coding-test-study-0
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-13T13:45:02+00:00">
	
		    May 13, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/datasturct/">datasturct</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0/">자료구조</a>, <a class="category-link" href="/categories/%EC%BD%94%EB%94%A9%ED%85%8C%EC%8A%A4%ED%8A%B8369/">코딩테스트369</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="코딩테스트-369-사전-세팅"><a href="#코딩테스트-369-사전-세팅" class="headerlink" title="코딩테스트 369 : 사전 세팅"></a>코딩테스트 369 : 사전 세팅</h1><h2 id="1-주피터-노트북-설치-및-수행방법-로컬설치"><a href="#1-주피터-노트북-설치-및-수행방법-로컬설치" class="headerlink" title="1. 주피터 노트북 설치 및 수행방법 (로컬설치)"></a>1. 주피터 노트북 설치 및 수행방법 (로컬설치)</h2><p><img src="/images/coding369/0513-1.png" alt="아나콘다 사이트 설치 화면"></p>
<p><a target="_blank" rel="noopener" href="https://www.anaconda.com/products/individual">아나콘다 개인판 설치 URL</a></p>
<p>해당 부분 설치하고 나서 아나콘다 수행후 주피터 노트북 실행하면 끝! </p>
<h2 id="2-JAVA-호환-적용-방법"><a href="#2-JAVA-호환-적용-방법" class="headerlink" title="2. JAVA 호환 적용 방법"></a>2. JAVA 호환 적용 방법</h2><p>IJava 모듈을 다운받은뒤, 해당 폴더에 들어있는, java폴더와 install.py를 해당 강의자료에 복사 혹은 이동 시키기! </p>
<p><a target="_blank" rel="noopener" href="https://github.com/SpencerPark/IJava/releases">IJava설치모듈다운로드</a></p>
<p><img src="/images/coding369/0513-1.png" alt="설치후 IJava 모듈 복사후 화면"></p>
<p>IJava모듈을 복사 이동 시킨뒤, </p>
<p>!python install.py –sys-prefix</p>
<p>위 명령어 수행시킨다. (주피터 노트북에서 수행해도 됨!)</p>
<p>수행시키고난뒤, 주피터노트북 및 아나콘다 재시작하면 JAVA호환 부분 완료! </p>
<h2 id="3-사용방법"><a href="#3-사용방법" class="headerlink" title="3. 사용방법"></a>3. 사용방법</h2><ul>
<li>기본적으로 MarkDown 사용가능 </li>
<li>신기한건 코드를 넣으면 실행결과를 실시간으로 확인 가능함. </li>
</ul>
<p><img src="/images/coding369/0513-1.png" alt="코드 적용 화면"></p>
<ul>
<li>위 화면에서 해당 코드블록 선택한뒤 Shift + Enter 하면 수행됨. 단, 순차적으로 관련코드들을 수행해줘야 결과값을 출력할수있음. </li>
<li>화면에서 왼쪽에 파란색 상태에서 A/B 키보드 클릭시 추가적인 코드블록이나 MD 를 타이핑할수있다. </li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/13/coding-test-study-0/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/12/mapstruct-2/"
                            aria-label=": mapstruct-2"
                        >
                            mapstruct-2
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-12T01:27:36+00:00">
	
		    May 12, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Mapstruct/">Mapstruct</a>, <a class="category-link" href="/categories/%EC%9C%A0%EB%A0%88%EC%B9%B4or%EC%82%BD%EC%A7%88/">유레카or삽질</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="Mapstruct-삽질기2-활용편-custom-mapping-사용방법"><a href="#Mapstruct-삽질기2-활용편-custom-mapping-사용방법" class="headerlink" title="Mapstruct 삽질기2 : 활용편 (custom mapping 사용방법)"></a>Mapstruct 삽질기2 : 활용편 (custom mapping 사용방법)</h1><h2 id="1-적용했는데-문제-발생-문제가-뭐야"><a href="#1-적용했는데-문제-발생-문제가-뭐야" class="headerlink" title="1. 적용했는데 문제 발생! 문제가 뭐야?"></a>1. 적용했는데 문제 발생! 문제가 뭐야?</h2><p>사건의 발단은 이렇다. 직장동료가 내가 전파한 MapStruct를 가지고 적용을 했는데, lombok을 같이 사용하다보니, isUse라는 Entity에서 useYn으로 변환을 시켜줘야하는 이슈가 있었다. 결국 boolean -&gt; String 으로 변환을 시켜줘야 하는데, 잘 안되었던것이다. 그리고 lombok에서 접두어에 is- 를 붙이면 네이밍이슈가 발생하여서, 이부분도 골칫거리였다. lombok에서 boolean타입일땐.. 가급적 is-접두어 붙이지말자..-_-; 여러가지로 상당히 피곤해짐….</p>
<h2 id="2-해결방법"><a href="#2-해결방법" class="headerlink" title="2. 해결방법"></a>2. 해결방법</h2><p>해결방법은 직장동료분께서 적용한 방식과 내가 적용한 방식 두가지 방식으로 해결할수있었다. </p>
<h3 id="2-1-해결방법1-Named로-정의하기해서-사용하기"><a href="#2-1-해결방법1-Named로-정의하기해서-사용하기" class="headerlink" title="2-1. 해결방법1 : @Named로 정의하기해서 사용하기!"></a>2-1. 해결방법1 : @Named로 정의하기해서 사용하기!</h3><figure class="highlight java"><figcaption><span>named사용방법</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.cms.api.utils.mapstruct.app;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.cms.api.dto.app.AppExaminationDto;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.cms.domain.repository.jpa.vcontent.app.entity.AppExaminationEntity;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.cms.domain.utils.mapstruct.GenericMapper;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapping;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Named;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper(componentModel=&quot;spring&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppExaminationMapper</span> <span class="keyword">extends</span> <span class="title">GenericMapper</span>&lt;<span class="title">AppExaminationDto</span>, <span class="title">AppExaminationEntity</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;use&quot;, target = &quot;useYn&quot;, qualifiedByName = &quot;booleanToYN&quot;)</span></span><br><span class="line">    <span class="function">AppExaminationDto <span class="title">toDto</span><span class="params">(AppExaminationEntity appExaminationEntity)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Named(&quot;booleanToYN&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">default</span> String <span class="title">booleanToYN</span><span class="params">(<span class="keyword">boolean</span> bool)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bool ? <span class="string">&quot;Y&quot;</span> : <span class="string">&quot;N&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>@Named로 일종의 custom mapper를 만들어서 사용 (qualifiedByName 으로 해당 메서드 주입? 연결 시킴)</li>
<li>interface의 default메서드를 활용해서 구현체에 영향주지 않도록 걸어둠 </li>
<li>isUse로 사용했던 부분은 mapping시 use로 변경해서 매핑 (lombok이슈인듯)</li>
<li>단일 매퍼 적용시 기대효과 괜춘할듯. </li>
</ol>
<h3 id="2-2-해결방법2-uses로-매핑하여-사용하기"><a href="#2-2-해결방법2-uses로-매핑하여-사용하기" class="headerlink" title="2-2. 해결방법2 : uses로 매핑하여 사용하기!"></a>2-2. 해결방법2 : uses로 매핑하여 사용하기!</h3><figure class="highlight java"><figcaption><span>booleanMapper생성</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.cms.api.utils.mapstruct.app;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.cms.api.dto.app.AppExaminationDto;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.cms.domain.repository.jpa.vcontent.app.entity.AppExaminationEntity;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.cms.domain.utils.mapstruct.GenericMapper;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapping;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Named;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper(uses = BooleanYNMapper.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppExaminationMapper</span> <span class="keyword">extends</span> <span class="title">GenericMapper</span>&lt;<span class="title">AppExaminationDto</span>, <span class="title">AppExaminationEntity</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Mapping(source = &quot;use&quot;, target = &quot;useYn&quot;)</span></span><br><span class="line">    <span class="function">AppExaminationDto <span class="title">toDto</span><span class="params">(AppExaminationEntity appExaminationEntity)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.wemakeprice.v.cms.api.utils.mapstruct.app;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BooleanYNMapper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">asString</span><span class="params">(Boolean use)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span> == use ?</span><br><span class="line">            <span class="keyword">null</span> : (use ?</span><br><span class="line">            <span class="string">&quot;Y&quot;</span> : <span class="string">&quot;N&quot;</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>componentModel=”spring” 제거 (이렇게 걸고 BooleanYNMapper생성하니 nullpointer발생)</li>
<li>uses는 여러개 mapper를 적용할수있다. 따라서 생성된 custom mapper들은 공통 로직으로 활용가능함. (해결방법1은 그 mapper만 적용할때 사용 하면 될듯)</li>
<li>isUse로 사용했던 부분은 mapping시 use로 변경해서 매핑 (lombok이슈인듯)</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/54610680/mapstruct-mapping-boolean-to-string">참고1. 스택오버플로우 질문</a><br><a target="_blank" rel="noopener" href="https://mapstruct.org/documentation/stable/reference/html/#invoking-other-mappers">참고2. 공식사이트 내용</a></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/12/mapstruct-2/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/10/mapstruct-1/"
                            aria-label=": mapstruct-1"
                        >
                            mapstruct-1
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-10T03:18:01+00:00">
	
		    May 10, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Mapstruct/">Mapstruct</a>, <a class="category-link" href="/categories/%EC%9C%A0%EB%A0%88%EC%B9%B4or%EC%82%BD%EC%A7%88/">유레카or삽질</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="Mapstruct-삽질기-기본편"><a href="#Mapstruct-삽질기-기본편" class="headerlink" title="Mapstruct 삽질기 : 기본편"></a>Mapstruct 삽질기 : 기본편</h1><h2 id="1-Mapstruct란"><a href="#1-Mapstruct란" class="headerlink" title="1. Mapstruct란?"></a>1. Mapstruct란?</h2><p><a target="_blank" rel="noopener" href="https://mapstruct.org/">Mapstruct 공식사이트</a></p>
<p>MapStruct is a code generator that greatly simplifies the implementation of mappings between Java bean types based on a convention over configuration approach.<br>자바빈즈기반의 객체를 간단한 컨벤션 설정을 통해 매핑시켜주는 역할을 담당한다고 생각하면 됨. 그냥 ModelMapper와 유사한 기능을 한다고 생각하면 됨. (그렇다고 둘이 매커니즘이 같은건 아님. )</p>
<hr>
<h2 id="2-왜-사용함"><a href="#2-왜-사용함" class="headerlink" title="2. 왜 사용함?"></a>2. 왜 사용함?</h2><p>Multi-layered applications often require to map between different object models (e.g. entities and DTOs). Writing such mapping code is a tedious and error-prone task. MapStruct aims at simplifying this work by automating it as much as possible.<br>In contrast to other mapping frameworks MapStruct generates bean mappings at compile-time which ensures a high performance, allows for fast developer feedback and thorough error checking.</p>
<p>Multi-layered (멀티모듈 프로젝트 같은것?)은 다른 객체 모델에 대해서 매핑시켜줘야하는 일들이 많다. 예를들어서 Entity를 DTO로. 기존 노가다성 메핑할떄는 세레머니 코드들이 많이 들어가있고(map,mapToList..) 에러를 유발시킬수있는 코드로 실수할수있는데, MapStruct는 이런 부분을 자동으로 간단스하게 처리 해줌.<br>다른 매핑프레임워크에 비해서 MapStruct는 컴파일 시점에 mapping 코드를 생성하기때문에 성능적으로 안정적인 부분과 컴파일시점에 에러를 잡아낼수있어서, 개발자의 실수를 줄일수있음. (modelmapper는 runtime시점에 mapping하기때문에 생성비용이 꽤나큼 뭐 Bean Scope가 singleton이라 한번 컨테이너 올리면.. 그닥 큰 이슈가 아닐란가싶긴하지만..runtime과 compile시점은 엄청난 차이가 있음. compile시점이 사실 안정적으로 실수나 에러검증을 해주기가 아주 유리함!)</p>
<hr>
<h2 id="3-설정"><a href="#3-설정" class="headerlink" title="3. 설정"></a>3. 설정</h2><h3 id="3-1-build-gradle"><a href="#3-1-build-gradle" class="headerlink" title="3-1. build.gradle"></a>3-1. build.gradle</h3><p>설정위해서는 lombok 의존성을 추가한 root 프로젝트쪽 build.gradle쪽에 추가해줘야함. 중요한 부분은 lombok을 사용하면 의존성 추가할때 위치나 버전에 따라 설정이 달라질수있음. </p>
<figure class="highlight plain"><figcaption><span>root-build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">dependencies &#123;</span><br><span class="line"></span><br><span class="line">        implementation &#39;org.mapstruct:mapstruct:1.4.1.Final&#39;</span><br><span class="line">        compileOnly &#39;org.projectlombok:lombok&#39;</span><br><span class="line">        compile group: &#39;org.projectlombok&#39;, name: &#39;lombok-mapstruct-binding&#39;, version: &#39;0.2.0&#39;</span><br><span class="line">        annotationProcessor &#39;org.springframework.boot:spring-boot-configuration-processor&#39;</span><br><span class="line">        annotationProcessor &#39;org.projectlombok:lombok&#39;</span><br><span class="line">        annotationProcessor &#39;org.mapstruct:mapstruct-processor:1.4.1.Final&#39;</span><br><span class="line"></span><br><span class="line">        testImplementation(&#39;org.springframework.boot:spring-boot-starter-test&#39;) &#123;</span><br><span class="line">            exclude group: &#39;org.junit.vintage&#39;, module: &#39;junit-vintage-engine&#39;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; jackson</span><br><span class="line">        implementation(&#39;com.fasterxml.jackson.core:jackson-databind&#39;)</span><br><span class="line">        implementation(&#39;com.google.code.gson:gson:2.8.0&#39;)</span><br><span class="line">        implementation(&#39;com.google.guava:guava:28.0-jre&#39;)</span><br><span class="line">        implementation(&#39;commons-codec:commons-codec&#39;)</span><br><span class="line">        implementation(&#39;org.apache.commons:commons-lang3:3.9&#39;)</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; jsr validation</span><br><span class="line">        implementation(&#39;javax.validation:validation-api:2.0.1.Final&#39;)</span><br><span class="line"></span><br><span class="line">        testCompile group: &#39;junit&#39;, name: &#39;junit&#39;, version: &#39;4.12&#39;</span><br><span class="line">        testImplementation(&#39;org.easytesting:fest-assert:1.4&#39;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-GenericMapper"><a href="#3-2-GenericMapper" class="headerlink" title="3-2. GenericMapper"></a>3-2. GenericMapper</h3><p>사실 굳이 안만들어도 되긴하는데, 한벌 만들어놓으면 공통로직으로 사용하기 용이함 </p>
<figure class="highlight java"><figcaption><span>api-GenericMapper</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.api.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.mapstruct.NullValuePropertyMappingStrategy.IGNORE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.mapstruct.BeanMapping;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.MappingTarget;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GenericMapper</span>&lt;<span class="title">D</span>,<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">D <span class="title">toDto</span><span class="params">(E e)</span></span>;</span><br><span class="line">    <span class="function">E <span class="title">toEntity</span><span class="params">(D d)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeanMapping(nullValuePropertyMappingStrategy = IGNORE)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateFromDto</span><span class="params">(D dto, <span class="meta">@MappingTarget</span> E entity)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-사용방법"><a href="#4-사용방법" class="headerlink" title="4. 사용방법"></a>4. 사용방법</h2><p>사용 예시는 mapToList 의 예시이다. 하지만 기존 modelMapper에서 처리하는 부분도 @Mapper내에서 가능한것으로 파악되어짐. </p>
<figure class="highlight java"><figcaption><span>entity to dto 사용방법</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.api.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.api.dto.order.PurchaseInfo;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.repository.escrow.order.Purchase;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper(componentModel = &quot;spring&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PurchaseMapper</span> <span class="keyword">extends</span> <span class="title">GenericMapper</span>&lt;<span class="title">PurchaseInfo</span>, <span class="title">Purchase</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">List&lt;PurchaseInfo&gt; <span class="title">getPurchaseInfo</span><span class="params">(List&lt;Purchase&gt; purchaseEntity)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>실사용소스</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.api.service.purchase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.api.dto.order.PurchaseInfo;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.api.dto.order.PurchaseRequestParam;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.api.mapper.PurchaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.provider.order.PurchaseProvider;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.utils.ModelMapperUtils;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.meta.order.OrderType;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.factory.Mappers;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PurchaseService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PurchaseProvider purchaseProvider;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PurchaseMapper purchaseMapper = Mappers.getMapper(PurchaseMapper.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;PurchaseInfo&gt; <span class="title">getPurchaseInfo</span><span class="params">(PurchaseRequestParam param)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//return ModelMapperUtils.mapToList(purchaseProvider.findByOrderTypeAndMid(param.getOrderType(),param.getMid()),PurchaseInfo.class);</span></span><br><span class="line">        <span class="keyword">return</span> purchaseMapper.getPurchaseInfo(purchaseProvider.findByOrderTypeAndMid(param.getOrderType(),param.getMid()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;PurchaseInfo&gt; <span class="title">getPurchaseInfoByOrderType</span><span class="params">(OrderType orderType)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//return ModelMapperUtils.mapToList(purchaseProvider.findByOrderTypeEquals(orderType),PurchaseInfo.class);</span></span><br><span class="line">        <span class="keyword">return</span> purchaseMapper.getPurchaseInfo(purchaseProvider.findByOrderTypeEquals(orderType));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>purchaseInfoImpl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wemakeprice.v.ocs.api.mapper;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.api.dto.order.PurchaseInfo;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.domain.repository.escrow.order.Purchase;</span><br><span class="line"><span class="keyword">import</span> com.wemakeprice.v.ocs.meta.order.OrderType;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Generated;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Generated(</span></span><br><span class="line"><span class="meta">    value = &quot;org.mapstruct.ap.MappingProcessor&quot;,</span></span><br><span class="line"><span class="meta">    date = &quot;2021-05-10T12:03:46+0900&quot;,</span></span><br><span class="line"><span class="meta">    comments = &quot;version: 1.4.1.Final, compiler: IncrementalProcessingEnvironment from gradle-language-java-6.8.3.jar, environment: Java 1.8.0_181 (Oracle Corporation)&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PurchaseMapperImpl</span> <span class="keyword">implements</span> <span class="title">PurchaseMapper</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PurchaseInfo <span class="title">toDto</span><span class="params">(Purchase e)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( e == <span class="keyword">null</span> ) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        PurchaseInfo purchaseInfo = <span class="keyword">new</span> PurchaseInfo();</span><br><span class="line"> </span><br><span class="line">        purchaseInfo.setPurchaseNo( e.getPurchaseNo() );</span><br><span class="line">        <span class="keyword">if</span> ( e.getOrderType() != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            purchaseInfo.setOrderType( e.getOrderType().name() );</span><br><span class="line">        &#125;</span><br><span class="line">        purchaseInfo.setTotProdPrice( e.getTotProdPrice() );</span><br><span class="line">        purchaseInfo.setTotShipPrice( e.getTotShipPrice() );</span><br><span class="line">        purchaseInfo.setBuyerNm( e.getBuyerNm() );</span><br><span class="line">        purchaseInfo.setBuyerPhone( e.getBuyerPhone() );</span><br><span class="line">        purchaseInfo.setMid( e.getMid() );</span><br><span class="line">        purchaseInfo.setRegDt( e.getRegDt() );</span><br><span class="line">        purchaseInfo.setChgDt( e.getChgDt() );</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> purchaseInfo;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Purchase <span class="title">toEntity</span><span class="params">(PurchaseInfo d)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( d == <span class="keyword">null</span> ) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        Purchase purchase = <span class="keyword">new</span> Purchase();</span><br><span class="line"> </span><br><span class="line">        purchase.setPurchaseNo( d.getPurchaseNo() );</span><br><span class="line">        <span class="keyword">if</span> ( d.getOrderType() != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            purchase.setOrderType( Enum.valueOf( OrderType.class, d.getOrderType() ) );</span><br><span class="line">        &#125;</span><br><span class="line">        purchase.setTotProdPrice( d.getTotProdPrice() );</span><br><span class="line">        purchase.setTotShipPrice( d.getTotShipPrice() );</span><br><span class="line">        purchase.setBuyerNm( d.getBuyerNm() );</span><br><span class="line">        purchase.setBuyerPhone( d.getBuyerPhone() );</span><br><span class="line">        purchase.setMid( d.getMid() );</span><br><span class="line">        purchase.setRegDt( d.getRegDt() );</span><br><span class="line">        purchase.setChgDt( d.getChgDt() );</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> purchase;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateFromDto</span><span class="params">(PurchaseInfo dto, Purchase entity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( dto == <span class="keyword">null</span> ) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> ( dto.getPurchaseNo() != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            entity.setPurchaseNo( dto.getPurchaseNo() );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( dto.getOrderType() != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            entity.setOrderType( Enum.valueOf( OrderType.class, dto.getOrderType() ) );</span><br><span class="line">        &#125;</span><br><span class="line">        entity.setTotProdPrice( dto.getTotProdPrice() );</span><br><span class="line">        entity.setTotShipPrice( dto.getTotShipPrice() );</span><br><span class="line">        <span class="keyword">if</span> ( dto.getBuyerNm() != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            entity.setBuyerNm( dto.getBuyerNm() );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( dto.getBuyerPhone() != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            entity.setBuyerPhone( dto.getBuyerPhone() );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( dto.getMid() != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            entity.setMid( dto.getMid() );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( dto.getRegDt() != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            entity.setRegDt( dto.getRegDt() );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( dto.getChgDt() != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            entity.setChgDt( dto.getChgDt() );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;PurchaseInfo&gt; <span class="title">getPurchaseInfo</span><span class="params">(List&lt;Purchase&gt; purchaseEntity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( purchaseEntity == <span class="keyword">null</span> ) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        List&lt;PurchaseInfo&gt; list = <span class="keyword">new</span> ArrayList&lt;PurchaseInfo&gt;( purchaseEntity.size() );</span><br><span class="line">        <span class="keyword">for</span> ( Purchase purchase : purchaseEntity ) &#123;</span><br><span class="line">            list.add( toDto( purchase ) );</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-참고"><a href="#5-참고" class="headerlink" title="5. 참고"></a>5. 참고</h2><ul>
<li>modelMapper는 runtime시점에 reflection 하기때문에 runtime시에만 발생할수 있는 문제를 야기 시킬수 있음. <ul>
<li>리플렉션으로 메서드 혹은 클래스에 접근할때 찾지 못하는 이슈가 runtime시에만 발생할수 있기때문에 그것에 대한 예외처리가 반드시 필요하다. </li>
<li>getMethod나 getClass 사용시 superclass,superinterface의 메서드를 호출하려 하기때문에 컴파일시에 감지하지 못하는 에러가 발생할수도 있음. (SecurityException발생 -&gt; checkPackageAccess() 전처리 필요)</li>
<li>runtime시점에 변환작업을 수행하기때문에 성능이슈가 발생할수있음. 기존 setter로 하는것이 한번에 세팅된다면, 리플렉션으로 두단계 더 거친뒤에야 세팅하기때문에 대량 처리할때는 비용이 클수가 있음.</li>
<li>이에반헤 mapStruct는 컴파일시점에 코드를 generate 시켜서 해당 부분의 코드 및 파일이 증가하는 이슈가 있지만 runtime시에 발생할수있는 리플렉션 에러는 방지할수있음. </li>
<li>결론은 runtime 시점에 리플렉션으로 처리되는 부분들은 가급적 사용하지 말자. 컴파일 시점에서 체크하는것이 가장 안전함.  </li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.skyer9.pe.kr/wordpress/?p=1596">상구리의 기술 블로그 참고</a><br><a target="_blank" rel="noopener" href="https://www.baeldung.com/mapstruct">baeldung-mapstruct 가이드</a><br><a target="_blank" rel="noopener" href="https://mapstruct.org/documentation/stable/reference/html/">mapstruct공식사이트</a></p>
<hr>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/10/mapstruct-1/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
          <li class="pagination-next">
            <a
                class="btn btn--default btn--small"
                href="/archives/page/2/"
                aria-label="OLDER POSTS"
            >
              <span>OLDER POSTS</span>
              <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
          </li>
        
        <li class="pagination-number">page 1 of 5</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 codexdawn. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">codexdawn</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ikbi0v8fyzuu91xv5rmpcrnwb4qinfgborzd5kejmj8wr6ibfra8oaxqshyg.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
