
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="codexdawn">
    <title>Archives: 2021/4 - codexdawn</title>
    <meta name="author" content="codexdawn">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="codexdawn">
<meta property="og:url" content="https://codexdawn.github.io/archives/2021/04/index.html">
<meta property="og:site_name" content="codexdawn">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="codexdawn">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-3sspfygaapf5d6tbrnqmyrhdcstv0iwwmi4wor2yeip9c44sowy9gbdzyyjm.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            codexdawn
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/codexdawn"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.facebook.com/beherzt.dev"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/sim-jisung-3048872a/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:cloudkaiser@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/04/28/value-type/"
                            aria-label=": value-type"
                        >
                            value-type
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-04-28T13:53:22+00:00">
	
		    Apr 28, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Study/">Study</a>, <a class="category-link" href="/categories/%EA%B0%92%ED%83%80%EC%9E%85/">값타입</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%B0%94ORM%ED%91%9C%EC%A4%80JPA%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/">자바ORM표준JPA프로그래밍</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="값-타입"><a href="#값-타입" class="headerlink" title="값 타입"></a>값 타입</h1><blockquote><p>JPA 데이터 분류 2가지</p>
<ol>
<li>엔티티 타입</li>
</ol>
<ul>
<li>@Entity로 정의하는 객체 </li>
<li>데이터가 변해도 식별자로 지속해서 추적 가능 </li>
</ul>
<ol start="2">
<li>값 타입 </li>
</ol>
<ul>
<li>int,long,String같은 단순히 값으로 사용하는 자바 기본 타입이나 객체 </li>
<li>식별자가 없으므로 추적 불가능 (숫자 100을 200으로 변경하면 완전히 다른 값으로 대체됨.)</li>
</ul>
<p>기본값 타입 3가지 </p>
<ul>
<li>기본값 타입 (자바 기본타입(int,double), 래퍼 클래스(Integer,Long), String)</li>
<li>임베디드 타입 (복합 값 타입)</li>
<li>컬렉션 값 타입 </li>
</ul>
</blockquote>

<h2 id="1-기본값-타입"><a href="#1-기본값-타입" class="headerlink" title="1. 기본값 타입"></a>1. 기본값 타입</h2><p><img src="/images/jpa/value-1.png" alt="기본값 타입"></p>
<h2 id="2-임베디드-타입-복합값-타입"><a href="#2-임베디드-타입-복합값-타입" class="headerlink" title="2. 임베디드 타입(복합값 타입)"></a>2. 임베디드 타입(복합값 타입)</h2><figure class="highlight java"><figcaption><span>임베디드타입 예제</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;Orders&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;order_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> orderAmount;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;member_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Member member;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Embedded</span></span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;product_id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//getter,setter 생략</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Embeddable</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@AllArgConstructor</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String city;</span><br><span class="line">    <span class="keyword">private</span> String street;</span><br><span class="line">    <span class="keyword">private</span> String zipcode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="임베디드-타입-특징"><a href="#임베디드-타입-특징" class="headerlink" title="임베디드 타입 특징"></a>임베디드 타입 특징</h3><ul>
<li>int,String과 같은 값 타입 </li>
<li>주로 기본값 타입을 모아서 만들어서 복합 값 타입이라 부름 </li>
<li>새로운 값 타입을 직접 정의 가능 (응집도 높아짐에 따라 재사용성 증가)</li>
<li>Period.isWork 처럼 해당 값 타입만 사용하는 의미있는 메소드 만들수있음. </li>
<li>임베디드 타입을 포함한 모든 값 타입은 , 값 타입을 소유한 엔티티에 생명주기를 의존함. </li>
</ul>
<h3 id="임베디드-타입과-연관관계"><a href="#임베디드-타입과-연관관계" class="headerlink" title="임베디드 타입과 연관관계"></a>임베디드 타입과 연관관계</h3><p><img src="/images/jpa/value-2.png" alt="임베디드 타입과 연관관계"></p>
<ul>
<li>위 그림 처럼 entity는 여러 임베디드 타입을 가질수있으며, 임베디드타입은 다른 엔티티를 가질수 있음. </li>
</ul>
<h3 id="AttributeOverride-속성-재정의"><a href="#AttributeOverride-속성-재정의" class="headerlink" title="@AttributeOverride: 속성 재정의"></a>@AttributeOverride: 속성 재정의</h3><ul>
<li>한 엔티티에 같은 임베디드 타입을 사용하면? 컬럼명이 중복되서 에러남. </li>
<li>@AttributeOverrides, @AttributeOverride를 사용해서 컬러 명 속성을 재정의 (homeAddress,workAddress)</li>
</ul>
<h3 id="임베디드-타입과-null"><a href="#임베디드-타입과-null" class="headerlink" title="임베디드 타입과 null"></a>임베디드 타입과 null</h3><ul>
<li>임베디드 타입의 값이 null이면 매핑한 컬럼 모두 null로 세팅됨 (member.setAddress(null))</li>
</ul>
<h2 id="3-값-타입과-불변-객체"><a href="#3-값-타입과-불변-객체" class="headerlink" title="3. 값 타입과 불변 객체"></a>3. 값 타입과 불변 객체</h2><blockquote><p>값 타입은 복잡한 객체 세상을 조금이라도 단순화하려고 만든 개념이다. 따라서 값 타입은 단순하고 안전하게 다 룰 수 있어야 한다.</p>
</blockquote>

<h3 id="값-타입-복사"><a href="#값-타입-복사" class="headerlink" title="값 타입 복사"></a>값 타입 복사</h3><p><img src="/images/jpa/value-3.png" alt="값 타입 공유 참조"><br><img src="/images/jpa/value-4.png" alt="값 타입 복사"></p>
<h3 id="객체-타입-한계"><a href="#객체-타입-한계" class="headerlink" title="객체 타입 한계"></a>객체 타입 한계</h3><p><img src="/images/jpa/value-5.png" alt="객체 타입 한계"><br><img src="/images/jpa/value-6.png" alt="객체 타입 한계 예시"></p>
<h3 id="불변객체"><a href="#불변객체" class="headerlink" title="불변객체"></a>불변객체</h3><p><img src="/images/jpa/value-7.png" alt="불변객체"></p>
<h2 id="4-값-타입-비교"><a href="#4-값-타입-비교" class="headerlink" title="4. 값 타입 비교"></a>4. 값 타입 비교</h2><p><img src="/images/jpa/value-8.png" alt="값 타입 비교"></p>
<h2 id="5-값-타입-컬렉션"><a href="#5-값-타입-컬렉션" class="headerlink" title="5. 값 타입 컬렉션"></a>5. 값 타입 컬렉션</h2><ul>
<li>결론부터 이야기하면 <strong>값 타입 컬렉션은 가급적 피하는것이 좋다.</strong>  </li>
<li>값타입 특성상 엔티티 처럼 추적이 불가능하기때문에, 일부 row를 수정하려고 하면, 해당 키값의 포함된 모든 데이터를 지우고 다시 생성한다. </li>
<li>값 타입 컬렉션 대신 값타입을 엔티티로 승격시키고, <strong>cacade + 고아객체(orhanremoval)</strong> 로 주 엔티티에서 관리하도록 만들어서 관리해야함.</li>
<li>값 타입 컬렉션은 정말 단순한 데이터를 저장할때 쓴다. (예를들면 멀티셀렉트박스로 선택한 값들을 단순 저장할때.)</li>
</ul>
<h3 id="값-타입-사용시-주의사항"><a href="#값-타입-사용시-주의사항" class="headerlink" title="값 타입 사용시 주의사항"></a>값 타입 사용시 주의사항</h3><ul>
<li>값 타입은 정말 값 타입이라 판단될 때만 사용</li>
<li>엔티티와 값 타입을 혼동해서 엔티티를 값 타입으로 만들면 안됨</li>
<li>식별자가 필요하고, 지속해서 값을 추적, 변경해야 한다면 그것 은 값 타입이 아닌 엔티티</li>
</ul>
<h3 id="값-타입-컬렉션-소개"><a href="#값-타입-컬렉션-소개" class="headerlink" title="값 타입 컬렉션 소개"></a>값 타입 컬렉션 소개</h3><p><img src="/images/jpa/collection-value-1.png" alt="값 타입 컬렉션 소개1"><br><img src="/images/jpa/collection-value-2.png" alt="값 타입 컬렉션 소개2"></p>
<h3 id="값-타입-컬렉션의-제약사항"><a href="#값-타입-컬렉션의-제약사항" class="headerlink" title="값 타입 컬렉션의 제약사항"></a>값 타입 컬렉션의 제약사항</h3><p><img src="/images/jpa/collection-value-3.png" alt="값 타입 컬렉션의 제약사항"></p>
<h3 id="값-타입-컬렉션의-대안"><a href="#값-타입-컬렉션의-대안" class="headerlink" title="값 타입 컬렉션의 대안"></a>값 타입 컬렉션의 대안</h3><p><img src="/images/jpa/collection-value-4.png" alt="값 타입 컬렉션 대안"></p>
<h3 id="값-타입-정리"><a href="#값-타입-정리" class="headerlink" title="값 타입 정리"></a>값 타입 정리</h3><p><img src="/images/jpa/collection-value-5.png" alt="값 타입 정리"></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/04/28/value-type/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/04/21/proxy-relational/"
                            aria-label=": proxy-relational"
                        >
                            proxy-relational
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-04-21T05:40:23+00:00">
	
		    Apr 21, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Study/">Study</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%B0%94ORM%ED%91%9C%EC%A4%80JPA%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/">자바ORM표준JPA프로그래밍</a>, <a class="category-link" href="/categories/%ED%94%84%EB%A1%9D%EC%8B%9C%EC%99%80-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EA%B4%80%EB%A6%AC/">프록시와 연관관계 관리</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="프록시와-연관관계-관리"><a href="#프록시와-연관관계-관리" class="headerlink" title="프록시와 연관관계 관리"></a>프록시와 연관관계 관리</h1><h2 id="1-프록시"><a href="#1-프록시" class="headerlink" title="1. 프록시"></a>1. 프록시</h2><h3 id="1-1-프록시-기초"><a href="#1-1-프록시-기초" class="headerlink" title="1-1. 프록시 기초"></a>1-1. 프록시 기초</h3><p>JPA에서 식별자로 엔티티 하나를 조회할 때는 EntityManager.find()를 사용한다. 이 메소드는 Persistance Context에 엔티티가 없으면 DB를 조회 한다. 이렇게 엔티티를 직접 조회하면 조회한 엔티티를 실제 사용하든 사용하지 않든 DB를 조회하게 된다. 엔티티를 실제 사용하는 시점까지 DB조회를 미루고싶으면 EntityManager.getReference()를 사용하면 된다. getReference로 호출할때 JPA는 DB조회를 하지 않고 실제 엔티티 객제도 생성 하지 않는다. 대신 DB접근을 위임한 프록시 객체를 반환한다. </p>
<p><img src="/images/jpa/proxy-1.png" alt="프록시 구조1"></p>
<p>위와 같이 프록시는 실제 클래스를 상속받아 사용되며, 실제클래스와 겉모양이 같음. 사용하는 입장에서는 진짜 객체인지 가짜객체인지 구분할 필요없이 그냥 사용하면 됨. (이론상)</p>
<p><img src="/images/jpa/proxy-2.png" alt="프록시 구조2"></p>
<p>위와 같이 프록시 객체는 실제 객체에 대한 참조를 보관하며, 프록시 객체의 메소드를 호출하면 프록시 객체는 실제 객체의 메소드를 호출한다. </p>
<h4 id="프록시-객체-초기화"><a href="#프록시-객체-초기화" class="headerlink" title="프록시 객체 초기화"></a>프록시 객체 초기화</h4><p><img src="/images/jpa/proxy-3.png" alt="프록시 객체 초기화"></p>
<h4 id="프록시-특징"><a href="#프록시-특징" class="headerlink" title="프록시 특징"></a>프록시 특징</h4><ul>
<li>프록시 객체는 처음 사용할때 한번만 호출됨</li>
<li>프록시 객체를 초기화한다고 프록시 객체가 실제 엔티티로 바뀌지는 않음.(프록시 객체가 초기화 되면 프록시 객체를 통해 실제 엔티티 접근한다.)</li>
<li>프록시 객체는 원본 엔티티를 상속받은 객체이므로 타입 체크시에 주의해서 사용해야함.(타입체크시 == 대신 instanceof 사용하자)</li>
<li>Persistance Context에 찾는 엔티티가 이미 있으면, DB를 조회할 이유가 없으므로,em.getReference()를 호출하더라도 프록시가 아닌 실제 엔티티를 반환함</li>
<li>초기화는 Persistance Context의 도움을 받아야함 따라서 Persistance Context의 도움을 받을수 없는 준영속 상태의 프록시를 초기화화면 문제가 발생함. (LazyInitializationException발생)</li>
</ul>
<h3 id="1-2-프록시와-식별자"><a href="#1-2-프록시와-식별자" class="headerlink" title="1-2. 프록시와 식별자"></a>1-2. 프록시와 식별자</h3><ul>
<li>엔티티 접근 방식을 @Access(AccessType.PROPERTY) 로 설정한경우 초기화 하지 않음</li>
<li>@Access(AccessType.FIELD)로 설정하면 JPA는 getId메소드가 id만 조회하는 메소드인지 다른 필드까지 활용해서 어떤 일을 하는 메소드인지 알지 못하므로 프록시 객체를 초기화 하게됨.</li>
<li>연관관계를 설정할때는 식별자 값만 사용하므로 프록시를 사용하면 DB접근 횟수를 줄일수있음. </li>
</ul>
<h3 id="1-3-프록시-확인"><a href="#1-3-프록시-확인" class="headerlink" title="1-3. 프록시 확인"></a>1-3. 프록시 확인</h3><ul>
<li>프록시 인스턴스의 초기화 여부 확인 (PersistenceUnitUtil.isLoaded(Object entity))</li>
<li>프록시 클래스 확인 방법 (entity.getClass().getName() 출력(..javasist.. or HibernateProxy…))</li>
<li>프록시 강제 초기화 (org.hibernate.Hibernate.initialize(entity);)</li>
<li>참고: JPA 표준은 강제 초기화 없음 (강제 호출: member.getName())</li>
</ul>
<h2 id="2-즉시로딩-과-지연로딩"><a href="#2-즉시로딩-과-지연로딩" class="headerlink" title="2. 즉시로딩 과 지연로딩"></a>2. 즉시로딩 과 지연로딩</h2><p>지연 로딩(LAZY) : 연관된 엔티티를 프록시로 조회한다. 프록시를 실제 사용할때 초기화 하면서 데이터베이스를 조회한다.<br>즉시 로딩(EAGER) : 연관된 엔티티를 즉시 조회한다. 하이버네이트는 가능하면 SQL조인을 사용해서 한번에 조회한다. </p>
<p><img src="/images/jpa/fetch-1.png" alt="프록시와 즉시로딩 주의"></p>
<blockquote><p>[참고] JPQL에서 JOIN 할시 발생하는 이슈 </p>
<ul>
<li>select m from Member join m.team 이런 쿼리를 날리면 어떻게 될까? N+1 쿼리가 나간다. 중요한건 글로벌 fetch전략과 상관없이 N+1이 나간다는것에 초점이 있다. 이런 부분을 해결하기 위해서는 join fetch를 사용해서 한방에 쿼리가 나갈수 있도록 해야한다.  </li>
</ul>
</blockquote>

<p><img src="/images/jpa/fetch-2.png" alt="실무에서 fetch전략 활용 방법"></p>
<h2 id="3-영속성-전이-CASCADE"><a href="#3-영속성-전이-CASCADE" class="headerlink" title="3. 영속성 전이: CASCADE"></a>3. 영속성 전이: CASCADE</h2><p><img src="/images/jpa/cacade-1.png" alt="cacade 정의"><br><img src="/images/jpa/cacade-2.png" alt="cacade 사용방법"><br><img src="/images/jpa/cacade-3.png" alt="cacade 사용 주의점"></p>
<ul>
<li>CACADE는 보통 ALL/PERSIST 위주로 사용하며,그나마 REMOVE까지는 쓰고 그 외 나머지는 잘 사용안함. </li>
</ul>
<h2 id="4-고아-객체"><a href="#4-고아-객체" class="headerlink" title="4. 고아 객체"></a>4. 고아 객체</h2><p><img src="/images/jpa/orhpan-1.png" alt="고아객체 정의"><br><img src="/images/jpa/orhpan-2.png" alt="고아객체 주의점"><br><img src="/images/jpa/orhpan-3.png" alt="cacade + 고아객체,생명주기"></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/04/21/proxy-relational/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/04/19/high-end-mapping/"
                            aria-label=": high-end-mapping"
                        >
                            high-end-mapping
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-04-19T11:09:38+00:00">
	
		    Apr 19, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Study/">Study</a>, <a class="category-link" href="/categories/%EA%B3%A0%EA%B8%89-%EB%A7%A4%ED%95%91/">고급 매핑</a>, <a class="category-link" href="/categories/%EC%9E%90%EB%B0%94ORM%ED%91%9C%EC%A4%80JPA%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/">자바ORM표준JPA프로그래밍</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="고급매핑"><a href="#고급매핑" class="headerlink" title="고급매핑"></a>고급매핑</h1><blockquote><p>고급매핑에서 배울 내용들 정리 </p>
<ol>
<li>상속관계 매핑 : 객체의 상속관계를 DB에 어떻게 매핑하는지 </li>
<li>@MappedSuperclass : 등록일,수정일 같이 여러 엔티티에서 공통으로 사용하는 매핑정보만 상속받고 싶으면 이 기능을 활용한다. </li>
<li>복합키와 식별관계 매핑 : DB의 식별자가 하나 이상일때 매핑하는 방법. 그리고 DB설계에서 이야기하는 식별관계와 비식별관계에 대해서 다룬다. </li>
<li>조인 테이블 : 테이블은 외래키 하나로 연관관계를 맺을 수 있지만 연관관계를 관리하는 연결 테이블을 두는 방법도 있다. 여기서는 연결 테이블을 매핑하는 방법을 다룬다. </li>
<li>엔티티 하나에 여러 테이블 매핑하기 : 보통 엔티티 하나에 테이블 하나를 매핑하지만 엔티티 하나에 여러 테이블을 매핑하는 방법도 있다.   </li>
</ol>
</blockquote>

<h2 id="1-상속관계-매핑"><a href="#1-상속관계-매핑" class="headerlink" title="1. 상속관계 매핑"></a>1. 상속관계 매핑</h2><h3 id="1-1-조인-전략"><a href="#1-1-조인-전략" class="headerlink" title="1-1. 조인 전략"></a>1-1. 조인 전략</h3><p><img src="/images/jpa/join_inheritence.png" alt="조인전략 예시"></p>
<figure class="highlight java"><figcaption><span>조인전략예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Inheritance(strategy = Inheritence.JOINED)</span></span><br><span class="line"><span class="meta">@DiscriminatorColumn(name = &quot;DTYPE&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name = &quot;item_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> price; </span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//...setter/getter생략</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="meta">@DiscriminatorValue(&quot;A&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Album</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String artist; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="meta">@DiscriminatorValue(&quot;M&quot;)</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String director; </span><br><span class="line">	<span class="keyword">private</span> String actor; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="장점"><a href="#장점" class="headerlink" title="장점"></a>장점</h4><ul>
<li>테이블이 정규화 됨 </li>
<li>외래키 참조 무결성 제약조건을 활용할수 있다.</li>
<li>저장공간을 효율적으로 사용함 </li>
</ul>
<h4 id="단점"><a href="#단점" class="headerlink" title="단점"></a>단점</h4><ul>
<li>조회할때 조인이 많이 사용되므로 성능이 저하될수 있다. </li>
<li>조회 쿼리가 복잡하다. </li>
<li>데이터를 등록할 insert sql을 두번 실행됨. </li>
</ul>
<h3 id="1-2-단일-테이블-전략"><a href="#1-2-단일-테이블-전략" class="headerlink" title="1-2. 단일 테이블 전략"></a>1-2. 단일 테이블 전략</h3><p><img src="/images/jpa/singletable.png" alt="조인테이블 전략 예시"></p>
<figure class="highlight java"><figcaption><span>단일테이블 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Inheritance(strategy = Inheritence.SINGLE_TABLE)</span></span><br><span class="line"><span class="meta">@DiscriminatorColumn(name = &quot;DTYPE&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name = &quot;item_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> price; </span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//...setter/getter생략</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="meta">@DiscriminatorValue(&quot;A&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Album</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String artist; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="meta">@DiscriminatorValue(&quot;M&quot;)</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String director; </span><br><span class="line">	<span class="keyword">private</span> String actor; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="장점-1"><a href="#장점-1" class="headerlink" title="장점"></a>장점</h4><ul>
<li>조인이 필요없으므로 일반적으로 조회성능이 빠름.</li>
<li>조회 쿼리가 단순해짐 </li>
</ul>
<h4 id="단점-1"><a href="#단점-1" class="headerlink" title="단점"></a>단점</h4><ul>
<li>자식 엔티티가 매핑한 컬럼은 모두 null을 허용해야한다.</li>
<li>단일 테이블에 모든것을 저장하므로 테이블이 커질수 있다. 상황에 따라서는 조회성능이 오히려 느려질수도 있음. </li>
</ul>
<h4 id="특징"><a href="#특징" class="headerlink" title="특징"></a>특징</h4><ul>
<li>구분 컬럼을 꼭 사용해야함. (@DiscriminatorColumn)</li>
<li>구분 컬럼 지정안하면 엔티티 이름으로 자동 지정됨. </li>
</ul>
<h3 id="1-3-구현-클래스마다-테이블-전략"><a href="#1-3-구현-클래스마다-테이블-전략" class="headerlink" title="1-3. 구현 클래스마다 테이블 전략"></a>1-3. 구현 클래스마다 테이블 전략</h3><p><img src="/images/jpa/table-per-concrete-class.png" alt="구현 클래스마다 테이블 전략"></p>
<figure class="highlight java"><figcaption><span>구현클래스마다 테이블 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Inheritance(strategy = Inheritence.TABLE_PER_CLASS)</span></span><br><span class="line"><span class="meta">@DiscriminatorColumn(name = &quot;DTYPE&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name = &quot;item_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> price; </span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//...setter/getter생략</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Album</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String artist; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> <span class="keyword">extends</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String director; </span><br><span class="line">	<span class="keyword">private</span> String actor; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="장점-2"><a href="#장점-2" class="headerlink" title="장점"></a>장점</h4><ul>
<li>서브타입을 구분해서 처리할때 효과적 </li>
<li>not null 제약조건을 사용할수 있음.</li>
</ul>
<h4 id="단점-2"><a href="#단점-2" class="headerlink" title="단점"></a>단점</h4><ul>
<li>여러 자식 테이블을 함께 조회할때 성능이 느림(union사용해야함) </li>
<li>자식 테이블을 통합해서 관리하기 어려움 </li>
</ul>
<h4 id="특징-1"><a href="#특징-1" class="headerlink" title="특징"></a>특징</h4><ul>
<li>구분 컬럼을 사용안함</li>
<li>일반적으로 사용안하길 권장되는 전략 </li>
</ul>
<h2 id="2-MappedSuperclass"><a href="#2-MappedSuperclass" class="headerlink" title="2. @MappedSuperclass"></a>2. @MappedSuperclass</h2><p><img src="/images/jpa/mappedsuperclass.png" alt="@MappedSuperClass"></p>
<figure class="highlight java"><figcaption><span>MappedSuperClass예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MappedSuperClass</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseEntity</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line"></span><br><span class="line">	<span class="comment">//...setter/getter생략</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@AttributeOverrides(</span></span><br><span class="line"><span class="meta">	@AttributeOverride(name = &quot;id&quot;, column= @Column(name = &quot;member_id&quot;)),</span></span><br><span class="line"><span class="meta">	@AttributeOverride(name = &quot;name&quot;, column = @Column(name=&quot;member_name&quot;))</span></span><br><span class="line"><span class="meta">)</span> <span class="comment">// 부모로부터 물려받은 매핑정보를 재정의 위와 같이 재정의 할수 있음. </span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> <span class="keyword">extends</span> <span class="title">BaseEntity</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String email; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Seller</span> <span class="keyword">extends</span> <span class="title">BaseEntity</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String shopName; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="특징-2"><a href="#특징-2" class="headerlink" title="특징"></a>특징</h4><ul>
<li>상속관계 매핑이 아니다. </li>
<li>@MappedSuperClass로 지정된 클래스는 엔티티가 아니므로, em.find 혹은 JPQL 조회 불가능 하다.</li>
<li>부모 클래스를 상속받는 자식클래스에 매핑정보만 제공 </li>
<li>이 클래스를 직접 사용할일이 없기때문에 추상클래스로 만드는걸 권장함 </li>
<li>테이블과 관계없고 단순히 엔티티가 공통으로 사용하는 매핑정보를 모으는 역할 </li>
<li>주로 등록일, 수정일, 등록자, 수정자 같은 전체 엔티티에서 공통으로 적용하는 정보를 모을때 사용 </li>
<li>참고 : @Entity 클래스는 엔티티나 @MappedSuperClass로 지정한 클래스만 사속 가능 </li>
</ul>
<h2 id="3-복합키와-식별관계-매핑"><a href="#3-복합키와-식별관계-매핑" class="headerlink" title="3. 복합키와 식별관계 매핑"></a>3. 복합키와 식별관계 매핑</h2><h3 id="3-1-식별관계-VS-비식별관계"><a href="#3-1-식별관계-VS-비식별관계" class="headerlink" title="3-1. 식별관계 VS 비식별관계"></a>3-1. 식별관계 VS 비식별관계</h3><h4 id="식별관계"><a href="#식별관계" class="headerlink" title="식별관계"></a>식별관계</h4><ul>
<li>식별관계는 부모 테이블의 기본키를 내려받아서 자식테이블의 (기본키+외래키) 로 사용하는 관계 </li>
</ul>
<h4 id="비식별관계"><a href="#비식별관계" class="headerlink" title="비식별관계"></a>비식별관계</h4><ul>
<li>부모테이블의 기본키를 받아서 자식 테이블의 외래키로만 사용하는 관계 </li>
</ul>
<h5 id="3-1-1-복합키-비식별-관계-매핑"><a href="#3-1-1-복합키-비식별-관계-매핑" class="headerlink" title="3-1-1. 복합키 : 비식별 관계 매핑"></a>3-1-1. 복합키 : 비식별 관계 매핑</h5><p>JPA는 복합키 지원을 위해 @IdClass와 @EmbeddedId 2가지 방법을 제공하는데 @IdClass는 관계형데이터베이스에 가까운 방법이고, @EmbeddedId는 좀 더 객체지향에 가까운 방법이다. </p>
<h6 id="IdClass"><a href="#IdClass" class="headerlink" title="@IdClass"></a>@IdClass</h6><figure class="highlight java"><figcaption><span>복합키 IdClass예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@IdClass(ParentId.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> </span><br><span class="line">	<span class="meta">@Column(name=&quot;parent_id1&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String id1;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> </span><br><span class="line">	<span class="meta">@Column(name=&quot;parent_id2&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String id2;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParentId</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="comment">//식별자 클래스의 속성명과 엔티티에서 사용하는 식별자의 속성명이 같아야함!! </span></span><br><span class="line">	<span class="keyword">private</span> String id1;</span><br><span class="line">	<span class="keyword">private</span> String id2; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//기본생성자 필수</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ParentId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ParentId</span><span class="params">(String id1, String id2)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id1 = id1;</span><br><span class="line">		<span class="keyword">this</span>.id2 = id2; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//equals &amp; hashcode 는 반드시 구현되어야함.</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;...&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;...&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//저장</span></span><br><span class="line">Parent p = <span class="keyword">new</span> Parent();</span><br><span class="line">p.setId1(<span class="string">&quot;id1&quot;</span>);</span><br><span class="line">p.setId2(<span class="string">&quot;id2&quot;</span>);</span><br><span class="line">p.setName(<span class="string">&quot;pName&quot;</span>);</span><br><span class="line">em.persist(p);</span><br><span class="line"></span><br><span class="line"><span class="comment">//조회 </span></span><br><span class="line">ParentId pid = <span class="keyword">new</span> ParentId(<span class="string">&quot;id1&quot;</span>,<span class="string">&quot;id2&quot;</span>);</span><br><span class="line">Parent p = em.find(Parent.class,parentId);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Child클래스</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="keyword">private</span> String id; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumns(&#123;</span></span><br><span class="line"><span class="meta">		@JoinColumn(name = &quot;parent_id1&quot;, referenceColumnName = &quot;parent_id1&quot;),</span></span><br><span class="line"><span class="meta">		@JoinColumn(name = &quot;parent_id2&quot;, referenceColumnName = &quot;parent_id2&quot;)</span></span><br><span class="line"><span class="meta">	&#125;)</span></span><br><span class="line">	<span class="keyword">private</span> Parent parent; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="EmbeddedId"><a href="#EmbeddedId" class="headerlink" title="EmbeddedId"></a>EmbeddedId</h6><figure class="highlight java"><figcaption><span>복합키 EmbeddedId 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@IdClass(ParentId.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@EmbeddedId</span> </span><br><span class="line">	<span class="keyword">private</span> ParentId id2;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Embeddable</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParentId</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="comment">//식별자 클래스의 속성명과 엔티티에서 사용하는 식별자의 속성명이 같아야함!! </span></span><br><span class="line">	<span class="meta">@Column(name = &quot;parent_id1&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String id1;</span><br><span class="line">	<span class="meta">@Column(name = &quot;parent_id2&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String id2; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//기본생성자 필수</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ParentId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ParentId</span><span class="params">(String id1, String id2)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id1 = id1;</span><br><span class="line">		<span class="keyword">this</span>.id2 = id2; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//equals &amp; hashcode 는 반드시 구현되어야함.</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;...&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;...&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//저장</span></span><br><span class="line">Parent p = <span class="keyword">new</span> Parent();</span><br><span class="line">ParentId pid = <span class="keyword">new</span> ParentId(<span class="string">&quot;id1&quot;</span>,<span class="string">&quot;id2&quot;</span>);</span><br><span class="line">p.setId(pid);</span><br><span class="line">p.setName(<span class="string">&quot;pName&quot;</span>);</span><br><span class="line">em.persist(p);</span><br><span class="line"></span><br><span class="line"><span class="comment">//조회 </span></span><br><span class="line">ParentId pid = <span class="keyword">new</span> ParentId(<span class="string">&quot;id1&quot;</span>,<span class="string">&quot;id2&quot;</span>);</span><br><span class="line">Parent p = em.find(Parent.class,parentId);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Child클래스</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="keyword">private</span> String id; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumns(&#123;</span></span><br><span class="line"><span class="meta">		@JoinColumn(name = &quot;parent_id1&quot;, referenceColumnName = &quot;parent_id1&quot;),</span></span><br><span class="line"><span class="meta">		@JoinColumn(name = &quot;parent_id2&quot;, referenceColumnName = &quot;parent_id2&quot;)</span></span><br><span class="line"><span class="meta">	&#125;)</span></span><br><span class="line">	<span class="keyword">private</span> Parent parent; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="3-1-2-복합키-식별-관계-매핑"><a href="#3-1-2-복합키-식별-관계-매핑" class="headerlink" title="3-1-2. 복합키 : 식별 관계 매핑"></a>3-1-2. 복합키 : 식별 관계 매핑</h5><p>복합키 식별관계 매핑은 부모,자식,손자까지 계속 기본 키를 전달하는 식별관계 이다. 식별 관계에서 자식 테이블은 부모 테이블의 기본 키를 포함해서 복합 키를 구성해야 하므로 @IdClass나 @EmbeddedId를 사용해서 식별자를 매핑해야한다. </p>
<h6 id="IdClass-1"><a href="#IdClass-1" class="headerlink" title="@IdClass"></a>@IdClass</h6><figure class="highlight java"><figcaption><span>복합키: 식별관계 매핑 IdClass 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> ParentId id2;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Child클래스</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@IdClass(ChildId.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Parent parent; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@Column(name = &quot;child_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String childId; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChildId</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String parent; <span class="comment">//Child.parent 매핑</span></span><br><span class="line">	<span class="keyword">private</span> String childId; <span class="comment">//Child.childId 매핑</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//equals,hashcode 재정의 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="meta">@IdClass(GrandChildId.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GrandChild</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumns(&#123;</span></span><br><span class="line"><span class="meta">		@JoinColumn(name = &quot;parent_id&quot;),</span></span><br><span class="line"><span class="meta">		@JoinColumn(name = &quot;child_id&quot;)</span></span><br><span class="line"><span class="meta">	&#125;)</span></span><br><span class="line">	<span class="keyword">private</span> Child child;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@Column(name = &quot;GRANDCHILD_ID&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String id; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GrandChildId</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> ChildId child; <span class="comment">//GrandChild.child 매핑</span></span><br><span class="line">	<span class="keyword">private</span> String id; <span class="comment">//GrandChild.id 매핑</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//equals,hashcode재정의 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="EmbeddedId-1"><a href="#EmbeddedId-1" class="headerlink" title="@EmbeddedId"></a>@EmbeddedId</h6><figure class="highlight java"><figcaption><span>복합키: 식별관계 매핑 EmbeddedId 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> ParentId id2;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Child클래스</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@IdClass(ChildId.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> </span>&#123;</span><br><span class="line">	<span class="meta">@EmbeddedId</span></span><br><span class="line">	<span class="keyword">private</span> String childId; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@MapsId(&quot;parentId&quot;)</span></span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Parent parent; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Embeddable</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChildId</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String parent; <span class="comment">//MapsId(&quot;parentId&quot;) 매핑</span></span><br><span class="line">	<span class="keyword">private</span> String childId; <span class="comment">//Child.childId 매핑</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//equals,hashcode 재정의 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GrandChild</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@EmbeddedId</span></span><br><span class="line">	<span class="keyword">private</span> GrandChildId id; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@MapsId(&quot;childId&quot;)</span></span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumns(&#123;</span></span><br><span class="line"><span class="meta">		@JoinColumn(name = &quot;parent_id&quot;),</span></span><br><span class="line"><span class="meta">		@JoinColumn(name = &quot;child_id&quot;)</span></span><br><span class="line"><span class="meta">	&#125;)</span></span><br><span class="line">	<span class="keyword">private</span> Child child;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GrandChildId</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> ChildId child; <span class="comment">//MapsId(&quot;childId&quot;) 매핑</span></span><br><span class="line">	<span class="keyword">private</span> String id; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//equals,hashcode재정의 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="3-1-3-비식별-관계-매핑-복합키-X"><a href="#3-1-3-비식별-관계-매핑-복합키-X" class="headerlink" title="3-1-3. 비식별 관계 매핑 : 복합키 X"></a>3-1-3. 비식별 관계 매핑 : 복합키 X</h5><figure class="highlight java"><figcaption><span>비식별관계 매핑 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Child클래스</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;child_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Parent parent; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GrandChild</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name =&quot;grandchild_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name=&quot;child_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Child child;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="3-1-4-일대일-식별관계"><a href="#3-1-4-일대일-식별관계" class="headerlink" title="3-1-4 일대일 식별관계"></a>3-1-4 일대일 식별관계</h5><figure class="highlight java"><figcaption><span>일대일 식별관계</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Board</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span> </span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String title; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToOne(mappedBy = &quot;borad&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> BoardDetail boardDetail; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoardDetail</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="keyword">private</span> Long boardId;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@MapsId</span> <span class="comment">//BoardDetail.boardId 매핑 </span></span><br><span class="line">	<span class="meta">@OneToOne</span></span><br><span class="line">	<span class="meta">@JoinColumn(name = &quot;board_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Board board; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String content; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//저장 </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Board board = <span class="keyword">new</span> Board(); </span><br><span class="line">	board.setTitle(<span class="string">&quot;제목&quot;</span>);</span><br><span class="line">	em.persist(board); </span><br><span class="line">	</span><br><span class="line">	BoardDetail boardDetail = <span class="keyword">new</span> BoardDetail();</span><br><span class="line">	boardDetail.setContent(<span class="string">&quot;내용&quot;</span>);</span><br><span class="line">	boardDetail.setBoard(board);</span><br><span class="line">	em.persist(boardDetail); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="4-조인-테이블"><a href="#4-조인-테이블" class="headerlink" title="4. 조인 테이블"></a>4. 조인 테이블</h2><h3 id="4-1-1-1-조인-테이블"><a href="#4-1-1-1-조인-테이블" class="headerlink" title="4-1. 1:1 조인 테이블"></a>4-1. 1:1 조인 테이블</h3><figure class="highlight java"><figcaption><span>1:1 조인테이블 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToOne</span></span><br><span class="line">	<span class="meta">@JoinTable(name = &quot;parent_child&quot;)</span>, </span><br><span class="line">	joinColumns(name = <span class="meta">@JoinColumn(name = &quot;parent_id&quot;)</span>,</span><br><span class="line">	inverseJoinColumns(name=<span class="string">&quot;child_id&quot;</span>))</span><br><span class="line">	<span class="keyword">private</span> Child child; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Child클래스</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;child_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* 양방향 연관관계 매핑 하려면 아래코드작성 </span></span><br><span class="line"><span class="comment">	@OneToOne(mappedBy=&quot;child&quot;)</span></span><br><span class="line"><span class="comment">	private Parent parent; </span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-1-N-조인-테이블"><a href="#4-2-1-N-조인-테이블" class="headerlink" title="4-2. 1:N 조인 테이블"></a>4-2. 1:N 조인 테이블</h3><figure class="highlight java"><figcaption><span>1:N 조인테이블 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToMany</span></span><br><span class="line">	<span class="meta">@JoinTable(name = &quot;parent_child&quot;)</span>, </span><br><span class="line">	joinColumns(name = <span class="meta">@JoinColumn(name = &quot;parent_id&quot;)</span>,</span><br><span class="line">	inverseJoinColumns(name=<span class="string">&quot;child_id&quot;</span>))</span><br><span class="line">	<span class="keyword">private</span> List&lt;Child&gt; child = <span class="keyword">new</span> ArrayList&lt;&gt;(); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Child클래스</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;child_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-N-1-조인-테이블"><a href="#4-3-N-1-조인-테이블" class="headerlink" title="4-3. N:1 조인 테이블"></a>4-3. N:1 조인 테이블</h3><figure class="highlight java"><figcaption><span>N:1 조인테이블 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OneToMany(mappedBy = &quot;parent&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;Child&gt; child = <span class="keyword">new</span> ArrayList&lt;&gt;(); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Child클래스</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;child_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToOne(optional=false)</span></span><br><span class="line">	<span class="meta">@JoinTable(name = &quot;parent_child&quot;)</span>, </span><br><span class="line">	joinColumns(name = <span class="meta">@JoinColumn(name = &quot;child_id&quot;)</span>,</span><br><span class="line">	inverseJoinColumns(name=<span class="string">&quot;parent_id&quot;</span>))</span><br><span class="line">	<span class="keyword">private</span> Parent parent;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="4-3-N-M-조인-테이블"><a href="#4-3-N-M-조인-테이블" class="headerlink" title="4-3. N:M 조인 테이블"></a>4-3. N:M 조인 테이블</h3><figure class="highlight java"><figcaption><span>N:M 조인테이블 예시</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;parent_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">	<span class="meta">@ManyToMany</span></span><br><span class="line">	<span class="meta">@JoinTable(name = &quot;parent_child&quot;)</span>, </span><br><span class="line">	joinColumns(name = <span class="meta">@JoinColumn(name = &quot;parent_id&quot;)</span>,</span><br><span class="line">	inverseJoinColumns(name=<span class="string">&quot;child_id&quot;</span>))</span><br><span class="line">	<span class="keyword">private</span> List&lt;Child&gt; child = <span class="keyword">new</span> ArrayList&lt;&gt;(); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Child클래스</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Child</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;child_id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> Long id; </span><br><span class="line">	<span class="keyword">private</span> String name; </span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/04/19/high-end-mapping/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 codexdawn. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">codexdawn</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ikbi0v8fyzuu91xv5rmpcrnwb4qinfgborzd5kejmj8wr6ibfra8oaxqshyg.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
